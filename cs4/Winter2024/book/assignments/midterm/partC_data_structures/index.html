
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mvanier.github.io/cs4/Winter2024/book/assignments/midterm/partC_data_structures/">
      
      
        <link rel="prev" href="../partB_lists_hofs/">
      
      
        <link rel="next" href="../../5/assignment5/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>Part C: Data structures - The CS 4 book (Winter 2024)</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#part-c-data-structures-weight-balanced-trees-40-points" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="The CS 4 book (Winter 2024)" class="md-header__button md-logo" aria-label="The CS 4 book (Winter 2024)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The CS 4 book (Winter 2024)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Part C: Data structures
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to medium mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to medium mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="medium" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="The CS 4 book (Winter 2024)" class="md-nav__button md-logo" aria-label="The CS 4 book (Winter 2024)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    The CS 4 book (Winter 2024)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/welcome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to CS 4!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/motivation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Motivation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Administrative
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Administrative
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/syllabus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syllabus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/collab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collaboration policies
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignments
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Assignments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0/assignment0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assignment 0: Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignment 1: Evaluation and recursion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Assignment 1: Evaluation and recursion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1/assignment1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1/ocaml_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCaml notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1/partA_exercises/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part A: Exercises
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1/partB_evaluation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part B: Evaluation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1/partC_recursion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part C: Recursion
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignment 2: Complexity and HOFs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Assignment 2: Complexity and HOFs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2/assignment2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2/ocaml_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCaml notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2/partA_orders_of_growth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part A: Orders of growth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2/partB_evaluation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part B: Evaluation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2/partC_higher_order_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part C: Higher-order functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2/partD_additional_problems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part D: Additional problems
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignment 3: Lists
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Assignment 3: Lists
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3/assignment3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3/ocaml_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCaml notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3/partA_lists/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part A: Working with lists
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3/partB_structural_generative_recursion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part B: Structural and Generative Recursion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3/partC_more_lists/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part C: Some harder problems with lists
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignment 4: Data abstraction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Assignment 4: Data abstraction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../4/assignment4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../4/ocaml_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCaml notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../4/partA_abstraction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part A: Abstraction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../4/partB_more_abstraction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part B: More abstraction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../4/partC_algebra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part C: Algebraic expressions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" checked>
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Midterm exam
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Midterm exam
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ocaml_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCaml notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../partA_complexity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part A: Complexity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../partB_lists_hofs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part B: Lists and HOFs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Part C: Data structures
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Part C: Data structures
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tree-rotations" class="md-nav__link">
    <span class="md-ellipsis">
      Tree rotations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inserting-into-a-wb-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Inserting into a WB tree
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ocaml-implementation-and-template-code" class="md-nav__link">
    <span class="md-ellipsis">
      OCaml implementation and template code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-8-points-tree_member" class="md-nav__link">
    <span class="md-ellipsis">
      1. [8 points] tree_member
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-8-points-single_l" class="md-nav__link">
    <span class="md-ellipsis">
      2. [8 points] single_l
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-8-points-single_r" class="md-nav__link">
    <span class="md-ellipsis">
      3. [8 points] single_r
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-8-points-double_l" class="md-nav__link">
    <span class="md-ellipsis">
      4. [8 points] double_l
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-8-points-double_r" class="md-nav__link">
    <span class="md-ellipsis">
      5. [8 points] double_r
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      Testing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-useful-functions-for-debuggingtesting" class="md-nav__link">
    <span class="md-ellipsis">
      Additional useful functions for debugging/testing
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignment 5: Tags and objects
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Assignment 5: Tags and objects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5/assignment5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5/ocaml_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCaml notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5/partA_imperative/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part A: Imperative programming
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5/partB_tagged_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part B: Tagged data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5/partC_objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part C: Objects
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignment 6: Environmentally-friendly
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            Assignment 6: Environmentally-friendly
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../6/assignment6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../6/ocaml_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCaml notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../6/partA_environment_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part A: Environment model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../6/partB_imperative_objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part B: Imperative objects and classes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../6/partC_modules_functors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part C: Modules and functors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../6/partD_special_topics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part D: Special topics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Readings
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Readings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../readings/ocaml_cheat_sheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCaml Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../readings/subst/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Substitution Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tree-rotations" class="md-nav__link">
    <span class="md-ellipsis">
      Tree rotations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inserting-into-a-wb-tree" class="md-nav__link">
    <span class="md-ellipsis">
      Inserting into a WB tree
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ocaml-implementation-and-template-code" class="md-nav__link">
    <span class="md-ellipsis">
      OCaml implementation and template code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-8-points-tree_member" class="md-nav__link">
    <span class="md-ellipsis">
      1. [8 points] tree_member
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-8-points-single_l" class="md-nav__link">
    <span class="md-ellipsis">
      2. [8 points] single_l
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-8-points-single_r" class="md-nav__link">
    <span class="md-ellipsis">
      3. [8 points] single_r
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-8-points-double_l" class="md-nav__link">
    <span class="md-ellipsis">
      4. [8 points] double_l
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-8-points-double_r" class="md-nav__link">
    <span class="md-ellipsis">
      5. [8 points] double_r
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      Testing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-useful-functions-for-debuggingtesting" class="md-nav__link">
    <span class="md-ellipsis">
      Additional useful functions for debugging/testing
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="part-c-data-structures-weight-balanced-trees-40-points">Part C: Data structures: Weight-balanced trees (40 points)</h1>
<h2 id="introduction">Introduction</h2>
<p>In this section,
we are going to implement a non-trivial data structure
called a "weight-balanced tree", or <em>WB tree</em> for short.
The main reason for this is to demonstrate
that even fairly complex data structures
can often be implemented simply using OCaml's algebraic datatypes.</p>
<p>WB trees are an example of a "self-balancing binary search tree".
There are a number of other self-balancing binary search tree datatypes,
including red-black trees, AVL trees, 2-3 trees <em>etc.</em>
WB trees are interesting because
they contain parameters that allow you to tune the tree implementation
for faster lookup or faster insertion (but not both!).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The discussion of this data structure will be fairly lengthy,
because it's rather complicated.
However, <strong>don't be intimidated</strong>:
the amount of code you need to write is quite small.
Most of the code for the algorithm is supplied to you;
your job will be to fill in the implementation
of a few critical points of the algorithm.
We will be very clear about what you need to do,
so even if you find the algorithm confusing,
you should still understand what code you need to write.</p>
</div>
<p>Before we get into the details of this data structure,
let's explain why such a thing is desirable.
Many practical applications of interest
require set-like or map-like collections of values
which have (at least!) the following requirements:</p>
<ul>
<li>
<p>You have to be able to find a particular value in the collection
as quickly as possible (or report that it isn't there).</p>
</li>
<li>
<p>You have to be able to add a new value to the collection
as quickly as possible.</p>
</li>
<li>
<p>The collection mustn't duplicate the values searched over.</p>
</li>
</ul>
<p>The difference between a set and a map
is that sets are just the values in the collection,
while maps have an associated value for each "key" value in the map.
Our WB trees will implement sets of integers,
which is about as simple as it gets.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Don't confuse "maps" as described here with the <code>List.map</code> function,
which is a completely different kind of thing.
The "maps" we're talking about here are <em>key-value mappings</em>,
kind of like Python dictionaries.
(That's all we're going to say about maps from here on.)</p>
</div>
<p>If we didn't care about efficiency,
we can easily implement a set of integers using a list of integers.
To find whether a particular integer is in the set,
we just have to search through the list.
This is an <span class="arithmatex">\(O(N)\)</span> operation,
where <span class="arithmatex">\(N\)</span> is the length of the list,
so it's rather slow.
To add a value to the list (making sure there are no duplicates),
we can just search for the value in the list;
if it's found, there is no need to add it,
and if not, we can add it to the front of the list.
This is also <span class="arithmatex">\(O(N)\)</span>.
(If we don't mind repeated elements,
we can just add it to the front of the list without searching,
which is <span class="arithmatex">\(O(1)\)</span>.)</p>
<p>Somewhere along the line,
someone realized that if we arranged the data
in a binary tree-like data structure,
we can potentially get much faster searches
(<span class="arithmatex">\(O(log\ N)\)</span> instead of <span class="arithmatex">\(O(N)\)</span>)
and also get <span class="arithmatex">\(O(log\ N)\)</span> insertions.
To do this, we create nodes containing three things:
a data value, a left subtree, and a right subtree.
A subtree can be a leaf (no data) or another node.
In OCaml, such a data structure would look like this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c">(* Assume we are storing only integers in the tree. *)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">type</span> <span class="n">tree</span> <span class="o">=</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>  <span class="o">|</span> <span class="nc">Leaf</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>  <span class="o">|</span> <span class="nc">Node</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">*</span> <span class="n">tree</span> <span class="o">*</span> <span class="n">tree</span>   <span class="c">(* data value, left subtree, right subtree *)</span>
</span></code></pre></div>
<p>We further stipulate that
all the elements in the left subtree of a node
are strictly less than the value at the node,
and all the elements in the right subtree
are strictly greater than the value at the node
(this makes the tree an <em>ordered binary tree</em>).
Clearly, this will only work
if the values stored in the tree are orderable (like integers).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unfortunately, OCaml's type system isn't powerful enough
to express the ordering constraint,
so we have to enforce it in the functions we write
that add values to the tree.</p>
</div>
<p>Searching through a tree like this is easy
(you'll write the code below).
Insertion is also easy:
you simply walk down the tree until you reach a leaf
where the new value ought to go,
and then replace the leaf with a node whose two subtrees are leaves.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since we are implementing this data structure
in a purely functional manner,
we aren't really <em>replacing</em> anything.
Instead, we create a new tree which has a different node
in place of the one we want to "replace".
Because most of the tree can be shared between the old and new versions,
this is quite efficient.</p>
</div>
<p>If the tree is roughly balanced
(the left and right subtrees of all nodes are about the same size),
then looking up a value in the tree
or inserting a value into the tree is <span class="arithmatex">\(O(log\ N)\)</span>,
where <span class="arithmatex">\(N\)</span> is the number of values stored in the tree.
That's because on average,
going to a left or right subtree of a node
gets rid of about half of the values in the tree,
and after <span class="arithmatex">\(log_2(N)\)</span> divisions by two you will end up at a leaf.</p>
<p>Unfortunately, if you add elements to the tree naively,
you can easily end up with an unbalanced tree,
where some branches of the tree are empty
and others have large numbers of nodes.
In the worst case,
the tree will only have nodes on one side (left or right)
and then it's no better than a linked list.
This means that searching through the tree will be <span class="arithmatex">\(O(N)\)</span>, not <span class="arithmatex">\(O(log\ N)\)</span>.</p>
<p>There needs to be some way to make sure
that the tree stays balanced when you add new values to it.
If you can guarantee that the tree stays balanced,
you can guarantee that searching for values in the tree
and adding new values to the tree are <span class="arithmatex">\(O(log\ N)\)</span> operations,
which is acceptably fast for many applications.</p>
<p>Self-balancing binary trees generally have
additional data in each node which helps in the balancing operation.
In the case of WB trees, this data is called a "size" and is an integer &gt;= 0.
Leaves have a size of zero
(this does not need to be stored explicitly in the tree),
while nodes have sizes &gt; 0.
The size of a node is simply the number of nodes (not leaves)
in the subtree rooted at the node.
So, for instance, a node with two leaves as children has a size of 1,
while a node with one leaf child and one node child
which itself has two leaf children has size 2, <em>etc.</em></p>
<p>Some terminology we'll use:</p>
<ul>
<li>
<p>The "root node" of a tree is the topmost node of the tree.</p>
</li>
<li>
<p>A "child node" of a node is the root node of one of its subtrees.</p>
</li>
<li>
<p>A "parent node" of a node
is the node which has the original node as one of its child nodes.
Note that root nodes have no parent node.</p>
</li>
<li>
<p>A "grandparent node" is the parent node of a node's parent node.</p>
</li>
<li>
<p>"Naively adding" a value to a tree
is adding a node containing the value to the tree
without worrying about whether the tree becomes unbalanced or not.</p>
</li>
</ul>
<p>For the purposes of these terms, a leaf is considered a kind of node.</p>
<p>Here is the definition of the WB tree datatype:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">type</span> <span class="n">tree</span> <span class="o">=</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>  <span class="o">|</span> <span class="nc">Leaf</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>  <span class="o">|</span> <span class="nc">Node</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="n">tree</span> <span class="o">*</span> <span class="n">tree</span>   <span class="c">(* size, value, left/right subtrees *)</span>
</span></code></pre></div>
<p>This is the same as the definition of <code>tree</code> given above,
except that there is an extra <code>int</code> value stored at each node
representing the size of the node.
Note that the <em>first</em> <code>int</code> value in the node is the size
and the <em>second</em> one is the integer value being stored at the node.
After that comes the left and right subtrees of the node,
which can be <code>Leaf</code> nodes or not.</p>
<p>A WB tree must satisfy the following invariants:</p>
<ol>
<li>
<p>A node's value must be strictly larger
than any value stored in its left subtree
and strictly smaller than any value stored in its right subtree.
(This is the order invariant that all ordered binary trees must have.)</p>
</li>
<li>
<p>The data values stored in the tree must contain no duplicates.</p>
</li>
<li>
<p>The size of a <code>Leaf</code> is zero.</p>
</li>
<li>
<p>The size of a <code>Node</code> is the sum of the sizes of its children, plus 1.</p>
</li>
<li>
<p>Subtrees of a <code>Node</code> must satisfy a <em>balancing condition</em>,
which is parameterized around a positive constant called <code>delta</code>.
Specifically, the condition is:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">(</span><span class="n">size</span><span class="o">(</span><span class="nc">L</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&lt;=</span> <span class="n">delta</span> <span class="o">*</span> <span class="o">(</span><span class="n">size</span><span class="o">(</span><span class="nc">R</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">(</span><span class="n">size</span><span class="o">(</span><span class="nc">R</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&lt;=</span> <span class="n">delta</span> <span class="o">*</span> <span class="o">(</span><span class="n">size</span><span class="o">(</span><span class="nc">L</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span>
</span></code></pre></div>
<p>(We will use a value of 3 for <code>delta</code>.)
What this condition means is roughly that
neither subtree of a node is allowed to have a size
more than <code>delta</code> times the size of the other subtree.
If this is true,
the tree will be balanced enough
to support <span class="arithmatex">\(O(log\ N)\)</span> lookups and insertions.</p>
</li>
</ol>
<p>Note that some of these invariants can (and will) be violated temporarily
while inserting new values into an WB tree,
but then the tree must be readjusted so that the invariants again apply.</p>
<p>The WB trees we will be working with are <strong>purely functional</strong>,
so (for instance) inserting an integer into a tree
will yield a new tree instead of changing the old one.</p>
<h2 id="examples">Examples</h2>
<p>Let's look at some WB trees.
We'll add some integers between 1 and 100 to an empty WB tree
and see what the resulting trees look like.
In some cases, adding a number to a tree in a "naive" way
would result in an unbalanced tree
(which is not a valid WB tree);
in that case, after adding the node
we will have to <em>rebalance</em> the tree to preserve the invariants.
We will look at the tree before and after rebalancing,
so you can get an idea of what the balancing operations do
before we describe the code you will need to write.
We will mention which rebalancing operations we are using;
the details of these operations will be discussed in the next section.</p>
<p><img alt="" src="../images/t0.svg" width="50" /></p>
<p>This is a leaf node (which is also an empty tree).
It doesn't store any data. It has size 0.
There's not much else to say about it.</p>
<p><img alt="" src="../images/t1.svg" width="150" /></p>
<p>Adding the number <code>2</code> creates a node whose two subtrees are both leaves.
The <code>2</code> in the node label is the value stored in the node.
The <code>(S 1)</code> says that this node has size 1.
This has to be the case because its subtrees are both leaves,
which have size 0,
and the size of a node is always exactly one higher
than the sum of the sizes of its subtrees.</p>
<p><img alt="" src="../images/t2.svg" width="200" /></p>
<p>Adding the number <code>66</code> creates a new node
on the right subtree of the node containing <code>2</code>.
The new node has size 1 (as all new nodes must have).
No rebalancing is necessary.</p>
<p><img alt="" src="../images/t3.svg" width="200" /></p>
<p>Adding the number <code>36</code> creates a new node
on the left subtree of the node containing <code>66</code>.
Again, no rebalancing is necessary.</p>
<p><img alt="" src="../images/t4_n.svg" width="270" /></p>
<p>Adding the number <code>85</code> creates a new node
on the right subtree of the node containing <code>66</code>.
At this point, we have to rebalance the tree
because the size of the tree rooted at 66 is 3
whereas the size of the other child of node 2 is 0.
Invariant #5 says that adding 1 to both sizes gives a ratio of 1 to 4,
which is more than <code>delta</code> (3).</p>
<p><img alt="" src="../images/t4.svg" width="350" /></p>
<p>The rebalancing operation we do
is called a <em>single left rotation</em> of the tree rooted at 2
(<em>i.e.</em> the entire tree).
This is one of four different kinds
of primitive tree balancing operations;
we will describe it in the next section.
Note that the tree now looks balanced and is still ordered (invariant #1).</p>
<p><img alt="" src="../images/t5.svg" width="450" /></p>
<p>Adding the number <code>96</code> doesn't cause the tree to become unbalanced
(at least, not by the criteria of invariant #5, which is good enough for us).</p>
<p><img alt="" src="../images/t6.svg" width="450" /></p>
<p>Adding the number <code>7</code> doesn't cause the tree to become unbalanced either.</p>
<p><img alt="" src="../images/t7_n.svg" width="450" /></p>
<p>Adding the number <code>26</code> gives an unbalanced tree.
Invariant #5 is violated at the subtree starting from the node with <code>2</code>;
its left subtree has size 0 and its right subtree has size 3,
so the ratio is (3 + 1) to (0 + 1) which is 4 to 1 (more than <code>delta</code>).
Therefore, we have to rebalance.</p>
<p><img alt="" src="../images/t7.svg" width="550" /></p>
<p>This is the result after rebalancing.
The rebalancing operation here is called a <em>double left rotation</em>
and is more complicated than the single left rotation we saw previously.
In addition to the parameter <code>delta</code>,
there is a second parameter <code>gamma</code> which decides,
when a rebalancing operation needs to occur,
whether a single or double rotation needs to happen.
You don't need to worry about the details of this,
because the code that handles this will be supplied to you
(your job will be to implement the rotations).</p>
<p><img alt="" src="../images/t8.svg" width="550" /></p>
<p>Adding the number <code>12</code> doesn't cause the tree to become unbalanced.</p>
<p><img alt="" src="../images/t9.svg" width="600" /></p>
<p>Adding the number <code>62</code> doesn't cause the tree to become unbalanced.</p>
<p><img alt="" src="../images/t10.svg" width="600" /></p>
<p>Adding the number <code>38</code> doesn't cause the tree to become unbalanced,
but it's clear we can't keep this up forever.
The subtree rooted at <code>7</code> is starting to look like
it might need a rotation soon.</p>
<p><img alt="" src="../images/t11_n.svg" width="650" /></p>
<p>Adding the number <code>14</code> makes the tree rooted at <code>7</code> unbalanced (why?).
We need to rebalance.</p>
<p><img alt="" src="../images/t11.svg" width="750" /></p>
<p>We do a single left rotation at the tree rooted at <code>7</code>,
and this restores the balance.
Notice that the balance criteria at the root node
makes the tree just barely balanced there
(<code>(8+1) / (2+1)</code> is a ratio of 3 to 1);
adding anything to the left subtree will certainly make it unbalanced again.</p>
<p><img alt="" src="../images/t12_n.svg" width="750" /></p>
<p>Adding the number <code>23</code> indeed makes the tree unbalanced.
First, the node with <code>26</code> is unbalanced.
This requires a <em>double right rotation</em> around that node.
Even when this happens,
the root node (with the number <code>66</code>) is also unbalanced;
that will require a <em>single right rotation</em> to rebalance it.</p>
<p>It's important to realize that rebalancing a tree after adding a new node
can require more than one rotation.
We work from the outermost parts of the tree inward, rebalancing as needed.</p>
<p><img alt="" src="../images/t12.svg" width="800" /></p>
<p>After all these rebalancings, the tree is once again in good shape.
At this point,
we have seen all four of the tree rotations we will need for rebalancing.</p>
<p>This concludes the WB tree examples.
We hope you now have a clearer idea of how WB trees work
and how they stay balanced.</p>
<h2 id="tree-rotations">Tree rotations</h2>
<p>In the examples given above,
we've seen that there are a number of balancing operations or "rotations"
that are done to make an unbalanced tree balanced.
Be aware that we don't require that the tree be exactly 100% balanced.
In the case of WB trees,
the balance criteria ensure that subtrees of a node can't contain
more than about 3 times the nodes of each other (if <code>delta</code> is 3),
which is enough to preserve
the <span class="arithmatex">\(O(log\ N)\)</span> lookup and insert properties we want.
What the rotations do is
rebalance a tree while preserving the order invariant.
What kind of rotation you do
depends on the way in which the tree is unbalanced.
We've seen that WB trees have four different kinds of rotations:</p>
<ul>
<li>single left rotation</li>
<li>single right rotation</li>
<li>double left rotation</li>
<li>double right rotation</li>
</ul>
<p>When you do these rotations in the appropriate circumstances,
the tree will become balanced and the order invariant will be preserved.</p>
<p>Here is what a single left rotation looks like.
Starting from this:</p>
<p><img alt="" src="../images/left_single_rotation1.svg" width="300" /></p>
<p>We go to this:</p>
<p><img alt="" src="../images/left_single_rotation2.svg" width="300" /></p>
<p>In these diagrams, <code>a</code> and <code>c</code> are nodes while <code>X</code>, <code>Y</code> and <code>Z</code> are subtrees.
See if you can convince yourself
that this will not violate the order invariant.</p>
<p>Here is what a single right rotation looks like.
Starting from this:</p>
<p><img alt="" src="../images/right_single_rotation1.svg" width="300" /></p>
<p>We go to this:</p>
<p><img alt="" src="../images/right_single_rotation2.svg" width="300" /></p>
<p>Note that a single right rotation simply undoes a single left rotation.</p>
<p>Here is what a double left rotation looks like.
Starting from this:</p>
<p><img alt="" src="../images/left_double_rotation1.svg" width="300" /></p>
<p>We go to this:</p>
<p><img alt="" src="../images/left_double_rotation2.svg" width="500" /></p>
<p>In these diagrams,
<code>a</code>, <code>b</code>, <code>c</code> represent nodes
while <code>X</code>, <code>Y0</code>, <code>Y1</code> and <code>Z</code> represent subtrees.</p>
<p>Here is what a double right rotation looks like.  Starting from this:</p>
<p><img alt="" src="../images/right_double_rotation1.svg" width="300" /></p>
<p>We go to this:</p>
<p><img alt="" src="../images/right_double_rotation2.svg" width="500" /></p>
<p>Notice that the starting point of the double right rotation
is the mirror-image of the starting point of the double left rotation,
and that both rotations end up with the same tree.</p>
<p>That's all we have to say about rotations!</p>
<h2 id="inserting-into-a-wb-tree">Inserting into a WB tree</h2>
<p>Once you can do rotations,
it's fairly easy to implement insertions into a tree
so as to keep the tree balanced.
Here is an outline of the algorithm.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You don't have to implement this algorithm,
since it's implemented for you (see below).
You just have to implement the rotations.</p>
</div>
<p>First, insert the new value into the tree
by following the branches based on the value to be inserted
and the values at the nodes.
If the new value is smaller than the node value,
insert it into the left subtree,
if it's larger, insert it into the right subtree,
and if it's the same, then the new value is already in the tree
so do nothing.
Once you get to a leaf,
replace it with a new node
with the new value and two leaves as children.
Of course, we want to do this functionally,
so we aren't really replacing anything;
we are building up a new tree
as we go along out of the parts of the old tree.
Therefore, the "replacement" step
is to put in a new node with the new value
in place of what was a leaf in the original tree;
this new node has leaves for children.</p>
<p>Now that we have the new value in the tree,
we need to make sure that the tree is balanced,
and if not, we need to balance it.
The new node we just created is obviously balanced
(it has two leaves as children, both of which have depth 0),
so we look at the parent of that node,
and then the parent of that node,
and so on until we reach an unbalanced node
or until we reach the root of the tree.
We use the <code>delta</code> parameter and invariant #5
to tell us if the tree is unbalanced.
If we reach the root of the tree, we're done!
If we find an unbalanced node,
we have to decide what kind of rebalancing operation is needed.
If we added to a left subtree,
we need to do a right rotation,
and vice versa.
Whether we do a single or double rotation
depends upon the <code>gamma</code> parameter we mentioned above.
The criterion is:</p>
<div class="arithmatex">\[
weight(T_A) &lt; \Gamma\cdot weight(T_B)
\]</div>
<p>(where <span class="arithmatex">\(\Gamma\)</span> is <code>gamma</code>,
<span class="arithmatex">\(T_A\)</span> is subtree "A",
and <span class="arithmatex">\(T_B\)</span> is subtree "B".)
If <span class="arithmatex">\(weight(T_A)\)</span> is less than
<span class="arithmatex">\(\Gamma\cdot weight(T_B)\)</span>,
do a single rotation;
otherwise, do a double rotation.</p>
<p>We use a value of 2 for <code>gamma</code>;
this has been proved to work correctly
and to be decently efficient.
The details of how this works are beyond the scope of this discussion,
but the code is supplied for you.</p>
<p>Once we rebalance around a node,
we have to go up to the parent of the node
and again check to see if we need to rebalance <em>that</em> node,
and so on up to the root of the tree.</p>
<p>That completes our description of WB trees.
Now we have to implement this in OCaml!</p>
<h2 id="ocaml-implementation-and-template-code">OCaml implementation and template code</h2>
<p>Everything in this implementation
(and, indeed, in this entire midterm) must be purely functional.
<strong>Do not use imperative code anywhere.</strong>
So don't use <code>ref</code>, or the <code>:=</code> or <code>!</code> operators.
(There is one exception:
we provide a <code>debug</code> variable which is <code>true</code> by default;
it may help you with debugging.
Feel free to set it to <code>false</code> if you don't need it,
but don't remove it.)</p>
<p>Use the following code as a template for your solution.  Don't leave anything
out, because the proper functioning of the data structure and the test scripts
require it.  Your job is to fill in the code where it's marked <code>failwith
"TODO"</code> as well as construct the missing patterns where it's marked <code>&lt;??&gt;</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can copy the entire block of code to your computer's clipboard
by clicking on the icon in the upper-right corner of the code block.</p>
</div>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c">(* Implementation of weight-balanced trees in OCaml. *)</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="k">let</span> <span class="n">tree_debug</span> <span class="o">=</span> <span class="n">ref</span> <span class="bp">true</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c">(* Parameters.</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="c"> * - delta is used to decide if any rotation needs to be made at all</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="c"> * - gamma is used to decide between a single and a double rotation</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="c"> *)</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="k">let</span> <span class="n">delta</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="k">let</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="k">type</span> <span class="n">tree</span> <span class="o">=</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>  <span class="o">|</span> <span class="nc">Leaf</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>  <span class="o">|</span> <span class="nc">Node</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="n">tree</span> <span class="o">*</span> <span class="n">tree</span>  <span class="c">(* size, value, left/right subtrees *)</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="k">let</span> <span class="n">get_size</span> <span class="o">=</span> <span class="k">function</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>  <span class="o">|</span> <span class="nc">Leaf</span> <span class="o">-&gt;</span> <span class="mi">0</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>  <span class="o">|</span> <span class="nc">Node</span> <span class="o">(</span><span class="n">s</span><span class="o">,</span> <span class="o">_,</span> <span class="o">_,</span> <span class="o">_)</span> <span class="o">-&gt;</span> <span class="n">s</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="k">let</span> <span class="n">empty</span> <span class="o">=</span> <span class="nc">Leaf</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="k">let</span> <span class="n">singleton</span> <span class="n">v</span> <span class="o">=</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">v</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">)</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="c">(* Build a node with the correct weight</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="c">   from a value `v`, a left subtree `l`,</span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="c">   and a right subtree `r`. *)</span>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="k">let</span> <span class="n">node</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span> <span class="o">=</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>  <span class="k">let</span> <span class="n">w</span> <span class="o">=</span> <span class="n">get_size</span> <span class="n">l</span> <span class="o">+</span> <span class="n">get_size</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">in</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>    <span class="nc">Node</span> <span class="o">(</span><span class="n">w</span><span class="o">,</span> <span class="n">v</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">)</span>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="c">(* Are two subtrees balanced with respect to each other</span>
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a><span class="c"> * i.e. &quot;relatively balanced&quot;?</span>
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="c"> * Criterion:</span>
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="c"> *   The &quot;weight&quot; of subtree b is &lt;=</span>
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="c"> *   delta times the &quot;weight&quot; of subtree a.</span>
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="c"> *   &quot;weight&quot; is just the size + 1.</span>
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a><span class="c"> *)</span>
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="k">let</span> <span class="n">rel_balanced</span> <span class="n">a</span> <span class="n">b</span> <span class="o">=</span>
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a>  <span class="k">let</span> <span class="n">wa</span> <span class="o">=</span> <span class="n">get_size</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">in</span>
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a>  <span class="k">let</span> <span class="n">wb</span> <span class="o">=</span> <span class="n">get_size</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">in</span>
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a>    <span class="n">wb</span> <span class="o">&lt;=</span> <span class="n">delta</span> <span class="o">*</span> <span class="n">wa</span>
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a>
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a><span class="c">(* Is a single rotation indicated?</span>
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a><span class="c"> * Criterion:</span>
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a><span class="c"> *   The weight of subtree a is less than gamma times</span>
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a><span class="c"> *   the weight of subtree b.</span>
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a><span class="c"> *)</span>
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a><span class="k">let</span> <span class="n">need_single_rot</span> <span class="n">a</span> <span class="n">b</span> <span class="o">=</span>
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a>  <span class="k">let</span> <span class="n">wa</span> <span class="o">=</span> <span class="n">get_size</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">in</span>
</span><span id="__span-3-50"><a id="__codelineno-3-50" name="__codelineno-3-50" href="#__codelineno-3-50"></a>  <span class="k">let</span> <span class="n">wb</span> <span class="o">=</span> <span class="n">get_size</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">in</span>
</span><span id="__span-3-51"><a id="__codelineno-3-51" name="__codelineno-3-51" href="#__codelineno-3-51"></a>    <span class="n">wa</span> <span class="o">&lt;</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">wb</span>
</span><span id="__span-3-52"><a id="__codelineno-3-52" name="__codelineno-3-52" href="#__codelineno-3-52"></a>
</span><span id="__span-3-53"><a id="__codelineno-3-53" name="__codelineno-3-53" href="#__codelineno-3-53"></a><span class="c">(* Find the minimum element in a tree.</span>
</span><span id="__span-3-54"><a id="__codelineno-3-54" name="__codelineno-3-54" href="#__codelineno-3-54"></a><span class="c"> * This assumes that the tree is ordered. *)</span>
</span><span id="__span-3-55"><a id="__codelineno-3-55" name="__codelineno-3-55" href="#__codelineno-3-55"></a><span class="k">let</span> <span class="k">rec</span> <span class="n">min_tree</span> <span class="o">=</span> <span class="k">function</span>
</span><span id="__span-3-56"><a id="__codelineno-3-56" name="__codelineno-3-56" href="#__codelineno-3-56"></a>  <span class="o">|</span> <span class="nc">Leaf</span> <span class="o">-&gt;</span> <span class="nc">None</span>
</span><span id="__span-3-57"><a id="__codelineno-3-57" name="__codelineno-3-57" href="#__codelineno-3-57"></a>  <span class="o">|</span> <span class="nc">Node</span> <span class="o">(_,</span> <span class="n">i</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="o">_)</span> <span class="o">-&gt;</span>
</span><span id="__span-3-58"><a id="__codelineno-3-58" name="__codelineno-3-58" href="#__codelineno-3-58"></a>    <span class="k">begin</span>
</span><span id="__span-3-59"><a id="__codelineno-3-59" name="__codelineno-3-59" href="#__codelineno-3-59"></a>      <span class="k">match</span> <span class="n">min_tree</span> <span class="n">l</span> <span class="k">with</span>
</span><span id="__span-3-60"><a id="__codelineno-3-60" name="__codelineno-3-60" href="#__codelineno-3-60"></a>        <span class="o">|</span> <span class="nc">None</span> <span class="o">-&gt;</span> <span class="nc">Some</span> <span class="n">i</span>
</span><span id="__span-3-61"><a id="__codelineno-3-61" name="__codelineno-3-61" href="#__codelineno-3-61"></a>        <span class="o">|</span> <span class="nc">Some</span> <span class="n">l&#39;</span> <span class="o">-&gt;</span> <span class="nc">Some</span> <span class="n">l&#39;</span>
</span><span id="__span-3-62"><a id="__codelineno-3-62" name="__codelineno-3-62" href="#__codelineno-3-62"></a>    <span class="k">end</span>
</span><span id="__span-3-63"><a id="__codelineno-3-63" name="__codelineno-3-63" href="#__codelineno-3-63"></a>
</span><span id="__span-3-64"><a id="__codelineno-3-64" name="__codelineno-3-64" href="#__codelineno-3-64"></a><span class="c">(* Find the maximum element in a tree.</span>
</span><span id="__span-3-65"><a id="__codelineno-3-65" name="__codelineno-3-65" href="#__codelineno-3-65"></a><span class="c"> * This assumes that the tree is ordered. *)</span>
</span><span id="__span-3-66"><a id="__codelineno-3-66" name="__codelineno-3-66" href="#__codelineno-3-66"></a><span class="k">let</span> <span class="k">rec</span> <span class="n">max_tree</span> <span class="o">=</span> <span class="k">function</span>
</span><span id="__span-3-67"><a id="__codelineno-3-67" name="__codelineno-3-67" href="#__codelineno-3-67"></a>  <span class="o">|</span> <span class="nc">Leaf</span> <span class="o">-&gt;</span> <span class="nc">None</span>
</span><span id="__span-3-68"><a id="__codelineno-3-68" name="__codelineno-3-68" href="#__codelineno-3-68"></a>  <span class="o">|</span> <span class="nc">Node</span> <span class="o">(_,</span> <span class="n">i</span><span class="o">,</span> <span class="o">_,</span> <span class="n">r</span><span class="o">)</span> <span class="o">-&gt;</span>
</span><span id="__span-3-69"><a id="__codelineno-3-69" name="__codelineno-3-69" href="#__codelineno-3-69"></a>    <span class="k">begin</span>
</span><span id="__span-3-70"><a id="__codelineno-3-70" name="__codelineno-3-70" href="#__codelineno-3-70"></a>      <span class="k">match</span> <span class="n">max_tree</span> <span class="n">r</span> <span class="k">with</span>
</span><span id="__span-3-71"><a id="__codelineno-3-71" name="__codelineno-3-71" href="#__codelineno-3-71"></a>        <span class="o">|</span> <span class="nc">None</span> <span class="o">-&gt;</span> <span class="nc">Some</span> <span class="n">i</span>
</span><span id="__span-3-72"><a id="__codelineno-3-72" name="__codelineno-3-72" href="#__codelineno-3-72"></a>        <span class="o">|</span> <span class="nc">Some</span> <span class="n">r&#39;</span> <span class="o">-&gt;</span> <span class="nc">Some</span> <span class="n">r&#39;</span>
</span><span id="__span-3-73"><a id="__codelineno-3-73" name="__codelineno-3-73" href="#__codelineno-3-73"></a>    <span class="k">end</span>
</span><span id="__span-3-74"><a id="__codelineno-3-74" name="__codelineno-3-74" href="#__codelineno-3-74"></a>
</span><span id="__span-3-75"><a id="__codelineno-3-75" name="__codelineno-3-75" href="#__codelineno-3-75"></a><span class="c">(* Is a tree ordered? *)</span>
</span><span id="__span-3-76"><a id="__codelineno-3-76" name="__codelineno-3-76" href="#__codelineno-3-76"></a><span class="k">let</span> <span class="k">rec</span> <span class="n">ordered</span> <span class="o">=</span> <span class="k">function</span>
</span><span id="__span-3-77"><a id="__codelineno-3-77" name="__codelineno-3-77" href="#__codelineno-3-77"></a>  <span class="o">|</span> <span class="nc">Leaf</span> <span class="o">-&gt;</span> <span class="bp">true</span>
</span><span id="__span-3-78"><a id="__codelineno-3-78" name="__codelineno-3-78" href="#__codelineno-3-78"></a>  <span class="o">|</span> <span class="nc">Node</span> <span class="o">(_,</span> <span class="n">i</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">)</span> <span class="o">-&gt;</span>
</span><span id="__span-3-79"><a id="__codelineno-3-79" name="__codelineno-3-79" href="#__codelineno-3-79"></a>    <span class="k">begin</span>
</span><span id="__span-3-80"><a id="__codelineno-3-80" name="__codelineno-3-80" href="#__codelineno-3-80"></a>      <span class="n">ordered</span> <span class="n">l</span> <span class="o">&amp;&amp;</span>
</span><span id="__span-3-81"><a id="__codelineno-3-81" name="__codelineno-3-81" href="#__codelineno-3-81"></a>      <span class="n">ordered</span> <span class="n">r</span> <span class="o">&amp;&amp;</span>
</span><span id="__span-3-82"><a id="__codelineno-3-82" name="__codelineno-3-82" href="#__codelineno-3-82"></a>      <span class="k">match</span> <span class="o">(</span><span class="n">max_tree</span> <span class="n">l</span><span class="o">,</span> <span class="n">min_tree</span> <span class="n">r</span><span class="o">)</span> <span class="k">with</span>
</span><span id="__span-3-83"><a id="__codelineno-3-83" name="__codelineno-3-83" href="#__codelineno-3-83"></a>        <span class="o">|</span> <span class="o">(</span><span class="nc">None</span><span class="o">,</span> <span class="nc">None</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="bp">true</span>
</span><span id="__span-3-84"><a id="__codelineno-3-84" name="__codelineno-3-84" href="#__codelineno-3-84"></a>        <span class="o">|</span> <span class="o">(</span><span class="nc">Some</span> <span class="n">l&#39;</span><span class="o">,</span> <span class="nc">None</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">l&#39;</span> <span class="o">&lt;</span> <span class="n">i</span>
</span><span id="__span-3-85"><a id="__codelineno-3-85" name="__codelineno-3-85" href="#__codelineno-3-85"></a>        <span class="o">|</span> <span class="o">(</span><span class="nc">None</span><span class="o">,</span> <span class="nc">Some</span> <span class="n">r&#39;</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">r&#39;</span>
</span><span id="__span-3-86"><a id="__codelineno-3-86" name="__codelineno-3-86" href="#__codelineno-3-86"></a>        <span class="o">|</span> <span class="o">(</span><span class="nc">Some</span> <span class="n">l&#39;</span><span class="o">,</span> <span class="nc">Some</span> <span class="n">r&#39;</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">l&#39;</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">r&#39;</span>
</span><span id="__span-3-87"><a id="__codelineno-3-87" name="__codelineno-3-87" href="#__codelineno-3-87"></a>    <span class="k">end</span>
</span><span id="__span-3-88"><a id="__codelineno-3-88" name="__codelineno-3-88" href="#__codelineno-3-88"></a>
</span><span id="__span-3-89"><a id="__codelineno-3-89" name="__codelineno-3-89" href="#__codelineno-3-89"></a><span class="c">(* Is a tree balanced with respect to the weight criteria? *)</span>
</span><span id="__span-3-90"><a id="__codelineno-3-90" name="__codelineno-3-90" href="#__codelineno-3-90"></a><span class="k">let</span> <span class="k">rec</span> <span class="n">balanced</span> <span class="o">=</span> <span class="k">function</span>
</span><span id="__span-3-91"><a id="__codelineno-3-91" name="__codelineno-3-91" href="#__codelineno-3-91"></a>  <span class="o">|</span> <span class="nc">Leaf</span> <span class="o">-&gt;</span> <span class="bp">true</span>
</span><span id="__span-3-92"><a id="__codelineno-3-92" name="__codelineno-3-92" href="#__codelineno-3-92"></a>  <span class="o">|</span> <span class="nc">Node</span> <span class="o">(_,</span> <span class="o">_,</span> <span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">)</span> <span class="o">-&gt;</span>
</span><span id="__span-3-93"><a id="__codelineno-3-93" name="__codelineno-3-93" href="#__codelineno-3-93"></a>      <span class="n">rel_balanced</span> <span class="n">l</span> <span class="n">r</span> <span class="o">&amp;&amp;</span>
</span><span id="__span-3-94"><a id="__codelineno-3-94" name="__codelineno-3-94" href="#__codelineno-3-94"></a>      <span class="n">rel_balanced</span> <span class="n">r</span> <span class="n">l</span> <span class="o">&amp;&amp;</span>
</span><span id="__span-3-95"><a id="__codelineno-3-95" name="__codelineno-3-95" href="#__codelineno-3-95"></a>      <span class="n">balanced</span> <span class="n">l</span> <span class="o">&amp;&amp;</span>
</span><span id="__span-3-96"><a id="__codelineno-3-96" name="__codelineno-3-96" href="#__codelineno-3-96"></a>      <span class="n">balanced</span> <span class="n">r</span>
</span><span id="__span-3-97"><a id="__codelineno-3-97" name="__codelineno-3-97" href="#__codelineno-3-97"></a>
</span><span id="__span-3-98"><a id="__codelineno-3-98" name="__codelineno-3-98" href="#__codelineno-3-98"></a><span class="c">(* ----------------------------------------------------------------------</span>
</span><span id="__span-3-99"><a id="__codelineno-3-99" name="__codelineno-3-99" href="#__codelineno-3-99"></a><span class="c"> * Tree rotations and rebalancing.</span>
</span><span id="__span-3-100"><a id="__codelineno-3-100" name="__codelineno-3-100" href="#__codelineno-3-100"></a><span class="c"> * ---------------------------------------------------------------------- *)</span>
</span><span id="__span-3-101"><a id="__codelineno-3-101" name="__codelineno-3-101" href="#__codelineno-3-101"></a>
</span><span id="__span-3-102"><a id="__codelineno-3-102" name="__codelineno-3-102" href="#__codelineno-3-102"></a><span class="k">let</span> <span class="n">single_l</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span> <span class="o">=</span>
</span><span id="__span-3-103"><a id="__codelineno-3-103" name="__codelineno-3-103" href="#__codelineno-3-103"></a>  <span class="k">if</span> <span class="o">!</span><span class="n">tree_debug</span> <span class="k">then</span>
</span><span id="__span-3-104"><a id="__codelineno-3-104" name="__codelineno-3-104" href="#__codelineno-3-104"></a>    <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;- single_l at tree rooted at %d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">v</span><span class="o">;</span>
</span><span id="__span-3-105"><a id="__codelineno-3-105" name="__codelineno-3-105" href="#__codelineno-3-105"></a>  <span class="k">match</span> <span class="n">r</span> <span class="k">with</span>
</span><span id="__span-3-106"><a id="__codelineno-3-106" name="__codelineno-3-106" href="#__codelineno-3-106"></a>    <span class="o">|</span> <span class="nc">Leaf</span> <span class="o">-&gt;</span> <span class="n">invalid_arg</span> <span class="s2">&quot;single_l&quot;</span>
</span><span id="__span-3-107"><a id="__codelineno-3-107" name="__codelineno-3-107" href="#__codelineno-3-107"></a>    <span class="o">|</span> <span class="nc">Node</span> <span class="o">&lt;??&gt;</span> <span class="o">-&gt;</span> <span class="n">failwith</span> <span class="s2">&quot;TODO&quot;</span>
</span><span id="__span-3-108"><a id="__codelineno-3-108" name="__codelineno-3-108" href="#__codelineno-3-108"></a>
</span><span id="__span-3-109"><a id="__codelineno-3-109" name="__codelineno-3-109" href="#__codelineno-3-109"></a><span class="k">let</span> <span class="n">double_l</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span> <span class="o">=</span>
</span><span id="__span-3-110"><a id="__codelineno-3-110" name="__codelineno-3-110" href="#__codelineno-3-110"></a>  <span class="k">if</span> <span class="o">!</span><span class="n">tree_debug</span> <span class="k">then</span>
</span><span id="__span-3-111"><a id="__codelineno-3-111" name="__codelineno-3-111" href="#__codelineno-3-111"></a>    <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;- double_l at tree rooted at %d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">v</span><span class="o">;</span>
</span><span id="__span-3-112"><a id="__codelineno-3-112" name="__codelineno-3-112" href="#__codelineno-3-112"></a>  <span class="k">match</span> <span class="n">r</span> <span class="k">with</span>
</span><span id="__span-3-113"><a id="__codelineno-3-113" name="__codelineno-3-113" href="#__codelineno-3-113"></a>    <span class="o">|</span> <span class="nc">Leaf</span>
</span><span id="__span-3-114"><a id="__codelineno-3-114" name="__codelineno-3-114" href="#__codelineno-3-114"></a>    <span class="o">|</span> <span class="nc">Node</span> <span class="o">(_,</span> <span class="o">_,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="o">_)</span> <span class="o">-&gt;</span> <span class="n">invalid_arg</span> <span class="s2">&quot;double_l&quot;</span>
</span><span id="__span-3-115"><a id="__codelineno-3-115" name="__codelineno-3-115" href="#__codelineno-3-115"></a>    <span class="o">|</span> <span class="nc">Node</span> <span class="o">&lt;??&gt;</span> <span class="o">-&gt;</span> <span class="n">failwith</span> <span class="s2">&quot;TODO&quot;</span>
</span><span id="__span-3-116"><a id="__codelineno-3-116" name="__codelineno-3-116" href="#__codelineno-3-116"></a>
</span><span id="__span-3-117"><a id="__codelineno-3-117" name="__codelineno-3-117" href="#__codelineno-3-117"></a><span class="k">let</span> <span class="n">rotate_l</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span> <span class="o">=</span>
</span><span id="__span-3-118"><a id="__codelineno-3-118" name="__codelineno-3-118" href="#__codelineno-3-118"></a>  <span class="k">if</span> <span class="o">!</span><span class="n">tree_debug</span> <span class="k">then</span>
</span><span id="__span-3-119"><a id="__codelineno-3-119" name="__codelineno-3-119" href="#__codelineno-3-119"></a>    <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;rotate_l at tree rooted at %d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">v</span><span class="o">;</span>
</span><span id="__span-3-120"><a id="__codelineno-3-120" name="__codelineno-3-120" href="#__codelineno-3-120"></a>  <span class="k">match</span> <span class="n">r</span> <span class="k">with</span>
</span><span id="__span-3-121"><a id="__codelineno-3-121" name="__codelineno-3-121" href="#__codelineno-3-121"></a>    <span class="o">|</span> <span class="nc">Leaf</span> <span class="o">-&gt;</span> <span class="n">invalid_arg</span> <span class="s2">&quot;rotate_l&quot;</span>
</span><span id="__span-3-122"><a id="__codelineno-3-122" name="__codelineno-3-122" href="#__codelineno-3-122"></a>    <span class="o">|</span> <span class="nc">Node</span> <span class="o">(_,</span> <span class="o">_,</span> <span class="n">rl</span><span class="o">,</span> <span class="n">rr</span><span class="o">)</span> <span class="o">-&gt;</span>
</span><span id="__span-3-123"><a id="__codelineno-3-123" name="__codelineno-3-123" href="#__codelineno-3-123"></a>      <span class="k">if</span> <span class="n">need_single_rot</span> <span class="n">rl</span> <span class="n">rr</span> <span class="k">then</span>
</span><span id="__span-3-124"><a id="__codelineno-3-124" name="__codelineno-3-124" href="#__codelineno-3-124"></a>        <span class="n">single_l</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span>
</span><span id="__span-3-125"><a id="__codelineno-3-125" name="__codelineno-3-125" href="#__codelineno-3-125"></a>      <span class="k">else</span>
</span><span id="__span-3-126"><a id="__codelineno-3-126" name="__codelineno-3-126" href="#__codelineno-3-126"></a>        <span class="n">double_l</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span>
</span><span id="__span-3-127"><a id="__codelineno-3-127" name="__codelineno-3-127" href="#__codelineno-3-127"></a>
</span><span id="__span-3-128"><a id="__codelineno-3-128" name="__codelineno-3-128" href="#__codelineno-3-128"></a><span class="k">let</span> <span class="n">single_r</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span> <span class="o">=</span>
</span><span id="__span-3-129"><a id="__codelineno-3-129" name="__codelineno-3-129" href="#__codelineno-3-129"></a>  <span class="k">if</span> <span class="o">!</span><span class="n">tree_debug</span> <span class="k">then</span>
</span><span id="__span-3-130"><a id="__codelineno-3-130" name="__codelineno-3-130" href="#__codelineno-3-130"></a>    <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;- single_r at tree rooted at %d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">v</span><span class="o">;</span>
</span><span id="__span-3-131"><a id="__codelineno-3-131" name="__codelineno-3-131" href="#__codelineno-3-131"></a>  <span class="k">match</span> <span class="n">l</span> <span class="k">with</span>
</span><span id="__span-3-132"><a id="__codelineno-3-132" name="__codelineno-3-132" href="#__codelineno-3-132"></a>    <span class="o">|</span> <span class="nc">Leaf</span> <span class="o">-&gt;</span> <span class="n">invalid_arg</span> <span class="s2">&quot;single_r&quot;</span>
</span><span id="__span-3-133"><a id="__codelineno-3-133" name="__codelineno-3-133" href="#__codelineno-3-133"></a>    <span class="o">|</span> <span class="nc">Node</span> <span class="o">&lt;??&gt;</span> <span class="o">-&gt;</span> <span class="n">failwith</span> <span class="s2">&quot;TODO&quot;</span>
</span><span id="__span-3-134"><a id="__codelineno-3-134" name="__codelineno-3-134" href="#__codelineno-3-134"></a>
</span><span id="__span-3-135"><a id="__codelineno-3-135" name="__codelineno-3-135" href="#__codelineno-3-135"></a><span class="k">let</span> <span class="n">double_r</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span> <span class="o">=</span>
</span><span id="__span-3-136"><a id="__codelineno-3-136" name="__codelineno-3-136" href="#__codelineno-3-136"></a>  <span class="k">if</span> <span class="o">!</span><span class="n">tree_debug</span> <span class="k">then</span>
</span><span id="__span-3-137"><a id="__codelineno-3-137" name="__codelineno-3-137" href="#__codelineno-3-137"></a>    <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;- double_r at tree rooted at %d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">v</span><span class="o">;</span>
</span><span id="__span-3-138"><a id="__codelineno-3-138" name="__codelineno-3-138" href="#__codelineno-3-138"></a>  <span class="k">match</span> <span class="n">l</span> <span class="k">with</span>
</span><span id="__span-3-139"><a id="__codelineno-3-139" name="__codelineno-3-139" href="#__codelineno-3-139"></a>    <span class="o">|</span> <span class="nc">Leaf</span>
</span><span id="__span-3-140"><a id="__codelineno-3-140" name="__codelineno-3-140" href="#__codelineno-3-140"></a>    <span class="o">|</span> <span class="nc">Node</span> <span class="o">(_,</span> <span class="o">_,</span> <span class="o">_,</span> <span class="nc">Leaf</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">invalid_arg</span> <span class="s2">&quot;double_r&quot;</span>
</span><span id="__span-3-141"><a id="__codelineno-3-141" name="__codelineno-3-141" href="#__codelineno-3-141"></a>    <span class="o">|</span> <span class="nc">Node</span> <span class="o">&lt;??&gt;</span> <span class="o">-&gt;</span> <span class="n">failwith</span> <span class="s2">&quot;TODO&quot;</span>
</span><span id="__span-3-142"><a id="__codelineno-3-142" name="__codelineno-3-142" href="#__codelineno-3-142"></a>
</span><span id="__span-3-143"><a id="__codelineno-3-143" name="__codelineno-3-143" href="#__codelineno-3-143"></a><span class="k">let</span> <span class="n">rotate_r</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span> <span class="o">=</span>
</span><span id="__span-3-144"><a id="__codelineno-3-144" name="__codelineno-3-144" href="#__codelineno-3-144"></a>  <span class="k">if</span> <span class="o">!</span><span class="n">tree_debug</span> <span class="k">then</span>
</span><span id="__span-3-145"><a id="__codelineno-3-145" name="__codelineno-3-145" href="#__codelineno-3-145"></a>    <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;rotate_r at tree rooted at %d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">v</span><span class="o">;</span>
</span><span id="__span-3-146"><a id="__codelineno-3-146" name="__codelineno-3-146" href="#__codelineno-3-146"></a>  <span class="k">match</span> <span class="n">l</span> <span class="k">with</span>
</span><span id="__span-3-147"><a id="__codelineno-3-147" name="__codelineno-3-147" href="#__codelineno-3-147"></a>    <span class="o">|</span> <span class="nc">Leaf</span> <span class="o">-&gt;</span> <span class="n">invalid_arg</span> <span class="s2">&quot;rotate_r&quot;</span>
</span><span id="__span-3-148"><a id="__codelineno-3-148" name="__codelineno-3-148" href="#__codelineno-3-148"></a>    <span class="o">|</span> <span class="nc">Node</span> <span class="o">(_,</span> <span class="o">_,</span> <span class="n">ll</span><span class="o">,</span> <span class="n">lr</span><span class="o">)</span> <span class="o">-&gt;</span>
</span><span id="__span-3-149"><a id="__codelineno-3-149" name="__codelineno-3-149" href="#__codelineno-3-149"></a>      <span class="k">if</span> <span class="n">need_single_rot</span> <span class="n">lr</span> <span class="n">ll</span> <span class="k">then</span>
</span><span id="__span-3-150"><a id="__codelineno-3-150" name="__codelineno-3-150" href="#__codelineno-3-150"></a>        <span class="n">single_r</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span>
</span><span id="__span-3-151"><a id="__codelineno-3-151" name="__codelineno-3-151" href="#__codelineno-3-151"></a>      <span class="k">else</span>
</span><span id="__span-3-152"><a id="__codelineno-3-152" name="__codelineno-3-152" href="#__codelineno-3-152"></a>        <span class="n">double_r</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span>
</span><span id="__span-3-153"><a id="__codelineno-3-153" name="__codelineno-3-153" href="#__codelineno-3-153"></a>
</span><span id="__span-3-154"><a id="__codelineno-3-154" name="__codelineno-3-154" href="#__codelineno-3-154"></a><span class="c">(* ----------------------------------------------------------------------</span>
</span><span id="__span-3-155"><a id="__codelineno-3-155" name="__codelineno-3-155" href="#__codelineno-3-155"></a><span class="c"> * Membership testing.</span>
</span><span id="__span-3-156"><a id="__codelineno-3-156" name="__codelineno-3-156" href="#__codelineno-3-156"></a><span class="c"> * ---------------------------------------------------------------------- *)</span>
</span><span id="__span-3-157"><a id="__codelineno-3-157" name="__codelineno-3-157" href="#__codelineno-3-157"></a>
</span><span id="__span-3-158"><a id="__codelineno-3-158" name="__codelineno-3-158" href="#__codelineno-3-158"></a><span class="c">(* Is a value a member of a tree? *)</span>
</span><span id="__span-3-159"><a id="__codelineno-3-159" name="__codelineno-3-159" href="#__codelineno-3-159"></a><span class="k">let</span> <span class="k">rec</span> <span class="n">tree_member</span> <span class="n">v</span> <span class="n">t</span> <span class="o">=</span> <span class="n">failwith</span> <span class="s2">&quot;TODO&quot;</span>
</span><span id="__span-3-160"><a id="__codelineno-3-160" name="__codelineno-3-160" href="#__codelineno-3-160"></a>
</span><span id="__span-3-161"><a id="__codelineno-3-161" name="__codelineno-3-161" href="#__codelineno-3-161"></a><span class="c">(* ----------------------------------------------------------------------</span>
</span><span id="__span-3-162"><a id="__codelineno-3-162" name="__codelineno-3-162" href="#__codelineno-3-162"></a><span class="c"> * Inserting values into trees.</span>
</span><span id="__span-3-163"><a id="__codelineno-3-163" name="__codelineno-3-163" href="#__codelineno-3-163"></a><span class="c"> * ---------------------------------------------------------------------- *)</span>
</span><span id="__span-3-164"><a id="__codelineno-3-164" name="__codelineno-3-164" href="#__codelineno-3-164"></a>
</span><span id="__span-3-165"><a id="__codelineno-3-165" name="__codelineno-3-165" href="#__codelineno-3-165"></a><span class="k">let</span> <span class="n">balance_l</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span> <span class="o">=</span>
</span><span id="__span-3-166"><a id="__codelineno-3-166" name="__codelineno-3-166" href="#__codelineno-3-166"></a>  <span class="k">if</span> <span class="n">rel_balanced</span> <span class="n">l</span> <span class="n">r</span> <span class="k">then</span>
</span><span id="__span-3-167"><a id="__codelineno-3-167" name="__codelineno-3-167" href="#__codelineno-3-167"></a>    <span class="n">node</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span>
</span><span id="__span-3-168"><a id="__codelineno-3-168" name="__codelineno-3-168" href="#__codelineno-3-168"></a>  <span class="k">else</span>
</span><span id="__span-3-169"><a id="__codelineno-3-169" name="__codelineno-3-169" href="#__codelineno-3-169"></a>    <span class="n">rotate_l</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span>
</span><span id="__span-3-170"><a id="__codelineno-3-170" name="__codelineno-3-170" href="#__codelineno-3-170"></a>
</span><span id="__span-3-171"><a id="__codelineno-3-171" name="__codelineno-3-171" href="#__codelineno-3-171"></a><span class="k">let</span> <span class="n">balance_r</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span> <span class="o">=</span>
</span><span id="__span-3-172"><a id="__codelineno-3-172" name="__codelineno-3-172" href="#__codelineno-3-172"></a>  <span class="k">if</span> <span class="n">rel_balanced</span> <span class="n">r</span> <span class="n">l</span> <span class="k">then</span>
</span><span id="__span-3-173"><a id="__codelineno-3-173" name="__codelineno-3-173" href="#__codelineno-3-173"></a>    <span class="n">node</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span>
</span><span id="__span-3-174"><a id="__codelineno-3-174" name="__codelineno-3-174" href="#__codelineno-3-174"></a>  <span class="k">else</span>
</span><span id="__span-3-175"><a id="__codelineno-3-175" name="__codelineno-3-175" href="#__codelineno-3-175"></a>    <span class="n">rotate_r</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span>
</span><span id="__span-3-176"><a id="__codelineno-3-176" name="__codelineno-3-176" href="#__codelineno-3-176"></a>
</span><span id="__span-3-177"><a id="__codelineno-3-177" name="__codelineno-3-177" href="#__codelineno-3-177"></a><span class="c">(* Insert a value into a tree with rebalancing. *)</span>
</span><span id="__span-3-178"><a id="__codelineno-3-178" name="__codelineno-3-178" href="#__codelineno-3-178"></a><span class="k">let</span> <span class="k">rec</span> <span class="n">insert</span> <span class="n">v</span> <span class="n">t</span> <span class="o">=</span>
</span><span id="__span-3-179"><a id="__codelineno-3-179" name="__codelineno-3-179" href="#__codelineno-3-179"></a>  <span class="k">match</span> <span class="n">t</span> <span class="k">with</span>
</span><span id="__span-3-180"><a id="__codelineno-3-180" name="__codelineno-3-180" href="#__codelineno-3-180"></a>    <span class="o">|</span> <span class="nc">Leaf</span> <span class="o">-&gt;</span> <span class="n">singleton</span> <span class="n">v</span>
</span><span id="__span-3-181"><a id="__codelineno-3-181" name="__codelineno-3-181" href="#__codelineno-3-181"></a>    <span class="o">|</span> <span class="nc">Node</span> <span class="o">(_,</span> <span class="n">v&#39;</span><span class="o">,</span> <span class="o">_,</span> <span class="o">_)</span> <span class="k">when</span> <span class="n">v</span> <span class="o">=</span> <span class="n">v&#39;</span> <span class="o">-&gt;</span> <span class="n">t</span>
</span><span id="__span-3-182"><a id="__codelineno-3-182" name="__codelineno-3-182" href="#__codelineno-3-182"></a>    <span class="o">|</span> <span class="nc">Node</span> <span class="o">(_,</span> <span class="n">v&#39;</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">)</span> <span class="o">-&gt;</span>
</span><span id="__span-3-183"><a id="__codelineno-3-183" name="__codelineno-3-183" href="#__codelineno-3-183"></a>        <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">v&#39;</span> <span class="k">then</span>
</span><span id="__span-3-184"><a id="__codelineno-3-184" name="__codelineno-3-184" href="#__codelineno-3-184"></a>          <span class="c">(* Adding to the left means you may have to rotate to the right. *)</span>
</span><span id="__span-3-185"><a id="__codelineno-3-185" name="__codelineno-3-185" href="#__codelineno-3-185"></a>          <span class="n">balance_r</span> <span class="n">v&#39;</span> <span class="o">(</span><span class="n">insert</span> <span class="n">v</span> <span class="n">l</span><span class="o">)</span> <span class="n">r</span>
</span><span id="__span-3-186"><a id="__codelineno-3-186" name="__codelineno-3-186" href="#__codelineno-3-186"></a>        <span class="k">else</span>
</span><span id="__span-3-187"><a id="__codelineno-3-187" name="__codelineno-3-187" href="#__codelineno-3-187"></a>          <span class="c">(* Adding to the right means you may have to rotate to the left. *)</span>
</span><span id="__span-3-188"><a id="__codelineno-3-188" name="__codelineno-3-188" href="#__codelineno-3-188"></a>          <span class="n">balance_l</span> <span class="n">v&#39;</span> <span class="n">l</span> <span class="o">(</span><span class="n">insert</span> <span class="n">v</span> <span class="n">r</span><span class="o">)</span>
</span></code></pre></div>
<p>Here are the functions you need to implement:</p>
<h2 id="1-8-points-tree_member">1. [<em>8 points</em>] <code>tree_member</code></h2>
<p>Write a function called <code>tree_member</code> that takes two arguments:
an <code>int</code> and a <code>tree</code>,
and returns <code>true</code> if the <code>int</code> is present in the tree,
or <code>false</code> otherwise.
You can assume that the tree is ordered
<em>i.e.</em> it satisfies the order invariant (invariant #1 above).</p>
<h2 id="2-8-points-single_l">2. [<em>8 points</em>] <code>single_l</code></h2>
<p>Fill in the code for the <code>single_l</code> function,
which implements a single left rotation as described above.
Note that the interface of the function is:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c">(* arguments: value, left subtree, right subtree *)</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">let</span> <span class="n">single_l</span> <span class="n">v</span> <span class="n">l</span> <span class="n">r</span> <span class="o">=</span> <span class="o">...</span>
</span></code></pre></div>
<p>and not:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c">(* argument: a tree *)</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">let</span> <span class="n">single_l</span> <span class="n">t</span> <span class="o">=</span> <span class="o">...</span>
</span></code></pre></div>
<p>What this means is that
instead of taking a complete tree as its only argument,
it takes a tree which has been separated into its components:
value, left subtree, and right subtree.
This is just for convenience;
it means that you don't have to consider the case
of rotation of a leaf node, which wouldn't make sense.
(The same applies to the code for the other rotations.)</p>
<p>You will want to use OCaml's pattern-matching capabilities
on <code>Node</code> constructors.
<strong>Remember that pattern-matches on recursive datatypes
can be more than one level.</strong>
For instance, a pattern match on a <code>Node</code> constructor
doesn't have to be just:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>  <span class="o">...</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>  <span class="o">|</span> <span class="nc">Node</span> <span class="o">(</span><span class="n">sz</span><span class="o">,</span> <span class="n">v</span><span class="o">,</span> <span class="n">left</span><span class="o">,</span> <span class="n">right</span><span class="o">)</span> <span class="o">-&gt;</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>  <span class="o">...</span>
</span></code></pre></div>
<p>If <code>left</code> and/or <code>right</code> are also <code>Node</code>s,
you can put them right into the pattern-match.  For instance:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>  <span class="o">...</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>  <span class="o">|</span> <span class="nc">Node</span> <span class="o">(</span><span class="n">sz</span><span class="o">,</span> <span class="n">v</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="n">sz2</span><span class="o">,</span> <span class="n">v2</span><span class="o">,</span> <span class="n">ll</span><span class="o">,</span> <span class="n">lr</span><span class="o">),</span> <span class="nc">Node</span> <span class="o">(</span><span class="n">sz3</span><span class="o">,</span> <span class="n">v3</span><span class="o">,</span> <span class="n">rl</span><span class="o">,</span> <span class="n">rr</span><span class="o">))</span> <span class="o">-&gt;</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>  <span class="o">...</span>
</span></code></pre></div>
<p>Here, if the subtrees are not both <code>Node</code>s, the pattern won't match.
Of course, you don't have to do this sort of thing,
but it can shorten the code you need to write.</p>
<p>When you convert the diagrams given above to the rotation code,
make sure to notice which parts of the trees change and which parts don't.
This can also shorten the code.</p>
<p>We've only included a few examples for these rotations,
because the test script provides far more realistic examples.
The examples given here also print out debugging messages,
which can be silenced by setting <code>tree_debug := false</code>.
(See below for the definition of <code>tree_of_list</code>.)</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="o">#</span> <span class="n">tree_of_list</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">5</span><span class="o">]</span> <span class="o">;;</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">rotate_l</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">1</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="o">-</span> <span class="n">single_l</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">1</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="o">-</span> <span class="o">:</span> <span class="n">tree</span> <span class="o">=</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="nc">Node</span> <span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">),</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a> <span class="nc">Node</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">))))</span>
</span></code></pre></div>
</div>
<h2 id="3-8-points-single_r">3. [<em>8 points</em>] <code>single_r</code></h2>
<p>Fill in the code for the <code>single_r</code> function.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="o">#</span> <span class="n">tree_of_list</span> <span class="o">[</span><span class="mi">5</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">]</span> <span class="o">;;</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">rotate_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">5</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="o">-</span> <span class="n">single_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">5</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="o">-</span> <span class="o">:</span> <span class="n">tree</span> <span class="o">=</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="nc">Node</span> <span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">),</span> <span class="nc">Leaf</span><span class="o">),</span> <span class="nc">Leaf</span><span class="o">),</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">))</span>
</span></code></pre></div>
</div>
<h2 id="4-8-points-double_l">4. [<em>8 points</em>] <code>double_l</code></h2>
<p>Fill in the code for the <code>double_l</code> function.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="o">#</span> <span class="n">tree_of_list</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">6</span><span class="o">;</span><span class="mi">5</span><span class="o">;</span><span class="mi">4</span><span class="o">]</span> <span class="o">;;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">rotate_l</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">1</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="o">-</span> <span class="n">single_l</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">1</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">rotate_l</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">3</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="o">-</span> <span class="n">double_l</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">3</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="o">-</span> <span class="o">:</span> <span class="n">tree</span> <span class="o">=</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="nc">Node</span> <span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">),</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a> <span class="nc">Node</span> <span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">)),</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>  <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">)))</span>
</span></code></pre></div>
</div>
<h2 id="5-8-points-double_r">5. [<em>8 points</em>] <code>double_r</code></h2>
<p>Fill in the code for the <code>double_r</code> function.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="o">#</span> <span class="n">tree_of_list</span> <span class="o">[</span><span class="mi">6</span><span class="o">;</span><span class="mi">5</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">]</span> <span class="o">;;</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">rotate_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">6</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="o">-</span> <span class="n">single_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">6</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">rotate_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">4</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="o">-</span> <span class="n">double_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">4</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="o">-</span> <span class="o">:</span> <span class="n">tree</span> <span class="o">=</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="nc">Node</span> <span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a> <span class="nc">Node</span> <span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">),</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>  <span class="nc">Node</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">),</span> <span class="nc">Leaf</span><span class="o">)),</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">))</span>
</span></code></pre></div>
</div>
<h2 id="testing">Testing</h2>
<p>Use the test script to check if your code runs correctly.
The test script includes the tree
constructed in the <em>Examples</em> section above.
In addition,
it provides randomized tests
where random integers are inserted into a tree
and the tree is checked after each insertion
to make sure that the ordering invariant
and the balancing invariant are not violated.
If your code has bugs, these tests should catch them.
In that case, a list will be printed out;
this represents the values that were added to an empty tree
that ended up causing a bug.
You can try interactively adding the list's elements to an empty tree yourself
and checking when the invariants are violated.</p>
<p>All of the tests are labeled,
so if a test fails you can use the label
to check which specific test in the test script failed.
Don't be afraid to look at the test script!</p>
<h2 id="additional-useful-functions-for-debuggingtesting">Additional useful functions for debugging/testing</h2>
<p>We are supplying you with some additional functions
which you should include in your exam code.
Some of these are used by the test script,
and they will also be useful for testing your code interactively.</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c">(* Convert a list into a tree *)</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="k">let</span> <span class="n">tree_of_list</span> <span class="n">lst</span> <span class="o">=</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>  <span class="nn">List</span><span class="p">.</span><span class="n">fold_left</span> <span class="o">(</span><span class="k">fun</span> <span class="n">t</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">insert</span> <span class="n">x</span> <span class="n">t</span><span class="o">)</span> <span class="n">empty</span> <span class="n">lst</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="c">(* Seed the random number generator. *)</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="k">let</span> <span class="o">_</span> <span class="o">=</span> <span class="nn">Random</span><span class="p">.</span><span class="n">self_init</span> <span class="bp">()</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="c">(* Generate a list of random integers.</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="c"> * Pick `n` random ints between `0` and `imax - 1`. *)</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="k">let</span> <span class="n">random_list</span> <span class="n">n</span> <span class="n">imax</span> <span class="o">=</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>  <span class="k">let</span> <span class="k">rec</span> <span class="n">iter</span> <span class="n">n</span> <span class="n">lst</span> <span class="o">=</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>      <span class="n">lst</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>    <span class="k">else</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>      <span class="n">iter</span> <span class="o">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="nn">Random</span><span class="p">.</span><span class="n">int</span> <span class="n">imax</span> <span class="o">::</span> <span class="n">lst</span><span class="o">)</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>  <span class="k">in</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>    <span class="n">iter</span> <span class="n">n</span> <span class="bp">[]</span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="c">(* Generate a tree of random integers.</span>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="c"> * Pick `n` random ints between `0` and `imax - 1`</span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="c"> * and add them to the tree one after another. *)</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="k">let</span> <span class="n">random_tree</span> <span class="n">n</span> <span class="n">imax</span> <span class="o">=</span> <span class="n">tree_of_list</span> <span class="o">(</span><span class="n">random_list</span> <span class="n">n</span> <span class="n">imax</span><span class="o">)</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="c">(* Pretty-print a tree. *)</span>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="k">let</span> <span class="n">print_tree</span> <span class="n">tree</span> <span class="o">=</span>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a>  <span class="k">let</span> <span class="n">blanks</span> <span class="n">n</span> <span class="o">=</span> <span class="nn">String</span><span class="p">.</span><span class="n">make</span> <span class="n">n</span> <span class="sc">&#39; &#39;</span> <span class="k">in</span>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a>  <span class="k">let</span> <span class="k">rec</span> <span class="n">aux</span> <span class="n">tree</span> <span class="n">indent</span> <span class="o">=</span>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a>    <span class="k">let</span> <span class="n">ind</span> <span class="o">=</span> <span class="n">blanks</span> <span class="n">indent</span> <span class="k">in</span>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a>      <span class="k">match</span> <span class="n">tree</span> <span class="k">with</span>
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a>        <span class="o">|</span> <span class="nc">Leaf</span> <span class="o">-&gt;</span> <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;%sLeaf</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">ind</span>
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a>        <span class="o">|</span> <span class="nc">Node</span> <span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="n">v</span><span class="o">,</span> <span class="n">l</span><span class="o">,</span> <span class="n">r</span><span class="o">)</span> <span class="o">-&gt;</span>
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a>          <span class="k">begin</span>
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a>            <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;%sNode[(%d) [size %d]</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">ind</span> <span class="n">v</span> <span class="n">d</span><span class="o">;</span>
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a>            <span class="n">aux</span> <span class="n">l</span> <span class="o">(</span><span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span><span class="o">);</span>
</span><span id="__span-12-35"><a id="__codelineno-12-35" name="__codelineno-12-35" href="#__codelineno-12-35"></a>            <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;%s  ----</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">ind</span><span class="o">;</span>
</span><span id="__span-12-36"><a id="__codelineno-12-36" name="__codelineno-12-36" href="#__codelineno-12-36"></a>            <span class="n">aux</span> <span class="n">r</span> <span class="o">(</span><span class="n">indent</span> <span class="o">+</span> <span class="mi">2</span><span class="o">);</span>
</span><span id="__span-12-37"><a id="__codelineno-12-37" name="__codelineno-12-37" href="#__codelineno-12-37"></a>            <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;%s]</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">ind</span><span class="o">;</span>
</span><span id="__span-12-38"><a id="__codelineno-12-38" name="__codelineno-12-38" href="#__codelineno-12-38"></a>          <span class="k">end</span>
</span><span id="__span-12-39"><a id="__codelineno-12-39" name="__codelineno-12-39" href="#__codelineno-12-39"></a>  <span class="k">in</span>
</span><span id="__span-12-40"><a id="__codelineno-12-40" name="__codelineno-12-40" href="#__codelineno-12-40"></a>    <span class="n">aux</span> <span class="n">tree</span> <span class="mi">0</span>
</span></code></pre></div>
<p>Here are some examples of how to use these functions:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c">(* Debugging code is enabled. *)</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="o">#</span> <span class="n">tree_of_list</span> <span class="o">[</span><span class="mi">10</span><span class="o">;</span><span class="mi">20</span><span class="o">;</span><span class="mi">30</span><span class="o">;</span><span class="mi">45</span><span class="o">;</span><span class="mi">55</span><span class="o">;</span><span class="mi">79</span><span class="o">];;</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="n">rotate_l</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">10</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="o">-</span> <span class="n">single_l</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">10</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="n">rotate_l</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">30</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="o">-</span> <span class="n">single_l</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">30</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="o">-</span> <span class="o">:</span> <span class="n">tree</span> <span class="o">=</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="nc">Node</span> <span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="mi">20</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">),</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a> <span class="nc">Node</span> <span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">45</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">30</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">),</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>  <span class="nc">Node</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">55</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">79</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">))))</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="o">#</span> <span class="n">random_tree</span> <span class="mi">10</span> <span class="mi">100</span> <span class="o">;;</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="o">-</span> <span class="o">:</span> <span class="n">tree</span> <span class="o">=</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="nc">Node</span> <span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">16</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">)),</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a> <span class="nc">Node</span> <span class="o">(</span><span class="mi">7</span><span class="o">,</span> <span class="mi">48</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">44</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">25</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">43</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">)),</span> <span class="nc">Leaf</span><span class="o">),</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>  <span class="nc">Node</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">50</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">84</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">76</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">),</span> <span class="nc">Leaf</span><span class="o">))))</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="o">#</span> <span class="n">random_tree</span> <span class="mi">20</span> <span class="mi">1000</span> <span class="o">;;</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="n">rotate_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">960</span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="o">-</span> <span class="n">single_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">960</span>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="n">rotate_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">960</span>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="o">-</span> <span class="n">single_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">960</span>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="n">rotate_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">488</span>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="o">-</span> <span class="n">single_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">488</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="n">rotate_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">468</span>
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="o">-</span> <span class="n">single_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">468</span>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="n">rotate_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">166</span>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="o">-</span> <span class="n">single_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">166</span>
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="o">-</span> <span class="o">:</span> <span class="n">tree</span> <span class="o">=</span>
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="nc">Node</span> <span class="o">(</span><span class="mi">20</span><span class="o">,</span> <span class="mi">771</span><span class="o">,</span>
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a> <span class="nc">Node</span> <span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">208</span><span class="o">,</span>
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a>  <span class="nc">Node</span> <span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">116</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">89</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">),</span>
</span><span id="__span-13-34"><a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a>   <span class="nc">Node</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">166</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">125</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">),</span> <span class="nc">Leaf</span><span class="o">)),</span>
</span><span id="__span-13-35"><a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a>  <span class="nc">Node</span> <span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">468</span><span class="o">,</span>
</span><span id="__span-13-36"><a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a>   <span class="nc">Node</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">352</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">326</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">),</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">461</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">)),</span>
</span><span id="__span-13-37"><a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a>   <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">488</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">))),</span>
</span><span id="__span-13-38"><a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a> <span class="nc">Node</span> <span class="o">(</span><span class="mi">9</span><span class="o">,</span> <span class="mi">947</span><span class="o">,</span>
</span><span id="__span-13-39"><a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a>  <span class="nc">Node</span> <span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">848</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">775</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">),</span>
</span><span id="__span-13-40"><a id="__codelineno-13-40" name="__codelineno-13-40" href="#__codelineno-13-40"></a>   <span class="nc">Node</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">862</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">939</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">874</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">),</span> <span class="nc">Leaf</span><span class="o">))),</span>
</span><span id="__span-13-41"><a id="__codelineno-13-41" name="__codelineno-13-41" href="#__codelineno-13-41"></a>  <span class="nc">Node</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">960</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">973</span><span class="o">,</span> <span class="nc">Node</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">961</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">),</span> <span class="nc">Leaf</span><span class="o">))))</span>
</span><span id="__span-13-42"><a id="__codelineno-13-42" name="__codelineno-13-42" href="#__codelineno-13-42"></a>
</span><span id="__span-13-43"><a id="__codelineno-13-43" name="__codelineno-13-43" href="#__codelineno-13-43"></a><span class="o">#</span> <span class="k">let</span> <span class="n">pt</span> <span class="n">lst</span> <span class="o">=</span> <span class="n">print_tree</span> <span class="o">(</span><span class="n">tree_of_list</span> <span class="n">lst</span><span class="o">)</span> <span class="o">;;</span>
</span><span id="__span-13-44"><a id="__codelineno-13-44" name="__codelineno-13-44" href="#__codelineno-13-44"></a><span class="k">val</span> <span class="n">pt</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">-&gt;</span> <span class="kt">unit</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-13-45"><a id="__codelineno-13-45" name="__codelineno-13-45" href="#__codelineno-13-45"></a>
</span><span id="__span-13-46"><a id="__codelineno-13-46" name="__codelineno-13-46" href="#__codelineno-13-46"></a><span class="o">#</span> <span class="n">pt</span> <span class="bp">[]</span> <span class="o">;;</span>
</span><span id="__span-13-47"><a id="__codelineno-13-47" name="__codelineno-13-47" href="#__codelineno-13-47"></a><span class="nc">Leaf</span>
</span><span id="__span-13-48"><a id="__codelineno-13-48" name="__codelineno-13-48" href="#__codelineno-13-48"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span><span id="__span-13-49"><a id="__codelineno-13-49" name="__codelineno-13-49" href="#__codelineno-13-49"></a>
</span><span id="__span-13-50"><a id="__codelineno-13-50" name="__codelineno-13-50" href="#__codelineno-13-50"></a><span class="o">#</span> <span class="n">pt</span> <span class="o">[</span><span class="mi">50</span><span class="o">;</span><span class="mi">40</span><span class="o">;</span><span class="mi">30</span><span class="o">]</span> <span class="o">;;</span>
</span><span id="__span-13-51"><a id="__codelineno-13-51" name="__codelineno-13-51" href="#__codelineno-13-51"></a><span class="nc">Node</span><span class="o">[(</span><span class="mi">50</span><span class="o">)</span> <span class="o">[</span><span class="n">size</span> <span class="mi">3</span><span class="o">]</span>
</span><span id="__span-13-52"><a id="__codelineno-13-52" name="__codelineno-13-52" href="#__codelineno-13-52"></a>  <span class="nc">Node</span><span class="o">[(</span><span class="mi">40</span><span class="o">)</span> <span class="o">[</span><span class="n">size</span> <span class="mi">2</span><span class="o">]</span>
</span><span id="__span-13-53"><a id="__codelineno-13-53" name="__codelineno-13-53" href="#__codelineno-13-53"></a>    <span class="nc">Node</span><span class="o">[(</span><span class="mi">30</span><span class="o">)</span> <span class="o">[</span><span class="n">size</span> <span class="mi">1</span><span class="o">]</span>
</span><span id="__span-13-54"><a id="__codelineno-13-54" name="__codelineno-13-54" href="#__codelineno-13-54"></a>      <span class="nc">Leaf</span>
</span><span id="__span-13-55"><a id="__codelineno-13-55" name="__codelineno-13-55" href="#__codelineno-13-55"></a>      <span class="o">----</span>
</span><span id="__span-13-56"><a id="__codelineno-13-56" name="__codelineno-13-56" href="#__codelineno-13-56"></a>      <span class="nc">Leaf</span>
</span><span id="__span-13-57"><a id="__codelineno-13-57" name="__codelineno-13-57" href="#__codelineno-13-57"></a>    <span class="o">]</span>
</span><span id="__span-13-58"><a id="__codelineno-13-58" name="__codelineno-13-58" href="#__codelineno-13-58"></a>    <span class="o">----</span>
</span><span id="__span-13-59"><a id="__codelineno-13-59" name="__codelineno-13-59" href="#__codelineno-13-59"></a>    <span class="nc">Leaf</span>
</span><span id="__span-13-60"><a id="__codelineno-13-60" name="__codelineno-13-60" href="#__codelineno-13-60"></a>  <span class="o">]</span>
</span><span id="__span-13-61"><a id="__codelineno-13-61" name="__codelineno-13-61" href="#__codelineno-13-61"></a>  <span class="o">----</span>
</span><span id="__span-13-62"><a id="__codelineno-13-62" name="__codelineno-13-62" href="#__codelineno-13-62"></a>  <span class="nc">Leaf</span>
</span><span id="__span-13-63"><a id="__codelineno-13-63" name="__codelineno-13-63" href="#__codelineno-13-63"></a><span class="o">]</span>
</span><span id="__span-13-64"><a id="__codelineno-13-64" name="__codelineno-13-64" href="#__codelineno-13-64"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span><span id="__span-13-65"><a id="__codelineno-13-65" name="__codelineno-13-65" href="#__codelineno-13-65"></a>
</span><span id="__span-13-66"><a id="__codelineno-13-66" name="__codelineno-13-66" href="#__codelineno-13-66"></a><span class="o">#</span> <span class="n">pt</span> <span class="o">[</span><span class="mi">50</span><span class="o">;</span><span class="mi">40</span><span class="o">;</span><span class="mi">30</span><span class="o">;</span><span class="mi">33</span><span class="o">;</span><span class="mi">36</span><span class="o">;</span><span class="mi">60</span><span class="o">;</span><span class="mi">70</span><span class="o">;</span><span class="mi">65</span><span class="o">;</span><span class="mi">62</span><span class="o">;</span><span class="mi">64</span><span class="o">]</span> <span class="o">;;</span>
</span><span id="__span-13-67"><a id="__codelineno-13-67" name="__codelineno-13-67" href="#__codelineno-13-67"></a><span class="n">rotate_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">50</span>
</span><span id="__span-13-68"><a id="__codelineno-13-68" name="__codelineno-13-68" href="#__codelineno-13-68"></a><span class="o">-</span> <span class="n">single_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">50</span>
</span><span id="__span-13-69"><a id="__codelineno-13-69" name="__codelineno-13-69" href="#__codelineno-13-69"></a><span class="n">rotate_l</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">50</span>
</span><span id="__span-13-70"><a id="__codelineno-13-70" name="__codelineno-13-70" href="#__codelineno-13-70"></a><span class="o">-</span> <span class="n">single_l</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">50</span>
</span><span id="__span-13-71"><a id="__codelineno-13-71" name="__codelineno-13-71" href="#__codelineno-13-71"></a><span class="n">rotate_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">70</span>
</span><span id="__span-13-72"><a id="__codelineno-13-72" name="__codelineno-13-72" href="#__codelineno-13-72"></a><span class="o">-</span> <span class="n">single_r</span> <span class="n">at</span> <span class="n">tree</span> <span class="n">rooted</span> <span class="n">at</span> <span class="mi">70</span>
</span><span id="__span-13-73"><a id="__codelineno-13-73" name="__codelineno-13-73" href="#__codelineno-13-73"></a><span class="nc">Node</span><span class="o">[(</span><span class="mi">40</span><span class="o">)</span> <span class="o">[</span><span class="n">size</span> <span class="mi">10</span><span class="o">]</span>
</span><span id="__span-13-74"><a id="__codelineno-13-74" name="__codelineno-13-74" href="#__codelineno-13-74"></a>  <span class="nc">Node</span><span class="o">[(</span><span class="mi">30</span><span class="o">)</span> <span class="o">[</span><span class="n">size</span> <span class="mi">3</span><span class="o">]</span>
</span><span id="__span-13-75"><a id="__codelineno-13-75" name="__codelineno-13-75" href="#__codelineno-13-75"></a>    <span class="nc">Leaf</span>
</span><span id="__span-13-76"><a id="__codelineno-13-76" name="__codelineno-13-76" href="#__codelineno-13-76"></a>    <span class="o">----</span>
</span><span id="__span-13-77"><a id="__codelineno-13-77" name="__codelineno-13-77" href="#__codelineno-13-77"></a>    <span class="nc">Node</span><span class="o">[(</span><span class="mi">33</span><span class="o">)</span> <span class="o">[</span><span class="n">size</span> <span class="mi">2</span><span class="o">]</span>
</span><span id="__span-13-78"><a id="__codelineno-13-78" name="__codelineno-13-78" href="#__codelineno-13-78"></a>      <span class="nc">Leaf</span>
</span><span id="__span-13-79"><a id="__codelineno-13-79" name="__codelineno-13-79" href="#__codelineno-13-79"></a>      <span class="o">----</span>
</span><span id="__span-13-80"><a id="__codelineno-13-80" name="__codelineno-13-80" href="#__codelineno-13-80"></a>      <span class="nc">Node</span><span class="o">[(</span><span class="mi">36</span><span class="o">)</span> <span class="o">[</span><span class="n">size</span> <span class="mi">1</span><span class="o">]</span>
</span><span id="__span-13-81"><a id="__codelineno-13-81" name="__codelineno-13-81" href="#__codelineno-13-81"></a>        <span class="nc">Leaf</span>
</span><span id="__span-13-82"><a id="__codelineno-13-82" name="__codelineno-13-82" href="#__codelineno-13-82"></a>        <span class="o">----</span>
</span><span id="__span-13-83"><a id="__codelineno-13-83" name="__codelineno-13-83" href="#__codelineno-13-83"></a>        <span class="nc">Leaf</span>
</span><span id="__span-13-84"><a id="__codelineno-13-84" name="__codelineno-13-84" href="#__codelineno-13-84"></a>      <span class="o">]</span>
</span><span id="__span-13-85"><a id="__codelineno-13-85" name="__codelineno-13-85" href="#__codelineno-13-85"></a>    <span class="o">]</span>
</span><span id="__span-13-86"><a id="__codelineno-13-86" name="__codelineno-13-86" href="#__codelineno-13-86"></a>  <span class="o">]</span>
</span><span id="__span-13-87"><a id="__codelineno-13-87" name="__codelineno-13-87" href="#__codelineno-13-87"></a>  <span class="o">----</span>
</span><span id="__span-13-88"><a id="__codelineno-13-88" name="__codelineno-13-88" href="#__codelineno-13-88"></a>  <span class="nc">Node</span><span class="o">[(</span><span class="mi">60</span><span class="o">)</span> <span class="o">[</span><span class="n">size</span> <span class="mi">6</span><span class="o">]</span>
</span><span id="__span-13-89"><a id="__codelineno-13-89" name="__codelineno-13-89" href="#__codelineno-13-89"></a>    <span class="nc">Node</span><span class="o">[(</span><span class="mi">50</span><span class="o">)</span> <span class="o">[</span><span class="n">size</span> <span class="mi">1</span><span class="o">]</span>
</span><span id="__span-13-90"><a id="__codelineno-13-90" name="__codelineno-13-90" href="#__codelineno-13-90"></a>      <span class="nc">Leaf</span>
</span><span id="__span-13-91"><a id="__codelineno-13-91" name="__codelineno-13-91" href="#__codelineno-13-91"></a>      <span class="o">----</span>
</span><span id="__span-13-92"><a id="__codelineno-13-92" name="__codelineno-13-92" href="#__codelineno-13-92"></a>      <span class="nc">Leaf</span>
</span><span id="__span-13-93"><a id="__codelineno-13-93" name="__codelineno-13-93" href="#__codelineno-13-93"></a>    <span class="o">]</span>
</span><span id="__span-13-94"><a id="__codelineno-13-94" name="__codelineno-13-94" href="#__codelineno-13-94"></a>    <span class="o">----</span>
</span><span id="__span-13-95"><a id="__codelineno-13-95" name="__codelineno-13-95" href="#__codelineno-13-95"></a>    <span class="nc">Node</span><span class="o">[(</span><span class="mi">65</span><span class="o">)</span> <span class="o">[</span><span class="n">size</span> <span class="mi">4</span><span class="o">]</span>
</span><span id="__span-13-96"><a id="__codelineno-13-96" name="__codelineno-13-96" href="#__codelineno-13-96"></a>      <span class="nc">Node</span><span class="o">[(</span><span class="mi">62</span><span class="o">)</span> <span class="o">[</span><span class="n">size</span> <span class="mi">2</span><span class="o">]</span>
</span><span id="__span-13-97"><a id="__codelineno-13-97" name="__codelineno-13-97" href="#__codelineno-13-97"></a>        <span class="nc">Leaf</span>
</span><span id="__span-13-98"><a id="__codelineno-13-98" name="__codelineno-13-98" href="#__codelineno-13-98"></a>        <span class="o">----</span>
</span><span id="__span-13-99"><a id="__codelineno-13-99" name="__codelineno-13-99" href="#__codelineno-13-99"></a>        <span class="nc">Node</span><span class="o">[(</span><span class="mi">64</span><span class="o">)</span> <span class="o">[</span><span class="n">size</span> <span class="mi">1</span><span class="o">]</span>
</span><span id="__span-13-100"><a id="__codelineno-13-100" name="__codelineno-13-100" href="#__codelineno-13-100"></a>          <span class="nc">Leaf</span>
</span><span id="__span-13-101"><a id="__codelineno-13-101" name="__codelineno-13-101" href="#__codelineno-13-101"></a>          <span class="o">----</span>
</span><span id="__span-13-102"><a id="__codelineno-13-102" name="__codelineno-13-102" href="#__codelineno-13-102"></a>          <span class="nc">Leaf</span>
</span><span id="__span-13-103"><a id="__codelineno-13-103" name="__codelineno-13-103" href="#__codelineno-13-103"></a>        <span class="o">]</span>
</span><span id="__span-13-104"><a id="__codelineno-13-104" name="__codelineno-13-104" href="#__codelineno-13-104"></a>      <span class="o">]</span>
</span><span id="__span-13-105"><a id="__codelineno-13-105" name="__codelineno-13-105" href="#__codelineno-13-105"></a>      <span class="o">----</span>
</span><span id="__span-13-106"><a id="__codelineno-13-106" name="__codelineno-13-106" href="#__codelineno-13-106"></a>      <span class="nc">Node</span><span class="o">[(</span><span class="mi">70</span><span class="o">)</span> <span class="o">[</span><span class="n">size</span> <span class="mi">1</span><span class="o">]</span>
</span><span id="__span-13-107"><a id="__codelineno-13-107" name="__codelineno-13-107" href="#__codelineno-13-107"></a>        <span class="nc">Leaf</span>
</span><span id="__span-13-108"><a id="__codelineno-13-108" name="__codelineno-13-108" href="#__codelineno-13-108"></a>        <span class="o">----</span>
</span><span id="__span-13-109"><a id="__codelineno-13-109" name="__codelineno-13-109" href="#__codelineno-13-109"></a>        <span class="nc">Leaf</span>
</span><span id="__span-13-110"><a id="__codelineno-13-110" name="__codelineno-13-110" href="#__codelineno-13-110"></a>      <span class="o">]</span>
</span><span id="__span-13-111"><a id="__codelineno-13-111" name="__codelineno-13-111" href="#__codelineno-13-111"></a>    <span class="o">]</span>
</span><span id="__span-13-112"><a id="__codelineno-13-112" name="__codelineno-13-112" href="#__codelineno-13-112"></a>  <span class="o">]</span>
</span><span id="__span-13-113"><a id="__codelineno-13-113" name="__codelineno-13-113" href="#__codelineno-13-113"></a><span class="o">]</span>
</span><span id="__span-13-114"><a id="__codelineno-13-114" name="__codelineno-13-114" href="#__codelineno-13-114"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span></code></pre></div>
<p>[End of midterm exam]</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../partB_lists_hofs/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Part B: Lists and HOFs">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Part B: Lists and HOFs
              </div>
            </div>
          </a>
        
        
          
          <a href="../../5/assignment5/" class="md-footer__link md-footer__link--next" aria-label="Next: Overview">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Overview
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.footer", "navigation.top"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="../../../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>