
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Part B: Recursion and higher-order functions &#8212; The CS 4 book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/design-tabs.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Part C: Data structures: AA trees" href="partC_data_structures.html" />
    <link rel="prev" title="Part A: Asymptotic time complexity" href="partA_complexity.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">The CS 4 book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../admin/index.html">
   Administrative information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../admin/Syllabus.html">
     Syllabus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../admin/Collaboration_policies.html">
     Collaboration policies
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Motivation.html">
   Motivation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../History.html">
   History
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../index.html">
   Assignments
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../../0/Assignment0.html">
     Assignment 0: Getting set up
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../1/index.html">
     Assignment 1: Evaluation and recursion
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/partA_exercises.html">
       Part A: Basic exercises
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/partB_evaluation.html">
       Part B: Evaluation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/partC_recursion.html">
       Part C: Recursion
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../2/index.html">
     Assignment 2: Asymptotic complexity and higher-order functions
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../2/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../2/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../2/sections/partA_orders_of_growth.html">
       Part A: Orders of growth
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../2/sections/partB_evaluation.html">
       Part B: Evaluation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../2/sections/partC_higher_order_functions.html">
       Part C. Higher-order functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../2/sections/partD_additional_problems.html">
       Part D: Additional problems
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../3/index.html">
     Assignment 3: Lists
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/partA_lists.html">
       Part A: Working with lists
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/partB_structural_generative_recursion.html">
       Part B: Structural and generative recursion
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/partC_more_lists.html">
       Part C: Some harder problems with lists
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../4/index.html">
     Assignment 4: Data abstraction
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../4/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../4/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../4/sections/partA_abstraction.html">
       Part A: Abstraction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../4/sections/partB_more_abstraction.html">
       Part B: More abstraction problems
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../4/sections/partC_algebra.html">
       Part C: Miniproject: Algebraic expressions
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../index.html">
     Midterm exam
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="partA_complexity.html">
       Part A: Asymptotic time complexity
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Part B: Recursion and higher-order functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="partC_data_structures.html">
       Part C: Data structures: AA trees
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../5/index.html">
     Assignment 5: Tags and objects
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../5/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../5/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../5/sections/partA_mutation.html">
       Part A: Mutation and imperative programming
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../5/sections/partB_tagged_data.html">
       Part B: Tagged Data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../5/sections/partC_objects.html">
       Part C: Objects
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../6/index.html">
     Assignment 6: Environmentally-friendly
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../6/sections/Preamble.html">
       Details
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../6/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../6/sections/partA_environment_model.html">
       Part A: The environment model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../6/sections/partB_imperative_objects.html">
       Part B: Imperative objects
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../6/sections/partC_modules_functors.html">
       Part C: Modules and functors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../6/sections/partD_special_topics.html">
       Part D: Special topics
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../7/index.html">
     Assignment 7: Final exam preparation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../7/sections/Preamble.html">
       Details
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../7/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../7/sections/miniproject_klotski.html">
       Miniproject: The “Klotski” sliding-block puzzle game
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../readings/index.html">
   Readings
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../readings/ocaml_cheat_sheet.html">
     OCaml syntax cheat sheet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../readings/subst.html">
     The substitution model
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merge-sort3">
   1.
   <code class="docutils literal notranslate">
    <span class="pre">
     merge_sort3
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-split3">
     a.
     <code class="docutils literal notranslate">
      <span class="pre">
       split3
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#examples">
       Examples
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-merge3">
     b.
     <code class="docutils literal notranslate">
      <span class="pre">
       merge3
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Examples
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-merge-sort3">
     c.
     <code class="docutils literal notranslate">
      <span class="pre">
       merge_sort3
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#block-sorting">
   2. Block sorting
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-smallest-index">
     a.
     <code class="docutils literal notranslate">
      <span class="pre">
       smallest_index
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Examples
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-flip-n">
     b.
     <code class="docutils literal notranslate">
      <span class="pre">
       flip_n
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Examples
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-block-sort1">
     c.
     <code class="docutils literal notranslate">
      <span class="pre">
       block_sort1
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Examples
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d-block-sort-r-and-block-sort-i">
     d.
     <code class="docutils literal notranslate">
      <span class="pre">
       block_sort_r
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       block_sort_i
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Examples
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linrec">
   3.
   <code class="docutils literal notranslate">
    <span class="pre">
     linrec
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-implementing-linrec">
     a. Implementing
     <code class="docutils literal notranslate">
      <span class="pre">
       linrec
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-insert-r">
     b.
     <code class="docutils literal notranslate">
      <span class="pre">
       insert_r
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-insertion-sort">
     c.
     <code class="docutils literal notranslate">
      <span class="pre">
       insertion_sort
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#binrec">
   4.
   <code class="docutils literal notranslate">
    <span class="pre">
     binrec
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-implementing-binrec">
     a. Implementing
     <code class="docutils literal notranslate">
      <span class="pre">
       binrec
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-quicksort">
     b.
     <code class="docutils literal notranslate">
      <span class="pre">
       quicksort
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tailrec">
   5.
   <code class="docutils literal notranslate">
    <span class="pre">
     tailrec
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-implementing-tailrec">
     a. Implementing
     <code class="docutils literal notranslate">
      <span class="pre">
       tailrec
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-insert-i">
     b.
     <code class="docutils literal notranslate">
      <span class="pre">
       insert_i
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-insertion-sort-i">
     c.
     <code class="docutils literal notranslate">
      <span class="pre">
       insertion_sort_i
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Part B: Recursion and higher-order functions</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merge-sort3">
   1.
   <code class="docutils literal notranslate">
    <span class="pre">
     merge_sort3
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-split3">
     a.
     <code class="docutils literal notranslate">
      <span class="pre">
       split3
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#examples">
       Examples
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-merge3">
     b.
     <code class="docutils literal notranslate">
      <span class="pre">
       merge3
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Examples
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-merge-sort3">
     c.
     <code class="docutils literal notranslate">
      <span class="pre">
       merge_sort3
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#block-sorting">
   2. Block sorting
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-smallest-index">
     a.
     <code class="docutils literal notranslate">
      <span class="pre">
       smallest_index
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Examples
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-flip-n">
     b.
     <code class="docutils literal notranslate">
      <span class="pre">
       flip_n
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Examples
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-block-sort1">
     c.
     <code class="docutils literal notranslate">
      <span class="pre">
       block_sort1
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Examples
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d-block-sort-r-and-block-sort-i">
     d.
     <code class="docutils literal notranslate">
      <span class="pre">
       block_sort_r
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       block_sort_i
      </span>
     </code>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Examples
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linrec">
   3.
   <code class="docutils literal notranslate">
    <span class="pre">
     linrec
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-implementing-linrec">
     a. Implementing
     <code class="docutils literal notranslate">
      <span class="pre">
       linrec
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-insert-r">
     b.
     <code class="docutils literal notranslate">
      <span class="pre">
       insert_r
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-insertion-sort">
     c.
     <code class="docutils literal notranslate">
      <span class="pre">
       insertion_sort
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#binrec">
   4.
   <code class="docutils literal notranslate">
    <span class="pre">
     binrec
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-implementing-binrec">
     a. Implementing
     <code class="docutils literal notranslate">
      <span class="pre">
       binrec
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-quicksort">
     b.
     <code class="docutils literal notranslate">
      <span class="pre">
       quicksort
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tailrec">
   5.
   <code class="docutils literal notranslate">
    <span class="pre">
     tailrec
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-implementing-tailrec">
     a. Implementing
     <code class="docutils literal notranslate">
      <span class="pre">
       tailrec
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-insert-i">
     b.
     <code class="docutils literal notranslate">
      <span class="pre">
       insert_i
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-insertion-sort-i">
     c.
     <code class="docutils literal notranslate">
      <span class="pre">
       insertion_sort_i
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="part-b-recursion-and-higher-order-functions">
<h1>Part B: Recursion and higher-order functions<a class="headerlink" href="#part-b-recursion-and-higher-order-functions" title="Permalink to this headline">#</a></h1>
<p>In this section you’ll be writing some functions that involve recursion
and higher-order functions. This section is worth 8 marks in all.</p>
<section id="merge-sort3">
<h2>1. <code class="docutils literal notranslate"><span class="pre">merge_sort3</span></code><a class="headerlink" href="#merge-sort3" title="Permalink to this headline">#</a></h2>
<p>[<strong>1.5 marks</strong>]</p>
<p>In this problem, we will implement a merge sorting function that will
split lists into three parts instead of two. We’ll call this function
<code class="docutils literal notranslate"><span class="pre">merge_sort3</span></code>.</p>
<p>We’ll begin by writing two helper functions: <code class="docutils literal notranslate"><span class="pre">split3</span></code> and <code class="docutils literal notranslate"><span class="pre">merge3</span></code>.</p>
<section id="a-split3">
<h3>a. <code class="docutils literal notranslate"><span class="pre">split3</span></code><a class="headerlink" href="#a-split3" title="Permalink to this headline">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">split3</span></code> takes an input list (which we will assume is a list of
integers) and distributes it among three lists of equal size (or at
least, as equal as is possible), which are returned. The original list
elements in position 0, 3, 6 <em>etc.</em> (where the head of the list is
considered to be position 0) must go into output list 1, while those in
position 1, 4, 7 <em>etc.</em> go in list 2 and those in 2, 5, 8 <em>etc.</em> into
list 3. <strong>No other kind of list splitting is allowed.</strong> Your function
should be able to split the lists in a single pass through the input
list, and it must have a time complexity of <span class="math notranslate nohighlight">\(O(n)\)</span>.</p>
<section id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">#</a></h4>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">split3</span> <span class="bp">[]</span><span class="o">;;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">*</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">*</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">(</span><span class="bp">[]</span><span class="o">,</span> <span class="bp">[]</span><span class="o">,</span> <span class="bp">[]</span><span class="o">)</span>

<span class="o">#</span> <span class="n">split3</span> <span class="o">[</span><span class="mi">1</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">*</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">*</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">([</span><span class="mi">1</span><span class="o">],</span> <span class="bp">[]</span><span class="o">,</span> <span class="bp">[]</span><span class="o">)</span>

<span class="o">#</span> <span class="n">split3</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">*</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">*</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">([</span><span class="mi">2</span><span class="o">],</span> <span class="o">[</span><span class="mi">1</span><span class="o">],</span> <span class="bp">[]</span><span class="o">)</span>

<span class="o">#</span> <span class="n">split3</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">3</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">*</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">*</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">([</span><span class="mi">2</span><span class="o">],</span> <span class="o">[</span><span class="mi">1</span><span class="o">],</span> <span class="o">[</span><span class="mi">3</span><span class="o">])</span>

<span class="o">#</span> <span class="n">split3</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">10</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">*</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">*</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">([</span><span class="mi">2</span><span class="o">;</span> <span class="mi">10</span><span class="o">],</span> <span class="o">[</span><span class="mi">1</span><span class="o">],</span> <span class="o">[</span><span class="mi">3</span><span class="o">])</span>

<span class="o">#</span> <span class="n">split3</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">10</span><span class="o">;</span><span class="mi">3</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">*</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">*</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">([</span><span class="mi">2</span><span class="o">;</span> <span class="mi">10</span><span class="o">],</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">3</span><span class="o">],</span> <span class="o">[</span><span class="mi">3</span><span class="o">])</span>

<span class="o">#</span> <span class="n">split3</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">10</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">*</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">*</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">([</span><span class="mi">2</span><span class="o">;</span> <span class="mi">10</span><span class="o">],</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">3</span><span class="o">],</span> <span class="o">[</span><span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">])</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You can define an iterative helper function whose arguments include
three lists that you add to as you pull values off the original list.
You should also have a counter argument that you increment
for each call of the helper function and use its value
to tell you which list to add to.</p>
<p>You may find the OCaml <code class="docutils literal notranslate"><span class="pre">mod</span></code> operator and the <code class="docutils literal notranslate"><span class="pre">List.rev</span></code> library
function to be useful.</p>
</div>
</section>
</section>
<section id="b-merge3">
<h3>b. <code class="docutils literal notranslate"><span class="pre">merge3</span></code><a class="headerlink" href="#b-merge3" title="Permalink to this headline">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">merge3</span></code> takes three input lists of integers, each of which is assumed
to be sorted. Their lengths are unimportant. It merges all three into a
single sorted list of integers. The time complexity should be linear in
the sum of the lengths of the three lists.</p>
<section id="id1">
<h4>Examples<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h4>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="c">(* Arguments to merge3 should be sorted lists. *)</span>
<span class="o">#</span> <span class="n">merge3</span> <span class="bp">[]</span> <span class="bp">[]</span> <span class="bp">[]</span><span class="o">;;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="bp">[]</span>

<span class="o">#</span> <span class="n">merge3</span> <span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="bp">[]</span> <span class="bp">[]</span><span class="o">;;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">]</span>

<span class="o">#</span> <span class="n">merge3</span> <span class="bp">[]</span> <span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="bp">[]</span><span class="o">;;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">2</span><span class="o">]</span>

<span class="o">#</span> <span class="n">merge3</span> <span class="bp">[]</span> <span class="bp">[]</span> <span class="o">[</span><span class="mi">3</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">3</span><span class="o">]</span>

<span class="o">#</span> <span class="n">merge3</span> <span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="bp">[]</span><span class="o">;;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">]</span>

<span class="o">#</span> <span class="n">merge3</span> <span class="bp">[]</span> <span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">[</span><span class="mi">3</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">]</span>

<span class="o">#</span> <span class="n">merge3</span> <span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="bp">[]</span> <span class="o">[</span><span class="mi">3</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">3</span><span class="o">]</span>

<span class="o">#</span> <span class="n">merge3</span> <span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">[</span><span class="mi">3</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">]</span>

<span class="o">#</span> <span class="n">merge3</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">4</span><span class="o">]</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">5</span><span class="o">]</span> <span class="o">[</span><span class="mi">3</span><span class="o">;</span><span class="mi">6</span><span class="o">;</span><span class="mi">7</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="mi">6</span><span class="o">;</span> <span class="mi">7</span><span class="o">]</span>

<span class="o">#</span> <span class="n">merge3</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">5</span><span class="o">]</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">4</span><span class="o">]</span> <span class="o">[</span><span class="mi">3</span><span class="o">;</span><span class="mi">6</span><span class="o">;</span><span class="mi">7</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="mi">6</span><span class="o">;</span> <span class="mi">7</span><span class="o">]</span>

<span class="o">#</span> <span class="n">merge3</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">5</span><span class="o">]</span> <span class="o">[</span><span class="mi">3</span><span class="o">;</span><span class="mi">6</span><span class="o">;</span><span class="mi">7</span><span class="o">]</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">4</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="mi">6</span><span class="o">;</span> <span class="mi">7</span><span class="o">]</span>

<span class="o">#</span> <span class="n">merge3</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">5</span><span class="o">]</span> <span class="o">[</span><span class="mi">3</span><span class="o">;</span><span class="mi">5</span><span class="o">;</span><span class="mi">7</span><span class="o">]</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">4</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="mi">7</span><span class="o">]</span>

<span class="o">#</span> <span class="n">merge3</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">4</span><span class="o">]</span> <span class="bp">[]</span> <span class="o">[</span><span class="mi">3</span><span class="o">;</span><span class="mi">5</span><span class="o">;</span><span class="mi">6</span><span class="o">;</span><span class="mi">7</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="mi">6</span><span class="o">;</span> <span class="mi">7</span><span class="o">]</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The easiest way to implement this function is to define a helper
function that merges two lists and then use this twice
(on the first two lists,
then on the result of the merge and the third list).</p>
<p>You may find the OCaml <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> (list append) operator
and the <code class="docutils literal notranslate"><span class="pre">List.rev</span></code> library function to be useful.</p>
</div>
</section>
</section>
<section id="c-merge-sort3">
<h3>c. <code class="docutils literal notranslate"><span class="pre">merge_sort3</span></code><a class="headerlink" href="#c-merge-sort3" title="Permalink to this headline">#</a></h3>
<p>Now use <code class="docutils literal notranslate"><span class="pre">split3</span></code> and <code class="docutils literal notranslate"><span class="pre">merge3</span></code> to write <code class="docutils literal notranslate"><span class="pre">merge_sort3</span></code>. This
function does not have to be tail recursive.</p>
</section>
</section>
<section id="block-sorting">
<h2>2. Block sorting<a class="headerlink" href="#block-sorting" title="Permalink to this headline">#</a></h2>
<p>[<strong>2.5 marks</strong>]</p>
<p>For this problem, we are going to implement a rather unusual sorting
algorithm which we’ll call “block sorting”. It is related to another
unusual sorting algorithm called “pancake sorting” which was once
studied by Bill Gates, among other people.  <a class="footnote-reference brackets" href="#id7" id="id2">1</a></p>
<p>The basic idea is this: what if, when you are sorting a list, the only
way you can rearrange the list is to flip an entire sublist of the list
including the beginning of the list? So if the list is
<code class="docutils literal notranslate"><span class="pre">[a;</span> <span class="pre">b;</span> <span class="pre">c;</span> <span class="pre">d;</span> <span class="pre">e]</span></code> for some values <code class="docutils literal notranslate"><span class="pre">a</span></code> to <code class="docutils literal notranslate"><span class="pre">e</span></code>, you can transform it
to <code class="docutils literal notranslate"><span class="pre">[b;</span> <span class="pre">a;</span> <span class="pre">c;</span> <span class="pre">d;</span> <span class="pre">e]</span></code> (flip first two items), <code class="docutils literal notranslate"><span class="pre">[c;</span> <span class="pre">b;</span> <span class="pre">a;</span> <span class="pre">d;</span> <span class="pre">e]</span></code> (flip
first three items), <code class="docutils literal notranslate"><span class="pre">[d;</span> <span class="pre">c;</span> <span class="pre">b;</span> <span class="pre">a;</span> <span class="pre">e]</span></code> (flip first four items), or
<code class="docutils literal notranslate"><span class="pre">[e;</span> <span class="pre">d;</span> <span class="pre">c;</span> <span class="pre">b;</span> <span class="pre">a]</span></code> (flip all items), and that’s all. How would you then
sort the list?</p>
<p>The algorithm is actually pretty simple:</p>
<ul class="simple">
<li><p>Find the smallest element in the list.</p></li>
<li><p>Flip the sublist up to and including that element. That puts the
smallest element at the head of the list.</p></li>
<li><p>Recursively sort the tail of the list and combine with the head to
get the final sorted list.</p></li>
</ul>
<p>This is a contrived algorithm, and it has no practical value (it won’t
be particularly efficient, for one thing) but implementing it is good
practice in writing recursive list-processing functions. So let’s go!</p>
<section id="a-smallest-index">
<h3>a. <code class="docutils literal notranslate"><span class="pre">smallest_index</span></code><a class="headerlink" href="#a-smallest-index" title="Permalink to this headline">#</a></h3>
<p>Write a function called <code class="docutils literal notranslate"><span class="pre">smallest_index</span></code> which will take one argument
(a list of integers) and return the <em>index</em> of the smallest element
(<em>not</em> the value!). The index is <code class="docutils literal notranslate"><span class="pre">0</span></code> for the first element, <code class="docutils literal notranslate"><span class="pre">1</span></code> for
the second element, and so on. Note that we don’t normally talk of
“indices” for lists (as opposed to arrays, where we do), but we will do
so here. If there is more than one copy of the smallest element, return
the index of the first occurrence of the element in the list.</p>
<p>Don’t use higher-order list processing functions in this problem; just
write a regular recursive list processing function. It can implement a
recursive or iterative process as you see fit. Most especially, you are
<strong>not</strong> allowed to call any sorting functions in this function (such as
the <code class="docutils literal notranslate"><span class="pre">List.sort</span></code> function in the OCaml standard libraries).</p>
<p>If the input list is empty, raise an <code class="docutils literal notranslate"><span class="pre">Invalid_argument</span></code> exception with
a meaningful error message. The easiest way to do this is to call the
function <code class="docutils literal notranslate"><span class="pre">invalid_arg</span></code> with the error message; it will raise the
exception for you.</p>
<section id="id3">
<h4>Examples<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h4>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">smallest_index</span> <span class="bp">[]</span><span class="o">;;</span>
<span class="nc">Exception</span><span class="o">:</span> <span class="nc">Invalid_argument</span> <span class="s2">&quot;smallest_index: not enough elements&quot;</span><span class="o">.</span>

<span class="o">#</span> <span class="n">smallest_index</span> <span class="o">[</span><span class="mi">1</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">0</span>

<span class="o">#</span> <span class="n">smallest_index</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">1</span>

<span class="o">#</span> <span class="n">smallest_index</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">3</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">1</span>

<span class="o">#</span> <span class="n">smallest_index</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">1</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">1</span>

<span class="o">#</span> <span class="n">smallest_index</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">5</span><span class="o">;</span><span class="mi">0</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">6</span>
</pre></div>
</div>
</section>
</section>
<section id="b-flip-n">
<h3>b. <code class="docutils literal notranslate"><span class="pre">flip_n</span></code><a class="headerlink" href="#b-flip-n" title="Permalink to this headline">#</a></h3>
<p>Write a function called <code class="docutils literal notranslate"><span class="pre">flip_n</span></code> which takes two arguments: a
non-negative argument <code class="docutils literal notranslate"><span class="pre">n</span></code> and a list of integers. (You may assume that
the argument <code class="docutils literal notranslate"><span class="pre">n</span></code> is non-negative; you don’t have to check for this.)
It should flip the order of the first <code class="docutils literal notranslate"><span class="pre">n</span></code> elements while leaving the
rest unchanged, returning a new list. Since this will be done
functionally, the input list will not (and cannot) be altered. If there
aren’t enough elements in the list to do the flipping, the function
should raise the <code class="docutils literal notranslate"><span class="pre">Invalid_argument</span></code> exception with a reasonable error
message.</p>
<section id="id4">
<h4>Examples<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h4>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">flip_n</span> <span class="mi">0</span> <span class="bp">[]</span><span class="o">;;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="bp">[]</span>

<span class="o">#</span> <span class="n">flip_n</span> <span class="mi">0</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">5</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">]</span>

<span class="o">#</span> <span class="n">flip_n</span> <span class="mi">1</span> <span class="bp">[]</span><span class="o">;;</span>
<span class="nc">Exception</span><span class="o">:</span> <span class="nc">Invalid_argument</span> <span class="s2">&quot;flip_n: not enough elements&quot;</span><span class="o">.</span>

<span class="o">#</span> <span class="n">flip_n</span> <span class="mi">1</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">5</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">]</span>

<span class="o">#</span> <span class="n">flip_n</span> <span class="mi">2</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">5</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span> <span class="mi">1</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">]</span>

<span class="o">#</span> <span class="n">flip_n</span> <span class="mi">3</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">5</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">3</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">1</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">]</span>

<span class="o">#</span> <span class="n">flip_n</span> <span class="mi">4</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">5</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">4</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">1</span><span class="o">;</span> <span class="mi">5</span><span class="o">]</span>

<span class="o">#</span> <span class="n">flip_n</span> <span class="mi">5</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">5</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">5</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">1</span><span class="o">]</span>

<span class="o">#</span> <span class="n">flip_n</span> <span class="mi">6</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">5</span><span class="o">];;</span>
<span class="nc">Exception</span><span class="o">:</span> <span class="nc">Invalid_argument</span> <span class="s2">&quot;flip_n: not enough elements&quot;</span><span class="o">.</span>
</pre></div>
</div>
</section>
</section>
<section id="c-block-sort1">
<h3>c. <code class="docutils literal notranslate"><span class="pre">block_sort1</span></code><a class="headerlink" href="#c-block-sort1" title="Permalink to this headline">#</a></h3>
<p>Use your functions <code class="docutils literal notranslate"><span class="pre">smallest_index</span></code> and <code class="docutils literal notranslate"><span class="pre">flip_n</span></code> to write a short
function called <code class="docutils literal notranslate"><span class="pre">block_sort1</span></code> which finds the smallest element in the
list and flips the part of the list starting from the head and going up
to and including that element. This is one iteration of the block
sorting algorithm. Again, this is a purely functional function, so the
input list is not altered; the new list is returned from the function.</p>
<section id="id5">
<h4>Examples<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h4>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">block_sort1</span> <span class="bp">[]</span><span class="o">;;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="bp">[]</span>

<span class="o">#</span> <span class="n">block_sort1</span> <span class="o">[</span><span class="mi">1</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">]</span>

<span class="o">#</span> <span class="n">block_sort1</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">1</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">1</span><span class="o">;</span> <span class="mi">1</span><span class="o">]</span>

<span class="o">#</span> <span class="n">block_sort1</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">]</span>

<span class="o">#</span> <span class="n">block_sort1</span> <span class="o">[</span><span class="mi">3</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">]</span>

<span class="o">#</span> <span class="n">block_sort1</span> <span class="o">[</span><span class="mi">5</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">5</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">]</span>

<span class="o">#</span> <span class="n">block_sort1</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">5</span><span class="o">;</span><span class="mi">5</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">1</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="mi">5</span><span class="o">];;</span>
</pre></div>
</div>
</section>
</section>
<section id="d-block-sort-r-and-block-sort-i">
<h3>d. <code class="docutils literal notranslate"><span class="pre">block_sort_r</span></code> and <code class="docutils literal notranslate"><span class="pre">block_sort_i</span></code><a class="headerlink" href="#d-block-sort-r-and-block-sort-i" title="Permalink to this headline">#</a></h3>
<p>Now that we have defined <code class="docutils literal notranslate"><span class="pre">block_sort1</span></code>,
define two block sorting functions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">block_sort_r</span></code>, which generates a recursive process</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">block_sort_i</span></code>, which generates an iterative process</p></li>
</ul>
<section id="id6">
<h4>Examples<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h4>
<p>These examples work for both functions. We’ll just illustrate the
answers using <code class="docutils literal notranslate"><span class="pre">block_sort_r</span></code>.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">block_sort_r</span> <span class="bp">[]</span><span class="o">;;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="bp">[]</span>

<span class="o">#</span> <span class="n">block_sort_r</span> <span class="o">[</span><span class="mi">1</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">]</span>

<span class="o">#</span> <span class="n">block_sort_r</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">1</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">1</span><span class="o">]</span>

<span class="o">#</span> <span class="n">block_sort_r</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">]</span>

<span class="o">#</span> <span class="n">block_sort_r</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">]</span>

<span class="o">#</span> <span class="n">block_sort_r</span> <span class="o">[</span><span class="mi">5</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">]</span>

<span class="o">#</span> <span class="n">block_sort_r</span> <span class="o">[</span><span class="mi">5</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">5</span><span class="o">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="mi">5</span><span class="o">]</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="linrec">
<h2>3. <code class="docutils literal notranslate"><span class="pre">linrec</span></code><a class="headerlink" href="#linrec" title="Permalink to this headline">#</a></h2>
<p>[<strong>1.5 marks</strong>]</p>
<p>We’ve seen in the assignments that it’s possible to abstract recursion
patterns into higher-order functions (for instance, the
<code class="docutils literal notranslate"><span class="pre">accumulate-rec</span></code> and <code class="docutils literal notranslate"><span class="pre">accumulate-iter</span></code> functions we defined in
assignment 2). However, we can actually go a lot further than we did in
assignment 2 with fairly little effort and get amazingly general
functions that express common recursion patterns. That’s what we’ll do
in this problem and the next. Then we’ll use these functions to
re-implement various recursive functions we’ve already seen.</p>
<p>Probably the most basic recursion pattern is the one that yields a
recursive process where there is only one recursive call in the
function. Lots and lots of functions can be defined this way, including
both functions on lists and functions on numbers. There is a very simple
“recipe” for defining these functions which goes like this:</p>
<ol class="arabic simple">
<li><p>Figure out what the base cases are.</p></li>
<li><p>For each base case, figure out what to return.</p></li>
<li><p>If the input is not a base case, figure out how to split it into the
part that we are going to recurse over, and anything else that we
need that we are not going to recurse over.</p></li>
<li><p>Do the recursion, then figure out how to combine the result of the
recursion with the part we didn’t recurse over to get our final
answer.</p></li>
</ol>
<p>The neat thing is that we can express all of these items as functions!
We will use these functions to define a higher-order function called
<code class="docutils literal notranslate"><span class="pre">linrec</span></code> (for “linear recursion”). It will take some arguments and
return a function which is a recursive function over a single argument
(which we’ll call “the input argument” below). The arguments to the
<code class="docutils literal notranslate"><span class="pre">linrec</span></code> function itself will be:</p>
<ul class="simple">
<li><p>A function called <code class="docutils literal notranslate"><span class="pre">is_base</span></code>, which will return <code class="docutils literal notranslate"><span class="pre">true</span></code> if the
input argument is one of the base cases of the recursive function we
are defining.</p></li>
<li><p>A function called <code class="docutils literal notranslate"><span class="pre">on_base</span></code>, which will take the input argument
(assumed to be one of the base cases) and returns the correct result
for that base case. Note that sometimes the input argument isn’t
needed to compute the result of a base case, but sometimes it is.</p></li>
<li><p>A function called <code class="docutils literal notranslate"><span class="pre">split</span></code>, which splits the input argument into the
part that is to be recursed over and the part that is not to be
recursed over. It returns a two-tuple, with the not-recursed-over
part coming first. <strong>NOTE</strong>: It doesn’t actually do any recursion!</p></li>
<li><p>A function called <code class="docutils literal notranslate"><span class="pre">combine</span></code>, which takes two arguments (the
not-recursed-over part returned from <code class="docutils literal notranslate"><span class="pre">split</span></code>, and the result of
recursing over the other part returned from <code class="docutils literal notranslate"><span class="pre">split</span></code>) and
combines them to get the final answer. Again, this function doesn’t
do any recursion; only the <code class="docutils literal notranslate"><span class="pre">linrec</span></code> function itself does.</p></li>
</ul>
<p>This is probably pretty confusing, so let’s give a simple example: our
old friend the factorial function. Described in the terms given above,
we have:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="c">(* Base case: n = 0 *)</span>
<span class="k">let</span> <span class="n">is_base</span> <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c">(* If it&#39;s a base case, return 1. *)</span>
<span class="k">let</span> <span class="n">on_base</span> <span class="o">_</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c">(* Otherwise, split n into (n, n-1).  Recurse over (n-1). *)</span>
<span class="k">let</span> <span class="n">split</span> <span class="n">n</span> <span class="o">=</span> <span class="o">(</span><span class="n">n</span><span class="o">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span>

<span class="c">(* After recursing on n-1 to get factorial(n-1), multiply</span>
<span class="c"> * that by n to get factorial(n). *)</span>
<span class="k">let</span> <span class="n">combine</span> <span class="n">a</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>   <span class="c">(* a --&gt; n; b --&gt; factorial(n - 1) *)</span>
</pre></div>
</div>
<p>So if we have <code class="docutils literal notranslate"><span class="pre">linrec</span></code>, we can define factorial like this:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">factorial</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">is_base</span> <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">on_base</span> <span class="o">_</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">split</span> <span class="n">n</span> <span class="o">=</span> <span class="o">(</span><span class="n">n</span><span class="o">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">combine</span> <span class="n">a</span> <span class="n">b</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="k">in</span>   <span class="c">(* or just: combine = ( * ) *)</span>
    <span class="n">linrec</span> <span class="n">is_base</span> <span class="n">on_base</span> <span class="n">split</span> <span class="n">combine</span>
</pre></div>
</div>
<p>and it will work!</p>
<p>Here is what you need to do for this problem.</p>
<section id="a-implementing-linrec">
<h3>a. Implementing <code class="docutils literal notranslate"><span class="pre">linrec</span></code><a class="headerlink" href="#a-implementing-linrec" title="Permalink to this headline">#</a></h3>
<p>Complete the following partial implementation of <code class="docutils literal notranslate"><span class="pre">linrec</span></code>
(removing the <code class="docutils literal notranslate"><span class="pre">(*</span> <span class="pre">TODO:</span> <span class="pre">...</span> <span class="pre">*)</span></code> comments, of course):</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">linrec</span> <span class="n">is_base</span> <span class="n">on_base</span> <span class="n">split</span> <span class="n">combine</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">f</span> <span class="n">x</span> <span class="o">=</span>
    <span class="k">if</span> <span class="n">is_base</span> <span class="n">x</span> <span class="k">then</span>
      <span class="n">on_base</span> <span class="n">x</span>
    <span class="k">else</span>
      <span class="c">(* TODO: split using the split function *)</span>
      <span class="c">(* TODO: recurse on the second item in the tuple returned by split, using f *)</span>
      <span class="c">(* TODO: combine the results using the combine function *)</span>
  <span class="k">in</span> <span class="n">f</span>  <span class="c">(* return the resulting recursive function *)</span>
</pre></div>
</div>
</section>
<section id="b-insert-r">
<h3>b. <code class="docutils literal notranslate"><span class="pre">insert_r</span></code><a class="headerlink" href="#b-insert-r" title="Permalink to this headline">#</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">linrec</span></code> to define a function called <code class="docutils literal notranslate"><span class="pre">insert_r</span></code> which takes two
arguments: an integer called <code class="docutils literal notranslate"><span class="pre">item</span></code> and a list of integers which is
assumed to be sorted in ascending order. <code class="docutils literal notranslate"><span class="pre">insert_r</span></code> will insert the
item into the list, giving a sorted output list (sorted in ascending
order). Here is a partial implementation of the code:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">insert_r</span> <span class="n">item</span> <span class="o">=</span>
  <span class="c">(* two base cases: the empty list</span>
<span class="c">   * and when the item &lt; the first element of the list *)</span>
  <span class="k">let</span> <span class="n">is_base</span> <span class="n">lst</span> <span class="o">=</span> <span class="n">lst</span> <span class="o">=</span> <span class="bp">[]</span> <span class="o">||</span> <span class="n">item</span> <span class="o">&lt;=</span> <span class="nn">List</span><span class="p">.</span><span class="n">hd</span> <span class="n">lst</span> <span class="k">in</span>

  <span class="c">(* for both base cases, put the item on the front of the list *)</span>
  <span class="k">let</span> <span class="n">on_base</span> <span class="n">lst</span> <span class="o">=</span> <span class="n">item</span> <span class="o">::</span> <span class="n">lst</span> <span class="k">in</span>

  <span class="c">(* split the list.  Hint: structural recursion. *)</span>
  <span class="k">let</span> <span class="n">split</span> <span class="n">lst</span> <span class="o">=</span> <span class="c">(* TODO *)</span> <span class="k">in</span>

  <span class="c">(* combine to get the final result *)</span>
  <span class="k">let</span> <span class="n">combine</span> <span class="n">first</span> <span class="n">rest_after_rec</span> <span class="o">=</span> <span class="c">(* TODO *)</span> <span class="k">in</span>

    <span class="n">linrec</span> <span class="n">is_base</span> <span class="n">on_base</span> <span class="n">split</span> <span class="n">combine</span>
</pre></div>
</div>
<p>Both the <code class="docutils literal notranslate"><span class="pre">split</span></code> and <code class="docutils literal notranslate"><span class="pre">combine</span></code> definitions are one-liners. You are
allowed to use the <code class="docutils literal notranslate"><span class="pre">List.hd</span></code> and <code class="docutils literal notranslate"><span class="pre">List.tl</span></code> functions to get the head
and tail of a list, respectively; here, it’s simpler than doing a
pattern match.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">insert_r</span></code> takes two arguments, of which only the last is a
list to be recursed over. That’s why our definition has the <code class="docutils literal notranslate"><span class="pre">item</span></code>
argument only; the <code class="docutils literal notranslate"><span class="pre">linrec</span></code> call returns a function that takes the
list argument.</p>
</section>
<section id="c-insertion-sort">
<h3>c. <code class="docutils literal notranslate"><span class="pre">insertion_sort</span></code><a class="headerlink" href="#c-insertion-sort" title="Permalink to this headline">#</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">linrec</span></code> along with <code class="docutils literal notranslate"><span class="pre">insert_r</span></code> to define a function called
<code class="docutils literal notranslate"><span class="pre">insertion_sort</span></code> which implements an insertion sort (with the output
list sorted in ascending order). Recall that an insertion sort of a
non-empty list recursively sorts the tail of the list and then inserts
the head into the sorted tail (here, using the <code class="docutils literal notranslate"><span class="pre">insert_r</span></code> function you
just defined).</p>
<p>Here is a partial implementation of the code, which you should complete.</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">insertion_sort</span> <span class="o">=</span>
  <span class="c">(* base case: the list is empty *)</span>
  <span class="k">let</span> <span class="n">is_base</span> <span class="n">lst</span> <span class="o">=</span> <span class="n">lst</span> <span class="o">=</span> <span class="bp">[]</span> <span class="k">in</span>

  <span class="c">(* if it&#39;s a base case, return the empty list *)</span>
  <span class="k">let</span> <span class="n">on_base</span> <span class="o">_</span> <span class="o">=</span> <span class="bp">[]</span> <span class="k">in</span>

  <span class="c">(* otherwise, split (hint: structural recursion again) *)</span>
  <span class="k">let</span> <span class="n">split</span> <span class="n">lst</span> <span class="o">=</span> <span class="c">(* TODO *)</span> <span class="k">in</span>

  <span class="c">(* then combine *)</span>
  <span class="k">let</span> <span class="n">combine</span> <span class="n">first</span> <span class="n">rest_after_rec</span> <span class="o">=</span> <span class="c">(* TODO *)</span> <span class="k">in</span>

    <span class="n">linrec</span> <span class="n">is_base</span> <span class="n">on_base</span> <span class="n">split</span> <span class="n">combine</span>
</pre></div>
</div>
<p>Again, both the <code class="docutils literal notranslate"><span class="pre">split</span></code> and <code class="docutils literal notranslate"><span class="pre">combine</span></code> definitions are one-liners.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The test script won’t directly test your <code class="docutils literal notranslate"><span class="pre">linrec</span></code> function, but it
will test the <code class="docutils literal notranslate"><span class="pre">insert_r</span></code> and <code class="docutils literal notranslate"><span class="pre">insertion_sort</span></code> functions.</p>
</div>
</section>
</section>
<section id="binrec">
<h2>4. <code class="docutils literal notranslate"><span class="pre">binrec</span></code><a class="headerlink" href="#binrec" title="Permalink to this headline">#</a></h2>
<p>[<strong>1 mark</strong>]</p>
<p>Even though <code class="docutils literal notranslate"><span class="pre">linrec</span></code> is amazing, it can’t do everything. Sometimes we
need to do more than one recursive function call inside a recursive
function. For instance, the naive <code class="docutils literal notranslate"><span class="pre">fib</span></code> (fibonacci) function had two
recursive calls. Sorting functions like <code class="docutils literal notranslate"><span class="pre">quicksort</span></code> and <code class="docutils literal notranslate"><span class="pre">mergesort</span></code>
have two recursive calls as well. Shouldn’t we be able to define a
two-recursive-call variant of <code class="docutils literal notranslate"><span class="pre">linrec</span></code>? We can, and it’s called
<code class="docutils literal notranslate"><span class="pre">binrec</span></code>! It takes arguments similar to those of <code class="docutils literal notranslate"><span class="pre">linrec</span></code>, and
returns a recursive function that does two recursions per call.
Specifically, the arguments to <code class="docutils literal notranslate"><span class="pre">binrec</span></code> are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">is_base</span></code>: same as <code class="docutils literal notranslate"><span class="pre">linrec</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">on_base</span></code>: same as <code class="docutils literal notranslate"><span class="pre">linrec</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">split</span></code>: similar to <code class="docutils literal notranslate"><span class="pre">linrec</span></code>, except that instead of splitting
the input argument into two parts, we split it into three parts and
return a three-tuple. The first element of the tuple is the part that
doesn’t get recursed over, while the other two elements do get
recursed over.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">combine</span></code>: similar to <code class="docutils literal notranslate"><span class="pre">linrec</span></code>, except that it combines three
values (the non-recursed-over value plus the result of recursing over
the other two values returned from <code class="docutils literal notranslate"><span class="pre">split</span></code>).</p></li>
</ul>
<p>Let’s see what our old friend the tree-recursive <code class="docutils literal notranslate"><span class="pre">fib</span></code> function looks
like when defined using <code class="docutils literal notranslate"><span class="pre">binrec</span></code>:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">fib</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">is_base</span> <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">on_base</span> <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">split</span> <span class="n">n</span> <span class="o">=</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">)</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">combine</span> <span class="o">_</span> <span class="n">n1</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="k">in</span>
    <span class="n">binrec</span> <span class="n">is_base</span> <span class="n">on_base</span> <span class="n">split</span> <span class="n">combine</span>
</pre></div>
</div>
<p>The base cases should be straightforward;
the base cases are <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&lt;</span> <span class="pre">2</span></code> and they are just returned as is.
The <code class="docutils literal notranslate"><span class="pre">split</span></code> function generates the values to be recursed over
(<code class="docutils literal notranslate"><span class="pre">n-1</span></code> and <code class="docutils literal notranslate"><span class="pre">n-2</span></code>);
there is no need for a non-recursed-over value here,
but we return <code class="docutils literal notranslate"><span class="pre">0</span></code> because <code class="docutils literal notranslate"><span class="pre">split</span></code> has to return something there.
Finally, <code class="docutils literal notranslate"><span class="pre">combine</span></code> just adds the results of the recursion together;
the non-recursed-over value is ignored.</p>
<p>Here is what you need to do for this problem:</p>
<section id="a-implementing-binrec">
<h3>a. Implementing <code class="docutils literal notranslate"><span class="pre">binrec</span></code><a class="headerlink" href="#a-implementing-binrec" title="Permalink to this headline">#</a></h3>
<p>Complete the following partial definition of <code class="docutils literal notranslate"><span class="pre">binrec</span></code>:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">binrec</span> <span class="n">is_base</span> <span class="n">on_base</span> <span class="n">split</span> <span class="n">combine</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">f</span> <span class="n">x</span> <span class="o">=</span>
    <span class="k">if</span> <span class="n">is_base</span> <span class="n">x</span> <span class="k">then</span>
      <span class="n">on_base</span> <span class="n">x</span>
    <span class="k">else</span>
      <span class="c">(* TODO: split using the split function *)</span>
      <span class="c">(* TODO: recurse on the second and third items in the tuple</span>
<span class="c">         returned by split, using f *)</span>
      <span class="c">(* TODO: combine the results using the combine function *)</span>
  <span class="k">in</span> <span class="n">f</span>  <span class="c">(* return the resulting recursive function *)</span>
</pre></div>
</div>
</section>
<section id="b-quicksort">
<h3>b. <code class="docutils literal notranslate"><span class="pre">quicksort</span></code><a class="headerlink" href="#b-quicksort" title="Permalink to this headline">#</a></h3>
<p>In assignment 3, we implemented the <code class="docutils literal notranslate"><span class="pre">quicksort</span></code> sorting algorithm.
Recall how this algorithm works:</p>
<ul class="simple">
<li><p>If the list is empty, return the empty list.</p></li>
<li><p>Otherwise, the first element in the list is called the <em>pivot</em>. Use
it to create a list of all the elements in the original list which
are smaller than the pivot (using the <code class="docutils literal notranslate"><span class="pre">List.filter</span></code> function), and
another list of elements in the original list which are equal to or
larger than the pivot (not including the pivot itself). Then
recursively quicksort those two lists and assemble the complete list
using the OCaml list append operator (<code class="docutils literal notranslate"><span class="pre">&#64;</span></code>).</p></li>
</ul>
<p>Again, we will assume that we are sorting the list in ascending order.
Write a version of this function using <code class="docutils literal notranslate"><span class="pre">binrec</span></code>. Here is a partial
implementation:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">quicksort</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">is_base</span> <span class="n">lst</span> <span class="o">=</span> <span class="n">lst</span> <span class="o">=</span> <span class="bp">[]</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">on_base</span> <span class="o">_</span> <span class="o">=</span> <span class="bp">[]</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">split</span> <span class="n">lst</span> <span class="o">=</span>
    <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span>
      <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="n">invalid_arg</span> <span class="s2">&quot;quicksort: can&#39;t split&quot;</span>
      <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="c">(* TODO *)</span>
  <span class="k">in</span>
  <span class="k">let</span> <span class="n">combine</span> <span class="n">pivot</span> <span class="n">lt</span> <span class="n">ge</span> <span class="o">=</span> <span class="c">(* TODO *)</span> <span class="k">in</span>
    <span class="n">binrec</span> <span class="n">is_base</span> <span class="n">on_base</span> <span class="n">split</span> <span class="n">combine</span>
</pre></div>
</div>
</section>
</section>
<section id="tailrec">
<h2>5. <code class="docutils literal notranslate"><span class="pre">tailrec</span></code><a class="headerlink" href="#tailrec" title="Permalink to this headline">#</a></h2>
<p>[<strong>1.5 marks</strong>]</p>
<p>The last function we’ll write in this section is a function which
encapsulates the recursion pattern seen in tail-recursive functions
which implement iterative processes. We’ll call this function
<code class="docutils literal notranslate"><span class="pre">tailrec</span></code>. Surprisingly, it’s actually much simpler than either
<code class="docutils literal notranslate"><span class="pre">linrec</span></code> or <code class="docutils literal notranslate"><span class="pre">binrec</span></code>. Like <code class="docutils literal notranslate"><span class="pre">linrec</span></code> and <code class="docutils literal notranslate"><span class="pre">binrec</span></code>, when given the
appropriate arguments it returns a recursive function. Unlike <code class="docutils literal notranslate"><span class="pre">linrec</span></code>
or <code class="docutils literal notranslate"><span class="pre">binrec</span></code>, its arguments are all functions that take a single tuple
as their only argument; this tuple contains all the actual input
arguments to the tail-recursive function.</p>
<p>Here are the arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">next</span></code>: This is a function which takes a tuple of input arguments
to the tail-recursive function and generates the next tuple to be
passed to the function. Note that this means that the inputs to the
tail-recursive function are represented as a single tuple instead of
as several separate arguments.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_base</span></code>: This is the same as <code class="docutils literal notranslate"><span class="pre">is_base</span></code> in <code class="docutils literal notranslate"><span class="pre">linrec</span></code>, except
that it receives the entire tuple of input arguments as its argument.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">on_base</span></code>: This is the same as <code class="docutils literal notranslate"><span class="pre">on_base</span></code> in <code class="docutils literal notranslate"><span class="pre">linrec</span></code>, except
that it receives the entire tuple of input arguments as its argument.</p></li>
</ul>
<p>Here is an example of its use: to define a tail-recursive factorial
function called <code class="docutils literal notranslate"><span class="pre">fact_iter</span></code>:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">fact_iter</span> <span class="n">n</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">is_base</span> <span class="o">(</span><span class="n">n</span><span class="o">,</span> <span class="o">_)</span> <span class="o">=</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">on_base</span> <span class="o">(_,</span> <span class="n">r</span><span class="o">)</span> <span class="o">=</span> <span class="n">r</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">next</span> <span class="o">(</span><span class="n">n</span><span class="o">,</span> <span class="n">r</span><span class="o">)</span> <span class="o">=</span> <span class="o">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="n">r</span> <span class="o">*</span> <span class="n">n</span><span class="o">)</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">iter</span> <span class="o">=</span> <span class="n">tailrec</span> <span class="n">is_base</span> <span class="n">on_base</span> <span class="n">next</span> <span class="k">in</span>
    <span class="n">iter</span> <span class="o">(</span><span class="n">n</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>
</pre></div>
</div>
<p>Note the key difference between this definition and what we’ve seen with
<code class="docutils literal notranslate"><span class="pre">linrec</span></code> and <code class="docutils literal notranslate"><span class="pre">binrec</span></code>: here, <code class="docutils literal notranslate"><span class="pre">tailrec</span></code> is used not to define the
<code class="docutils literal notranslate"><span class="pre">fact_iter</span></code> function itself but to define a tail-recursive helper
function called <code class="docutils literal notranslate"><span class="pre">iter</span></code>, which is then used to implement the
<code class="docutils literal notranslate"><span class="pre">fact_iter</span></code> function.</p>
<p>All the functions <code class="docutils literal notranslate"><span class="pre">is_base</span></code>, <code class="docutils literal notranslate"><span class="pre">on_base</span></code>, and <code class="docutils literal notranslate"><span class="pre">next</span></code> take as their
only argument a two-tuple of integers, representing the number being
processed <code class="docutils literal notranslate"><span class="pre">n</span></code> and the running product <code class="docutils literal notranslate"><span class="pre">r</span></code>. The <code class="docutils literal notranslate"><span class="pre">is_base</span></code> function
states that the only base case is when <code class="docutils literal notranslate"><span class="pre">n</span></code> is zero. If that is the
base case, then <code class="docutils literal notranslate"><span class="pre">on_base</span></code> specifies that the tail-recursive function
should just return the result <code class="docutils literal notranslate"><span class="pre">r</span></code>. The <code class="docutils literal notranslate"><span class="pre">next</span></code> function turns the
current <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">r)</span></code> pair into <code class="docutils literal notranslate"><span class="pre">(n-1,</span> <span class="pre">r*n)</span></code> for the next iteration. If
<code class="docutils literal notranslate"><span class="pre">next</span></code> is repeated until <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">0</span></code>, then <code class="docutils literal notranslate"><span class="pre">r</span></code> will be
<code class="docutils literal notranslate"><span class="pre">factorial(n)</span></code>.</p>
<p>Here is what you need to do for this problem.</p>
<section id="a-implementing-tailrec">
<h3>a. Implementing <code class="docutils literal notranslate"><span class="pre">tailrec</span></code><a class="headerlink" href="#a-implementing-tailrec" title="Permalink to this headline">#</a></h3>
<p>Complete the following partial definition of <code class="docutils literal notranslate"><span class="pre">tailrec</span></code>:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">tailrec</span> <span class="n">is_base</span> <span class="n">on_base</span> <span class="n">next</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">f</span> <span class="n">inputs</span> <span class="o">=</span>
    <span class="c">(* TODO *)</span>
  <span class="k">in</span> <span class="n">f</span>  <span class="c">(* return the tail-recursive function *)</span>
</pre></div>
</div>
</section>
<section id="b-insert-i">
<h3>b. <code class="docutils literal notranslate"><span class="pre">insert_i</span></code><a class="headerlink" href="#b-insert-i" title="Permalink to this headline">#</a></h3>
<p>Write a tail-recursive variant (using <code class="docutils literal notranslate"><span class="pre">tailrec</span></code>) of the <code class="docutils literal notranslate"><span class="pre">insert_r</span></code>
function you defined above; call it <code class="docutils literal notranslate"><span class="pre">insert_i</span></code>. Here is a partial
implementation:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">insert_i</span> <span class="n">item</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">is_base</span> <span class="o">(_,</span> <span class="n">rest</span><span class="o">)</span> <span class="o">=</span> <span class="n">rest</span> <span class="o">=</span> <span class="bp">[]</span> <span class="o">||</span> <span class="n">item</span> <span class="o">&lt;=</span> <span class="nn">List</span><span class="p">.</span><span class="n">hd</span> <span class="n">rest</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">on_base</span> <span class="o">(</span><span class="n">prev</span><span class="o">,</span> <span class="n">rest</span><span class="o">)</span> <span class="o">=</span> <span class="c">(* TODO *)</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">next</span> <span class="o">(</span><span class="n">prev</span><span class="o">,</span> <span class="n">rest</span><span class="o">)</span> <span class="o">=</span> <span class="c">(* TODO *)</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">iter</span> <span class="o">=</span> <span class="n">tailrec</span> <span class="n">is_base</span> <span class="n">on_base</span> <span class="n">next</span> <span class="k">in</span>
    <span class="n">iter</span> <span class="o">(</span><span class="bp">[]</span><span class="o">,</span> <span class="n">lst</span><span class="o">)</span>
</pre></div>
</div>
</section>
<section id="c-insertion-sort-i">
<h3>c. <code class="docutils literal notranslate"><span class="pre">insertion_sort_i</span></code><a class="headerlink" href="#c-insertion-sort-i" title="Permalink to this headline">#</a></h3>
<p>Write a tail-recursive variant (using <code class="docutils literal notranslate"><span class="pre">tailrec</span></code>) of the
<code class="docutils literal notranslate"><span class="pre">insertion_sort</span></code> function you defined above; call it
<code class="docutils literal notranslate"><span class="pre">insertion_sort_i</span></code>. Here is a partial implementation:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">insertion_sort_i</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">is_base</span> <span class="o">(_,</span> <span class="n">rest</span><span class="o">)</span> <span class="o">=</span> <span class="n">rest</span> <span class="o">=</span> <span class="bp">[]</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">on_base</span> <span class="o">(</span><span class="n">prev</span><span class="o">,</span> <span class="o">_)</span> <span class="o">=</span> <span class="c">(* TODO *)</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">next</span> <span class="o">(</span><span class="n">prev</span><span class="o">,</span> <span class="n">rest</span><span class="o">)</span> <span class="o">=</span> <span class="c">(* TODO *)</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">iter</span> <span class="o">=</span> <span class="n">tailrec</span> <span class="n">is_base</span> <span class="n">on_base</span> <span class="n">next</span> <span class="k">in</span>
    <span class="n">iter</span> <span class="o">(</span><span class="bp">[]</span><span class="o">,</span> <span class="n">lst</span><span class="o">)</span>
</pre></div>
</div>
<p>You can use <code class="docutils literal notranslate"><span class="pre">List.hd</span></code>, <code class="docutils literal notranslate"><span class="pre">List.tl</span></code>, and <code class="docutils literal notranslate"><span class="pre">List.rev</span></code> in your solution
as needed.</p>
<hr class="docutils" />
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id2">1</a></span></dt>
<dd><p>Bill Gates used to be the CEO of a software company. Apparently that
company is still around.</p>
</dd>
</dl>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="partA_complexity.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Part A: Asymptotic time complexity</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="partC_data_structures.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Part C: Data structures: AA trees</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Michael Vanier<br/>
  
      &copy; Copyright 2023, Michael C. Vanier. All rights reserved.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>