
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>OCaml notes &#8212; The CS 4 book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/design-tabs.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Part A: Orders of growth" href="partA_orders_of_growth.html" />
    <link rel="prev" title="Preamble" href="Preamble.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">The CS 4 book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../admin/index.html">
   Administrative information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../admin/Syllabus.html">
     Syllabus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../admin/Collaboration_policies.html">
     Collaboration policies
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Motivation.html">
   Motivation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../History.html">
   History
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../index.html">
   Assignments
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../../0/Assignment0.html">
     Assignment 0: Getting set up
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../1/index.html">
     Assignment 1: Evaluation and recursion
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/partA_exercises.html">
       Part A: Basic exercises
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/partB_evaluation.html">
       Part B: Evaluation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/partC_recursion.html">
       Part C: Recursion
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../index.html">
     Assignment 2: Asymptotic complexity and higher-order functions
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="partA_orders_of_growth.html">
       Part A: Orders of growth
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="partB_evaluation.html">
       Part B: Evaluation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="partC_higher_order_functions.html">
       Part C. Higher-order functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="partD_additional_problems.html">
       Part D: Additional problems
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../3/index.html">
     Assignment 3: Lists
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/partA_lists.html">
       Part A: Working with lists
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/partB_structural_generative_recursion.html">
       Part B: Structural and generative recursion
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/partC_more_lists.html">
       Part C: Some harder problems with lists
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../readings/index.html">
   Readings
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../readings/ocaml_cheat_sheet.html">
     OCaml syntax cheat sheet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../readings/subst.html">
     The substitution model
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#packages-needed">
   Packages needed
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#testing">
   Testing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compiler-warnings">
     Compiler warnings
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-libraries-in-ocaml">
   Using libraries in OCaml
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#in-the-utop-interactive-interpreter">
   In the
   <code class="docutils literal notranslate">
    <span class="pre">
     utop
    </span>
   </code>
   interactive interpreter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#in-compiled-code">
   In compiled code
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-the-num-library">
   Using the
   <code class="docutils literal notranslate">
    <span class="pre">
     Num
    </span>
   </code>
   library
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>OCaml notes</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#packages-needed">
   Packages needed
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#testing">
   Testing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compiler-warnings">
     Compiler warnings
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-libraries-in-ocaml">
   Using libraries in OCaml
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#in-the-utop-interactive-interpreter">
   In the
   <code class="docutils literal notranslate">
    <span class="pre">
     utop
    </span>
   </code>
   interactive interpreter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#in-compiled-code">
   In compiled code
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-the-num-library">
   Using the
   <code class="docutils literal notranslate">
    <span class="pre">
     Num
    </span>
   </code>
   library
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="ocaml-notes">
<h1>OCaml notes<a class="headerlink" href="#ocaml-notes" title="Permalink to this headline">#</a></h1>
<section id="packages-needed">
<h2>Packages needed<a class="headerlink" href="#packages-needed" title="Permalink to this headline">#</a></h2>
<p>For this assignment, you’ll need to have the following <code class="docutils literal notranslate"><span class="pre">opam</span></code> packages
installed:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ocamlfind</span></code> (various compilation utilities)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ounit2</span></code> (unit testing)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num</span></code> (arbitrary-precision integer/rational number arithmetic)</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">ocamlfind</span></code> should already be installed if you followed the
instructions in assignment 0.
Install the other packages using <code class="docutils literal notranslate"><span class="pre">opam</span></code> as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ opam update
$ opam install ounit2 num
</pre></div>
</div>
<p>As you can see, you can install multiple packages using one <code class="docutils literal notranslate"><span class="pre">opam</span></code> command.
Type this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ opam list
</pre></div>
</div>
<p>after installation and verify that the
<code class="docutils literal notranslate"><span class="pre">ocamlfind</span></code>, <code class="docutils literal notranslate"><span class="pre">ounit2</span></code>, and <code class="docutils literal notranslate"><span class="pre">num</span></code> packages are installed.
If not, consult with a TA or the instructor.</p>
</section>
<section id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In what follows, we’re assuming that you are editing and running
your code in a Unix-like environment
(MacOS X, Linux, or Windows with WSL).
If you aren’t (<em>e.g.</em> if you are running Windows and are using
Powershell instead of the WSL <code class="docutils literal notranslate"><span class="pre">bash</span></code> shell),
things will not work correctly.</p>
<p>Note that you can easily run WSL shells from inside Visual Studio Code,
and this is recommended if you’re using Windows.</p>
<p>See a TA if you are having problems getting set up.
(Also review assignment 0, which contains detailed instructions
on how to get set up.)</p>
</div>
<p>For this assignment, we are supplying you with these support files:</p>
<ol class="arabic simple">
<li><p>An OCaml interface file: <code class="docutils literal notranslate"><span class="pre">lab2.mli</span></code></p></li>
<li><p>a test script: <code class="docutils literal notranslate"><span class="pre">tests_lab2.ml</span></code></p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> to automate compilation.</p></li>
</ol>
<p>These files are all available on the course Canvas site
in a single zip file called <code class="docutils literal notranslate"><span class="pre">lab2.zip</span></code>.  Download this file and
unzip it:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ unzip lab2.zip
</pre></div>
</div>
<p>This will create a <code class="docutils literal notranslate"><span class="pre">lab2</span></code> directory with the files inside it.
You should not change these files, and you should not submit them as part of
your assignment submission.  You should create and edit the file
<code class="docutils literal notranslate"><span class="pre">lab2.ml</span></code> (which you will be handing in) in the same directory.</p>
<p>In order to run the test script, you will need to use the <code class="docutils literal notranslate"><span class="pre">ounit2</span></code>
unit testing libraries, which you should have installed (see above).
<code class="docutils literal notranslate"><span class="pre">ounit2</span></code> is a set of libraries which make it easy to write unit tests
for OCaml code (sort of like <code class="docutils literal notranslate"><span class="pre">pytest</span></code> for Python).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The term <em>library</em> is vague.  The technical terms are
<em>package</em> (used mainly by <code class="docutils literal notranslate"><span class="pre">opam</span></code>) and <em>module</em>
(used by OCaml itself).  We’ll often use the word “library”
informally to refer to the set of modules in a package.</p>
</div>
<p>Once your assignment is done, you should compile it and check that it
conforms to the interface file by entering this command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ make
</pre></div>
</div>
<p>Of course, you can also compile your code from inside the <code class="docutils literal notranslate"><span class="pre">utop</span></code> OCaml
interpreter using the <code class="docutils literal notranslate"><span class="pre">#use</span></code> directive. Using <code class="docutils literal notranslate"><span class="pre">#use</span></code> is recommended
while developing code to check that the code has no type errors.
Using the <code class="docutils literal notranslate"><span class="pre">make</span></code> command is useful when the code is finished to make
sure that all your functions, types <em>etc.</em> have the correct type
signatures (which they should, if you have been following the
directions). Note that it’s possible to write a function that type
checks but doesn’t have the type we want it to have; that’s why using
<code class="docutils literal notranslate"><span class="pre">make</span></code> is important. The type signatures we expect are in the
<code class="docutils literal notranslate"><span class="pre">lab2.mli</span></code> interface file.</p>
<p>Finally, to run the test script, type this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ make test
</pre></div>
</div>
<p>This will compile the <code class="docutils literal notranslate"><span class="pre">tests_lab2.ml</span></code> file (which contains the unit
tests) and output an executable program called <code class="docutils literal notranslate"><span class="pre">tests_lab2</span></code>. Then it
will run that program and report all test failures. If the test program
doesn’t compile, you probably haven’t installed the <code class="docutils literal notranslate"><span class="pre">ounit2</span></code> library;
see above. If you did and it still doesn’t work, ask a TA or the
instructor for help.</p>
<p>If you want to compile the code and immediately run the test script
(useful during development/debugging), type:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ make all
</pre></div>
</div>
<p>Running the tests generates some log files; to get rid of them (as well
as all compiled OCaml files), type:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ make clean
</pre></div>
</div>
<p>It’s worthwhile taking a look at the code in the <code class="docutils literal notranslate"><span class="pre">tests_lab2.ml</span></code> file,
even though you don’t have to change it. Most of the tests are very
straightforward; they use a function called <code class="docutils literal notranslate"><span class="pre">assert_equal</span></code> to test
that a particular function call gives a particular result. There are
some interesting operators in the file (such as <code class="docutils literal notranslate"><span class="pre">&gt;:::</span></code> and <code class="docutils literal notranslate"><span class="pre">&gt;::</span></code>)
which are defined in the <code class="docutils literal notranslate"><span class="pre">ounit2</span></code> libraries; one of the cool things
about OCaml is that you can define new operators!</p>
<p>Finally, be aware that the test scripts are in no way exhaustive! Some
functions are just inherently hard to test, or else hard to test in a
way that wouldn’t give away the answer to a student who looked at the
test script code. We recommend that you experiment with the code on your
own as well (using the <code class="docutils literal notranslate"><span class="pre">utop</span></code> interactive interpreter)
in addition to running the test script.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Don’t assume that just because your code passes all the tests
that everything is perfect!
It’s necessary but not sufficient, as the math folks like to say.</p>
</div>
<section id="compiler-warnings">
<h3>Compiler warnings<a class="headerlink" href="#compiler-warnings" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> commands to compile OCaml code turn on most of
the OCaml compiler warning options,
even ones that are normally turned off.
Therefore, you might see some warnings when compiling your code
that you don’t see when loading it into the interpreter.
Compiling your code shouldn’t give rise to any warnings,
so if there are any, fix them.
If you don’t understand what a compiler warning means, ask us!</p>
<p>A list of compiler warnings is on <a class="reference external" href="https://v2.ocaml.org/manual/toplevel.html">this page</a>;
scroll down to find it (under the <code class="docutils literal notranslate"><span class="pre">-w</span></code> command-line option).</p>
</section>
</section>
<section id="using-libraries-in-ocaml">
<h2>Using libraries in OCaml<a class="headerlink" href="#using-libraries-in-ocaml" title="Permalink to this headline">#</a></h2>
<p>Some of the problems below require the use of arbitrary-precision
integers and rational numbers. The easiest way to get this in OCaml is
by using the <code class="docutils literal notranslate"><span class="pre">Num</span></code> library. <a class="footnote-reference brackets" href="#id3" id="id1">1</a> Here we will show you how to use
OCaml libraries in two different ways: in the <code class="docutils literal notranslate"><span class="pre">utop</span></code> interactive interpreter
(useful for debugging and testing code) and while compiling code. We’ll
use the <code class="docutils literal notranslate"><span class="pre">Num</span></code> library as an example, but the information will apply to
any OCaml library.</p>
</section>
<section id="in-the-utop-interactive-interpreter">
<h2>In the <code class="docutils literal notranslate"><span class="pre">utop</span></code> interactive interpreter<a class="headerlink" href="#in-the-utop-interactive-interpreter" title="Permalink to this headline">#</a></h2>
<p>The most basic way to use an OCaml library inside <code class="docutils literal notranslate"><span class="pre">utop</span></code>
is to use the <code class="docutils literal notranslate"><span class="pre">#load</span></code> command. This requires that you know
the full name of the compiled library file. This means that you have to
enter the following commands before using the <code class="docutils literal notranslate"><span class="pre">Num</span></code> library
interactively:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># #load &quot;nums.cma&quot;;;
# open Num;;
</pre></div>
</div>
<p>(In all the interactive OCaml examples, the first <code class="docutils literal notranslate"><span class="pre">#</span></code> is the
interactive prompt that you shouldn’t type.)</p>
<p>Here, we have to know that the library file is called <code class="docutils literal notranslate"><span class="pre">&quot;nums.cma&quot;</span></code>,
which is a bit annoying. The line <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">open</span> <span class="pre">Num;;</span></code> brings all the
contents of the <code class="docutils literal notranslate"><span class="pre">Num</span></code> library into the top-level namespace, so you
don’t have to use the <code class="docutils literal notranslate"><span class="pre">Num</span></code> prefix when using any of the functions in
the <code class="docutils literal notranslate"><span class="pre">Num</span></code> library. (This is like entering <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">Num</span> <span class="pre">import</span> <span class="pre">*</span></code> in
Python.)</p>
<p>If the library file is in a non-standard location, it’s even worse; you
have to add this line before the <code class="docutils literal notranslate"><span class="pre">#load</span></code> line:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>#directory /path/to/the/library/directory
</pre></div>
</div>
<p>(where you should substitute the real path for
<code class="docutils literal notranslate"><span class="pre">/path/to/the/library/directory</span></code>) or else (better) start <code class="docutils literal notranslate"><span class="pre">utop</span></code>
with the <code class="docutils literal notranslate"><span class="pre">-I</span></code> argument:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ utop -I /path/to/the/library/directory
</pre></div>
</div>
<p>Either way, it’s a nuisance.</p>
<p>Fortunately, the <code class="docutils literal notranslate"><span class="pre">utop</span></code> interactive interpreter
supports a much simpler way of loading libraries.
(Internally, it uses the <code class="docutils literal notranslate"><span class="pre">ocamlfind</span></code> library to do this,
but you don’t need to know exactly how this works.)
All you need to do is type the following commands inside <code class="docutils literal notranslate"><span class="pre">utop</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># #require &quot;num&quot;;;
# open Num;;
</pre></div>
</div>
<p>Now you can use all the functions in the <code class="docutils literal notranslate"><span class="pre">Num</span></code> module
without having to qualify them with the <code class="docutils literal notranslate"><span class="pre">Num.</span></code> prefix.</p>
<p>We’d like to reiterate here that all the <code class="docutils literal notranslate"><span class="pre">#</span></code>-commands
like <code class="docutils literal notranslate"><span class="pre">#use</span></code>, <code class="docutils literal notranslate"><span class="pre">#require</span></code> <em>etc.</em> are <em>not</em> part of the OCaml language
but are specific to the interactive interpreter.
Please do not use these commands
in compiled OCaml code (<em>i.e.</em> <code class="docutils literal notranslate"><span class="pre">.ml</span></code> and <code class="docutils literal notranslate"><span class="pre">.mli</span></code> files)!</p>
<p>For the rest of this course we will almost always use <code class="docutils literal notranslate"><span class="pre">#require</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">#load</span></code> to load libraries into <code class="docutils literal notranslate"><span class="pre">utop</span></code>.</p>
</section>
<section id="in-compiled-code">
<h2>In compiled code<a class="headerlink" href="#in-compiled-code" title="Permalink to this headline">#</a></h2>
<p>If you want to compile an executable program that uses the <code class="docutils literal notranslate"><span class="pre">Num</span></code> library,
there are three ways to do it:
the hard way, the easy way, and the automatic way.</p>
<p>The hard way is to specify the library information explicitly when you compile
your code. For instance, if you have a file <code class="docutils literal notranslate"><span class="pre">&quot;myprog.ml&quot;</span></code> that uses the
<code class="docutils literal notranslate"><span class="pre">Num</span></code> library, you can compile it like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ ocamlc nums.cma myprog.mli myprog.ml -o myprog
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">ocamlc</span></code> is the name of the OCaml compiler program. <a class="footnote-reference brackets" href="#id4" id="id2">2</a></p>
<p>Note again that you have to specify the library name in full. If the
directory where <code class="docutils literal notranslate"><span class="pre">nums.cma</span></code> is located is not a standard location
(which it probably isn’t), you would additionally have to specify the
directory with the <code class="docutils literal notranslate"><span class="pre">-I</span></code> option, <em>e.g.</em>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ ocamlc -I /path/to/the/library/directory nums.cma myprog.mli myprog.ml -o myprog
</pre></div>
</div>
<p>Clearly, this is a pain, and the easy way to do
this involves using the <code class="docutils literal notranslate"><span class="pre">ocamlfind</span></code> package.
In this case we will use the <code class="docutils literal notranslate"><span class="pre">ocamlfind</span></code> program
(which is part of the <code class="docutils literal notranslate"><span class="pre">ocamlfind</span></code> package;
don’t confuse the two distinct uses of <code class="docutils literal notranslate"><span class="pre">ocamlfind</span></code>):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ ocamlfind ocamlc -package num myprog.mli myprog.ml -o myprog -linkpkg
</pre></div>
</div>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">ocamlfind</span></code> for compiling non-executables (<em>e.g.</em>
object code files or libraries); in that case you leave off the
<code class="docutils literal notranslate"><span class="pre">-linkpkg</span></code> argument and adjust the <code class="docutils literal notranslate"><span class="pre">ocamlc</span></code> arguments as necessary.
For instance, if we were compiling a library <code class="docutils literal notranslate"><span class="pre">mylib.ml</span></code> that used the
<code class="docutils literal notranslate"><span class="pre">Num</span></code> library we would compile it like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ ocamlfind ocamlc -c  -package num mylib.mli mylib.ml
</pre></div>
</div>
<p>We will be using <code class="docutils literal notranslate"><span class="pre">ocamlfind</span></code> for compiling code which uses libraries
from now on.</p>
<p>Since this is still kind of annoying, we automate this by putting
these kinds of commands in a <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> that we will supply to you.
Then, in order to compile your program, you will just have to type:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ make
</pre></div>
</div>
<p>as previously discussed.</p>
<p>For more complicated programs involving multiple files of OCaml code,
the best approach is to use the <a class="reference external" href="https://dune.readthedocs.io/en/stable/">Dune</a> compilation manager.
We’ll learn more about Dune in later assignments.</p>
</section>
<section id="using-the-num-library">
<h2>Using the <code class="docutils literal notranslate"><span class="pre">Num</span></code> library<a class="headerlink" href="#using-the-num-library" title="Permalink to this headline">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Num</span></code> library defines a data type called <code class="docutils literal notranslate"><span class="pre">num</span></code> which can
represent arbitrarily-large integers and rational numbers composed of
arbitrarily-large integers. The library documentation is
<a class="reference external" href="https://ocaml.org/releases/4.05/htmlman/libref/Num.html">here</a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">num</span></code> type is abstract, so you have to convert <em>e.g.</em> integers to and from
<code class="docutils literal notranslate"><span class="pre">num</span></code>s in order to use them. To convert an integer to a <code class="docutils literal notranslate"><span class="pre">num</span></code>, use the
<code class="docutils literal notranslate"><span class="pre">int_of_num</span></code> function and to convert back use the <code class="docutils literal notranslate"><span class="pre">num_of_int</span></code> function.
The <code class="docutils literal notranslate"><span class="pre">string_of_num</span></code> function converts a <code class="docutils literal notranslate"><span class="pre">num</span></code> to a string, while
<code class="docutils literal notranslate"><span class="pre">float_of_num</span></code> converts a <code class="docutils literal notranslate"><span class="pre">num</span></code> to a floating-point number. The numeric
operators in the <code class="docutils literal notranslate"><span class="pre">Num</span></code> library all have a <code class="docutils literal notranslate"><span class="pre">/</span></code> suffix, so instead of <code class="docutils literal notranslate"><span class="pre">+</span> <span class="pre">-</span> <span class="pre">*</span>
<span class="pre">/</span></code> <em>etc.</em> we have <code class="docutils literal notranslate"><span class="pre">+/</span> <span class="pre">-/</span> <span class="pre">*/</span> <span class="pre">//</span></code> <em>etc.</em> This is analogous to floating-point
numbers which use <code class="docutils literal notranslate"><span class="pre">+.</span> <span class="pre">-.</span> <span class="pre">*.</span> <span class="pre">/.</span></code> <em>etc.</em> It’s not terribly pleasant to use, but
it works.</p>
<p>There are also <code class="docutils literal notranslate"><span class="pre">num</span></code>-specific relational operators (<code class="docutils literal notranslate"><span class="pre">&lt;/</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=/</span></code>,
<code class="docutils literal notranslate"><span class="pre">&gt;/</span></code>, <em>etc.</em>). You should use these on <code class="docutils literal notranslate"><span class="pre">num</span></code>s instead of the
(overloaded) built-in ones (<code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, <em>etc.</em>) because the
overloaded ones won’t always work properly on <code class="docutils literal notranslate"><span class="pre">num</span></code>s. This includes
the equality operators, which for <code class="docutils literal notranslate"><span class="pre">num</span></code>s are <code class="docutils literal notranslate"><span class="pre">=/</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;&gt;/</span></code>.</p>
<p>Here are some examples of the <code class="docutils literal notranslate"><span class="pre">Num</span></code> library in use in the interactive
interpreter:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ utop
# #require &quot;num&quot;;;
# open Num;;
# let n1 = num_of_int 42;;
val n1 : Num.num = &lt;num 42&gt;
# let n2 = num_of_int 57;;
val n2 : Num.num = &lt;num 57&gt;
# n1 +/ n2;;
- : Num.num = &lt;num 99&gt;
# n1 */ n2;;
- : Num.num = &lt;num 2394&gt;
# n1 // n2;;
- : Num.num = &lt;num 14/19&gt;
# float_of_num (n1 // n2);;
- : float = 0.736842105263
# string_of_num (n1 // n2);;
- : string = &quot;14/19&quot;
# int_of_num (n1 // n2);;
Exception: Failure &quot;integer argument required&quot;.
# int_of_num ((num_of_int 42) // (num_of_int 21));;
- : int = 2
</pre></div>
</div>
<p>This should be enough to get you through this assignment.</p>
<hr class="docutils" />
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">Num</span></code> package is pretty much deprecated in favor of the
<code class="docutils literal notranslate"><span class="pre">Zarith</span></code> package, but we still use <code class="docutils literal notranslate"><span class="pre">Num</span></code> because it’s simpler.</p>
</dd>
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>More specifically, this is the OCaml <em>bytecode</em> compiler,
which is optimized for very fast compilation.
There is also a native-code OCaml compiler called <code class="docutils literal notranslate"><span class="pre">ocamlopt</span></code>,
which is slower but produces much faster code.
We will usually just use <code class="docutils literal notranslate"><span class="pre">ocamlc</span></code>, because it will be fast enough
for our purposes.</p>
</dd>
</dl>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Preamble.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Preamble</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="partA_orders_of_growth.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Part A: Orders of growth</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Michael Vanier<br/>
  
      &copy; Copyright 2023, Michael C. Vanier. All rights reserved.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>