
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>OCaml notes &#8212; The CS 4 book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/design-tabs.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Part A: Abstraction" href="partA_abstraction.html" />
    <link rel="prev" title="Preamble" href="Preamble.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">The CS 4 book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../admin/index.html">
   Administrative information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../admin/Syllabus.html">
     Syllabus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../admin/Collaboration_policies.html">
     Collaboration policies
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Motivation.html">
   Motivation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../History.html">
   History
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../index.html">
   Assignments
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../../0/Assignment0.html">
     Assignment 0: Getting set up
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../1/index.html">
     Assignment 1: Evaluation and recursion
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/partA_exercises.html">
       Part A: Basic exercises
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/partB_evaluation.html">
       Part B: Evaluation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../1/sections/partC_recursion.html">
       Part C: Recursion
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../2/index.html">
     Assignment 2: Asymptotic complexity and higher-order functions
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../2/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../2/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../2/sections/partA_orders_of_growth.html">
       Part A: Orders of growth
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../2/sections/partB_evaluation.html">
       Part B: Evaluation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../2/sections/partC_higher_order_functions.html">
       Part C. Higher-order functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../2/sections/partD_additional_problems.html">
       Part D: Additional problems
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../3/index.html">
     Assignment 3: Lists
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/partA_lists.html">
       Part A: Working with lists
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/partB_structural_generative_recursion.html">
       Part B: Structural and generative recursion
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../3/sections/partC_more_lists.html">
       Part C: Some harder problems with lists
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../index.html">
     Assignment 4: Data abstraction
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="partA_abstraction.html">
       Part A: Abstraction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="partB_more_abstraction.html">
       Part B: More abstraction problems
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="partC_algebra.html">
       Part C: Miniproject: Algebraic expressions
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../midterm/index.html">
     Midterm exam
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../midterm/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../midterm/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../midterm/sections/partA_complexity.html">
       Part A: Asymptotic time complexity
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../midterm/sections/partB_lists_hofs.html">
       Part B: Recursion and higher-order functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../midterm/sections/partC_data_structures.html">
       Part C: Data structures: AA trees
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../5/index.html">
     Assignment 5: Tags and objects
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../5/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../5/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../5/sections/partA_mutation.html">
       Part A: Mutation and imperative programming
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../5/sections/partB_tagged_data.html">
       Part B: Tagged Data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../5/sections/partC_objects.html">
       Part C: Objects
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../6/index.html">
     Assignment 6: Environmentally-friendly
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../6/sections/Preamble.html">
       Details
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../6/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../6/sections/partA_environment_model.html">
       Part A: The environment model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../6/sections/partB_imperative_objects.html">
       Part B: Imperative objects
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../6/sections/partC_modules_functors.html">
       Part C: Modules and functors
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../6/sections/partD_special_topics.html">
       Part D: Special topics
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../readings/index.html">
   Readings
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../readings/ocaml_cheat_sheet.html">
     OCaml syntax cheat sheet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../readings/subst.html">
     The substitution model
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#testing">
   Testing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#records-and-field-punning">
   Records and field punning
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#records-and-pattern-matching-with-missing-fields">
   Records and pattern matching with missing fields
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#names-and-the-single-quote-character">
   Names and the single quote character
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#polymorphic-variants">
   Polymorphic variants
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>OCaml notes</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#testing">
   Testing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#records-and-field-punning">
   Records and field punning
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#records-and-pattern-matching-with-missing-fields">
   Records and pattern matching with missing fields
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#names-and-the-single-quote-character">
   Names and the single quote character
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#polymorphic-variants">
   Polymorphic variants
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="ocaml-notes">
<h1>OCaml notes<a class="headerlink" href="#ocaml-notes" title="Permalink to this headline">#</a></h1>
<section id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">#</a></h2>
<p>For this assignment, we are supplying you with these support files:</p>
<ol class="arabic simple">
<li><p>a <code class="docutils literal notranslate"><span class="pre">.mli</span></code> OCaml interface file (<code class="docutils literal notranslate"><span class="pre">lab4.mli</span></code>)</p></li>
<li><p>a test script (<code class="docutils literal notranslate"><span class="pre">tests_lab4.ml</span></code>)</p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">Makefile</span></code></p></li>
</ol>
<p>These files are all available on the course Canvas site
in a single zip file called <code class="docutils literal notranslate"><span class="pre">lab4.zip</span></code>.  Download this file and
unzip it:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ unzip lab4.zip
</pre></div>
</div>
<p>This will create a <code class="docutils literal notranslate"><span class="pre">lab4</span></code> directory with the files inside it.
You should not change these files, and you should not submit them as part of
your assignment submission.  You should create, edit and compile the file
<code class="docutils literal notranslate"><span class="pre">lab4.ml</span></code> (which you will be handing in) in the same directory.</p>
<p>Compile and test the code the same way you did in previous assignments.
Briefly:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ make
</pre></div>
</div>
<p>compiles the code and runs the tests.
If you just want to compile the code to check for type errors,
type:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ make compile
</pre></div>
</div>
<p>To remove all the generated files,
including log files and all compiled OCaml files, type:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ make clean
</pre></div>
</div>
<p>Of course, you can also compile your code from inside the OCaml
interpreter using the <code class="docutils literal notranslate"><span class="pre">#use</span></code> directive, as we’ve previously described.
This will check that the code compiles, but it won’t check
that it conforms to the <code class="docutils literal notranslate"><span class="pre">.mli</span></code> file, and it won’t run the tests.</p>
</section>
<section id="records-and-field-punning">
<h2>Records and field punning<a class="headerlink" href="#records-and-field-punning" title="Permalink to this headline">#</a></h2>
<p>We will be using OCaml records extensively in this assignment, so this
is a good time to introduce a nifty feature (which we also mentioned in
the recitation lectures) which makes writing code that uses records much
easier. This feature is called <em>field punning</em> for reasons that will
become clear shortly.</p>
<p>Consider a simple record datatype for complex numbers:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">complex</span> <span class="o">=</span> <span class="o">{</span> <span class="n">real</span> <span class="o">:</span> <span class="kt">float</span><span class="o">;</span> <span class="n">imag</span> <span class="o">:</span> <span class="kt">float</span> <span class="o">}</span>
</pre></div>
</div>
<p>Writing code that pattern-matches against a complex number can be a bit
annoying:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">magnitude</span> <span class="o">{</span> <span class="n">real</span> <span class="o">=</span> <span class="n">r</span><span class="o">;</span> <span class="n">imag</span> <span class="o">=</span> <span class="n">i</span> <span class="o">}</span> <span class="o">=</span> <span class="n">sqrt</span> <span class="o">(</span><span class="n">r</span> <span class="o">*.</span> <span class="n">r</span> <span class="o">+.</span> <span class="n">i</span> <span class="o">*.</span> <span class="n">i</span><span class="o">)</span>
</pre></div>
</div>
<p>What’s annoying about this is that we have to come up with new names for
the real and imaginary part of the complex number. Of course, we could
do it this way without pattern matching:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">magnitude</span> <span class="n">c</span> <span class="o">=</span> <span class="n">sqrt</span> <span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="n">real</span> <span class="o">*.</span> <span class="n">c</span><span class="o">.</span><span class="n">real</span> <span class="o">+.</span> <span class="n">c</span><span class="o">.</span><span class="n">imag</span> <span class="o">*.</span> <span class="n">c</span><span class="o">.</span><span class="n">imag</span><span class="o">)</span>
</pre></div>
</div>
<p>because records support a “dot syntax” to access their components (like
Python objects). However, this isn’t really an improvement. Yet another
way to write this would be as follows:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">magnitude</span> <span class="o">{</span> <span class="n">real</span> <span class="o">=</span> <span class="n">real</span><span class="o">;</span> <span class="n">imag</span> <span class="o">=</span> <span class="n">imag</span> <span class="o">}</span> <span class="o">=</span> <span class="n">sqrt</span> <span class="o">(</span><span class="n">real</span> <span class="o">*.</span> <span class="n">real</span> <span class="o">+.</span> <span class="n">imag</span> <span class="o">*.</span> <span class="n">imag</span><span class="o">)</span>
</pre></div>
</div>
<p>The right-hand side of this definition looks pretty good, but the
left-hand side is weird. It’s legal, because in OCaml you can use a
field name as a variable name (they exist in different <em>namespaces</em>, to
be technical), but it’s ugly. What field punning allows you to do is to
write this code like this:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">magnitude</span> <span class="o">{</span> <span class="n">real</span><span class="o">;</span> <span class="n">imag</span> <span class="o">}</span> <span class="o">=</span> <span class="n">sqrt</span> <span class="o">(</span><span class="n">real</span> <span class="o">*.</span> <span class="n">real</span> <span class="o">+.</span> <span class="n">imag</span> <span class="o">*.</span> <span class="n">imag</span><span class="o">)</span>
</pre></div>
</div>
<p>What this does is use the (variable) name <code class="docutils literal notranslate"><span class="pre">real</span></code> as the value of the
(field) name <code class="docutils literal notranslate"><span class="pre">real</span></code>, and similarly for <code class="docutils literal notranslate"><span class="pre">imag</span></code>. This is a nice way to
make functions which use records and which pattern-match on those
records easier to write and easier to read.</p>
<p>You can also use field punning when creating values of record types:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">#</span> <span class="k">let</span> <span class="n">c</span> <span class="o">=</span>
    <span class="k">let</span> <span class="n">real</span> <span class="o">=</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="k">in</span>
    <span class="k">let</span> <span class="n">imag</span> <span class="o">=</span> <span class="mi">3</span><span class="o">.</span><span class="mi">4</span> <span class="k">in</span>
      <span class="o">{</span> <span class="n">real</span><span class="o">;</span> <span class="n">imag</span> <span class="o">}</span> <span class="o">;;</span>
<span class="o">-</span> <span class="o">:</span> <span class="n">complex</span> <span class="o">=</span> <span class="o">{</span><span class="n">real</span> <span class="o">=</span> <span class="mi">1</span><span class="o">.;</span> <span class="n">imag</span> <span class="o">=</span> <span class="mi">3</span><span class="o">.</span><span class="mi">4</span><span class="o">}</span>
</pre></div>
</div>
<p>This is a bit more confusing to read, but it works fine. Remember: field
names are in a different namespace than variable names. So it’s even
legal to do this:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">complex</span> <span class="o">=</span> <span class="o">{</span> <span class="n">real</span> <span class="o">:</span> <span class="kt">float</span><span class="o">;</span> <span class="n">imag</span> <span class="o">:</span> <span class="kt">float</span> <span class="o">}</span>
<span class="k">let</span> <span class="n">real</span> <span class="o">=</span> <span class="mi">42</span>
<span class="k">let</span> <span class="n">imag</span> <span class="o">=</span> <span class="s2">&quot;this is wacky&quot;</span>
</pre></div>
</div>
<p>Here, the variables <code class="docutils literal notranslate"><span class="pre">real</span></code> and <code class="docutils literal notranslate"><span class="pre">imag</span></code> aren’t even floats, though the
corresponding field names do refer to floats.</p>
<p>You don’t have to use field punning in this (or any other) assignment,
but we recommend it.
A good reference on OCaml records is <a class="reference external" href="https://dev.realworldocaml.org/records.html">this chapter</a> from <a class="reference external" href="https://dev.realworldocaml.org">Real World OCaml</a>.
The <a class="reference external" href="https://v2.ocaml.org/manual/index.html">OCaml manual</a> also has a section on records in the first chapter
(“The core language”).</p>
</section>
<section id="records-and-pattern-matching-with-missing-fields">
<h2>Records and pattern matching with missing fields<a class="headerlink" href="#records-and-pattern-matching-with-missing-fields" title="Permalink to this headline">#</a></h2>
<p>When pattern-matching on records, you don’t have to include all the
record fields if you don’t want to.  For instance:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">complex</span> <span class="o">=</span> <span class="o">{</span> <span class="n">real</span> <span class="o">:</span> <span class="kt">float</span><span class="o">;</span> <span class="n">imag</span> <span class="o">:</span> <span class="kt">float</span> <span class="o">}</span>
<span class="k">let</span> <span class="n">real_of_complex</span> <span class="o">{</span> <span class="n">real</span> <span class="o">}</span> <span class="o">=</span> <span class="n">real</span>
</pre></div>
</div>
<p>This compiles and runs fine.  But if you have certain warnings enabled
(which happens when you compile the code using our <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>),
you’ll get a warning:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Warning 9 [missing-record-field-pattern]: the following labels are not bound in this record pattern:
imag
Either bind these labels explicitly or add &#39;; _&#39; to the pattern.
</pre></div>
</div>
<p><strong>You should never ignore warnings!  Always fix the cause of the warning.</strong>
In this case, the fix is as simple as changing the pattern by adding
<code class="docutils literal notranslate"><span class="pre">;</span> <span class="pre">_</span></code> to the end of the pattern, as the error message indicated:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">real_of_complex</span> <span class="o">{</span> <span class="n">real</span><span class="o">;</span> <span class="o">_</span> <span class="o">}</span> <span class="o">=</span> <span class="n">real</span>
</pre></div>
</div>
<p>Now, when you compile this code, there will be no warning.</p>
</section>
<section id="names-and-the-single-quote-character">
<h2>Names and the single quote character<a class="headerlink" href="#names-and-the-single-quote-character" title="Permalink to this headline">#</a></h2>
<p>Unlike most programming languages,
OCaml allows identifier names to contain the single quote character (<code class="docutils literal notranslate"><span class="pre">'</span></code>)
in any position except the first position.
Typically, we use the single quote character at the end of names,
and sometimes we use more than one single quote character.
These are often used to refer to a name
which is related in some way to another name but distinct.
The single quote character used this way is often called a “prime” character,
which comes from its use in mathematics.
So the name <code class="docutils literal notranslate"><span class="pre">foo'</span></code> would be pronounced “foo-prime”.</p>
</section>
<section id="polymorphic-variants">
<h2>Polymorphic variants<a class="headerlink" href="#polymorphic-variants" title="Permalink to this headline">#</a></h2>
<p>Problem B.1 uses polymorphic variants, which are similar to algebraic
datatypes except that you don’t have to declare the type ahead of time.
Polymorphic variants were discussed in lecture 10, and are discussed in
the <a class="reference external" href="https://v2.ocaml.org/manual/index.html">OCaml manual</a> (chapter 5) and in <a class="reference external" href="https://dev.realworldocaml.org">Real World OCaml</a> (chapter 6).</p>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Preamble.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Preamble</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="partA_abstraction.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Part A: Abstraction</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Michael Vanier<br/>
  
      &copy; Copyright 2023, Michael C. Vanier. All rights reserved.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>