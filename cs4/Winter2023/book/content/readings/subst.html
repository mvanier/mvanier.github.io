
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>The substitution model &#8212; The CS 4 book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="OCaml syntax cheat sheet" href="ocaml_cheat_sheet.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">The CS 4 book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../admin/index.html">
   Administrative information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../admin/Syllabus.html">
     Syllabus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../admin/Collaboration_policies.html">
     Collaboration policies
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Motivation.html">
   Motivation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../History.html">
   History
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../assignments/index.html">
   Assignments
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/0/Assignment0.html">
     Assignment 0: Getting set up
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../assignments/1/index.html">
     Assignment 1: Evaluation and recursion
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/1/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/1/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/1/sections/partA_exercises.html">
       Part A: Basic exercises
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/1/sections/partB_evaluation.html">
       Part B: Evaluation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/1/sections/partC_recursion.html">
       Part C: Recursion
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../assignments/2/index.html">
     Assignment 2: Asymptotic complexity and higher-order functions
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/2/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/2/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/2/sections/partA_orders_of_growth.html">
       Part A: Orders of growth
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/2/sections/partB_evaluation.html">
       Part B: Evaluation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/2/sections/partC_higher_order_functions.html">
       Part C. Higher-order functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/2/sections/partD_additional_problems.html">
       Part D: Additional problems
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../assignments/3/index.html">
     Assignment 3: Lists
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/3/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/3/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/3/sections/partA_lists.html">
       Part A: Working with lists
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/3/sections/partB_structural_generative_recursion.html">
       Part B: Structural and generative recursion
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/3/sections/partC_more_lists.html">
       Part C: Some harder problems with lists
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../assignments/4/index.html">
     Assignment 4: Data abstraction
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/4/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/4/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/4/sections/partA_abstraction.html">
       Part A: Abstraction
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/4/sections/partB_more_abstraction.html">
       Part B: More abstraction problems
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/4/sections/partC_algebra.html">
       Part C: Miniproject: Algebraic expressions
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../assignments/midterm/index.html">
     Midterm exam
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/midterm/sections/Preamble.html">
       Preamble
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/midterm/sections/ocaml_notes.html">
       OCaml notes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/midterm/sections/partA_complexity.html">
       Part A: Asymptotic time complexity
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/midterm/sections/partB_lists_hofs.html">
       Part B: Recursion and higher-order functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../assignments/midterm/sections/partC_data_structures.html">
       Part C: Data structures: AA trees
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Readings
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="ocaml_cheat_sheet.html">
     OCaml syntax cheat sheet
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     The substitution model
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#desugaring-and-precedence">
   Desugaring and precedence
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#desugaring">
     Desugaring
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#precedence">
     Precedence
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-basic-rule">
   The basic rule
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#specific-cases-of-the-basic-rule">
   Specific cases of the basic rule
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#let-bound-names">
   <code class="docutils literal notranslate">
    <span class="pre">
     let
    </span>
   </code>
   -bound names
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#top-level-let-expressions">
     Top-level
     <code class="docutils literal notranslate">
      <span class="pre">
       let
      </span>
     </code>
     expressions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#local-let-expressions">
     Local
     <code class="docutils literal notranslate">
      <span class="pre">
       let
      </span>
     </code>
     expressions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#if-expressions">
   <code class="docutils literal notranslate">
    <span class="pre">
     if
    </span>
   </code>
   expressions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#if-without-else">
     <code class="docutils literal notranslate">
      <span class="pre">
       if
      </span>
     </code>
     without
     <code class="docutils literal notranslate">
      <span class="pre">
       else
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fun-expressions">
   <code class="docutils literal notranslate">
    <span class="pre">
     fun
    </span>
   </code>
   expressions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#function-application">
   Function application
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#applying-built-in-functions-or-operators">
     Applying built-in functions or operators
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#applying-user-defined-functions-substitution">
     Applying user-defined functions: substitution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recursion">
     Recursion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nested-fun-expressions-and-shielding">
     Nested
     <code class="docutils literal notranslate">
      <span class="pre">
       fun
      </span>
     </code>
     expressions and shielding
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>The substitution model</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#desugaring-and-precedence">
   Desugaring and precedence
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#desugaring">
     Desugaring
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#precedence">
     Precedence
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-basic-rule">
   The basic rule
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#specific-cases-of-the-basic-rule">
   Specific cases of the basic rule
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#let-bound-names">
   <code class="docutils literal notranslate">
    <span class="pre">
     let
    </span>
   </code>
   -bound names
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#top-level-let-expressions">
     Top-level
     <code class="docutils literal notranslate">
      <span class="pre">
       let
      </span>
     </code>
     expressions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#local-let-expressions">
     Local
     <code class="docutils literal notranslate">
      <span class="pre">
       let
      </span>
     </code>
     expressions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#if-expressions">
   <code class="docutils literal notranslate">
    <span class="pre">
     if
    </span>
   </code>
   expressions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#if-without-else">
     <code class="docutils literal notranslate">
      <span class="pre">
       if
      </span>
     </code>
     without
     <code class="docutils literal notranslate">
      <span class="pre">
       else
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fun-expressions">
   <code class="docutils literal notranslate">
    <span class="pre">
     fun
    </span>
   </code>
   expressions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#function-application">
   Function application
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#applying-built-in-functions-or-operators">
     Applying built-in functions or operators
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#applying-user-defined-functions-substitution">
     Applying user-defined functions: substitution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recursion">
     Recursion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nested-fun-expressions-and-shielding">
     Nested
     <code class="docutils literal notranslate">
      <span class="pre">
       fun
      </span>
     </code>
     expressions and shielding
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="the-substitution-model">
<span id="subst"></span><h1>The substitution model<a class="headerlink" href="#the-substitution-model" title="Permalink to this headline">#</a></h1>
<p>This reading is a summary of the rules of the substitution model,
discussed in lecture 2.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">#</a></h2>
<p>The substitution model is a way of manually evaluating OCaml expressions.
It’s similar to, but not identical to,
what the computer does when it evaluates OCaml code.
The point of learning the model is so that you have a good mental framework
for how OCaml code evaluates.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At some point, this model will not be sufficient to explain all the features
of OCaml that we will use (notably imperative programming),
so we will define a new model: the <em>environment model</em>.
That model will share many features with the substitution model,
but its handling of name lookup will be much more precise.</p>
<p>The substitution model is adequate to understand the
purely functional subset of OCaml we will use for the first half
of the course.</p>
</div>
</section>
<section id="desugaring-and-precedence">
<h2>Desugaring and precedence<a class="headerlink" href="#desugaring-and-precedence" title="Permalink to this headline">#</a></h2>
<p>Before evaluating any OCaml code using the substitution model,
the code should first be <em>desugared</em>,
and then operator <em>precedence</em> should be made explicit using parentheses.</p>
<section id="desugaring">
<h3>Desugaring<a class="headerlink" href="#desugaring" title="Permalink to this headline">#</a></h3>
<p>The main kind of desugaring we need is to replace expressions of this form:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">f</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="o">...</span>
</pre></div>
</div>
<p>with this:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">f</span> <span class="o">=</span> <span class="k">fun</span> <span class="n">x</span> <span class="n">y</span> <span class="o">-&gt;</span> <span class="o">...</span>
</pre></div>
</div>
<p>After desugaring, all <code class="docutils literal notranslate"><span class="pre">let</span></code> expressions are “simple”
<em>i.e.</em> they bind a single name to a value
(the result of evaluating the expression on the right-hand side
of the <code class="docutils literal notranslate"><span class="pre">=</span></code>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If we are really being picky, we could desugar this further to:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">f</span> <span class="o">=</span> <span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="k">fun</span> <span class="n">y</span> <span class="o">-&gt;</span> <span class="o">...</span>
</pre></div>
</div>
<p>but we don’t require that.  This is because of function <em>currying</em>,
which is the way that OCaml interprets functions with multiple arguments.</p>
<p>We recommend that you don’t do this in your written evaluations,
unless you have to for some reason.</p>
</div>
</section>
<section id="precedence">
<h3>Precedence<a class="headerlink" href="#precedence" title="Permalink to this headline">#</a></h3>
<p>Operator precedence should be made explicit by wrapping parentheses around
nested operator expressions.  For instance, this code:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">7</span>
</pre></div>
</div>
<p>would become:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">+</span> <span class="o">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">7</span><span class="o">)</span>
</pre></div>
</div>
<p>The full precedence table of OCaml operators is <a class="reference external" href="https://v2.ocaml.org/manual/expr.html#ss%3Aprecedence-and-associativity">here</a>.</p>
<p>This step is done so that there is never any question about
what the operands of an operator are.</p>
</section>
</section>
<section id="the-basic-rule">
<h2>The basic rule<a class="headerlink" href="#the-basic-rule" title="Permalink to this headline">#</a></h2>
<p>To evaluate an OCaml expression:</p>
<ol class="arabic simple">
<li><p>evaluate the <em>operands</em> of the expression</p></li>
<li><p>evaluate the <em>operator</em> or <em>function</em> of the expression</p></li>
<li><p><em>apply</em> the operator/function to the evaluated operands</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>OCaml actually evaluates operands from right-to-left,
in contrast to most languages, which evaluate operands from left-to-right.
Evaluation order is <em>not</em> part of the substitution model,
and shouldn’t make any difference.</p>
<p>Similarly, you can evaluate the operator/function before or after
evaluating the operands, and it won’t make any difference in this model.</p>
</div>
<p>The basic rule when evaluating a function call or an operator expression.
Other expressions (such as <code class="docutils literal notranslate"><span class="pre">let</span></code>, <code class="docutils literal notranslate"><span class="pre">fun</span></code> and <code class="docutils literal notranslate"><span class="pre">if</span></code> expressions)
do not use the basic rule; they have their own evaluation rules.
Such expressions are called <em>special forms</em>.</p>
</section>
<section id="specific-cases-of-the-basic-rule">
<h2>Specific cases of the basic rule<a class="headerlink" href="#specific-cases-of-the-basic-rule" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Numbers evaluate to themselves: <code class="docutils literal notranslate"><span class="pre">10</span></code> <span class="raw-html">&rarr;</span> <code class="docutils literal notranslate"><span class="pre">10</span></code>
(In fact, any literal data value evaluates to itself;
that’s why it’s called “literal”.
For now, we are mostly working with numbers.)</p></li>
<li><p>Primitive (built-in) functions evaluate to the corresponding
internal procedure.  We can write this as either:
<code class="docutils literal notranslate"><span class="pre">+</span></code> <span class="raw-html">&rarr;</span> <code class="docutils literal notranslate"><span class="pre">[primitive</span> <span class="pre">function</span> <span class="pre">+]</span></code>
(<code class="docutils literal notranslate"><span class="pre">[primitive</span> <span class="pre">procedure</span> <span class="pre">+]</span></code> is also OK)
or just <code class="docutils literal notranslate"><span class="pre">+</span></code> <span class="raw-html">&rarr;</span> <code class="docutils literal notranslate"><span class="pre">+</span></code></p></li>
<li><p>Variables that have been previously defined
are “looked up” (in some unspecified way)
and evaluate to the value that they were previously bound to.
(If they weren’t bound to a value previously, it’s an error.)</p></li>
</ul>
</section>
<section id="let-bound-names">
<h2><code class="docutils literal notranslate"><span class="pre">let</span></code>-bound names<a class="headerlink" href="#let-bound-names" title="Permalink to this headline">#</a></h2>
<p>There are two kinds of <code class="docutils literal notranslate"><span class="pre">let</span></code>-bound names: top-level and in-expression.
They evaluate differently.</p>
<section id="top-level-let-expressions">
<h3>Top-level <code class="docutils literal notranslate"><span class="pre">let</span></code> expressions<a class="headerlink" href="#top-level-let-expressions" title="Permalink to this headline">#</a></h3>
<p>A top-level <code class="docutils literal notranslate"><span class="pre">let</span></code> expression <a class="footnote-reference brackets" href="#id4" id="id1">1</a> looks like this:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="o">&lt;</span><span class="n">var</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">expr</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>for some variable name <code class="docutils literal notranslate"><span class="pre">&lt;var&gt;</span></code> and some expression <code class="docutils literal notranslate"><span class="pre">&lt;expr&gt;</span></code>.
For instance:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span>
</pre></div>
</div>
<p>To evaluate this, you</p>
<ul class="simple">
<li><p>evaluate the expression to the right of the <code class="docutils literal notranslate"><span class="pre">=</span></code> sign
(here, <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">+</span> <span class="pre">3</span></code>, which evaluates to <code class="docutils literal notranslate"><span class="pre">5</span></code>);</p></li>
<li><p>“make an association” or “bind” the name (<code class="docutils literal notranslate"><span class="pre">x</span></code> here) to
the value of the evaluated expression (<code class="docutils literal notranslate"><span class="pre">5</span></code>).
The details of how to make this association aren’t important
for now, though we’ll revisit this later.</p></li>
</ul>
<p>In this case, we make an association between the name <code class="docutils literal notranslate"><span class="pre">x</span></code> and the value
<code class="docutils literal notranslate"><span class="pre">5</span></code>.  We can also say that we bind <code class="docutils literal notranslate"><span class="pre">x</span></code> to <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p>
<p>After this expression is evaluated, the name <code class="docutils literal notranslate"><span class="pre">x</span></code> will be bound to the value
<code class="docutils literal notranslate"><span class="pre">5</span></code> for the rest of the evaluated code, unless <code class="docutils literal notranslate"><span class="pre">x</span></code> is given a new binding
with a new top-level <code class="docutils literal notranslate"><span class="pre">let</span></code> expression.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A new binding for <code class="docutils literal notranslate"><span class="pre">x</span></code> would be something like:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>
</div>
<p>From then on, any reference to <code class="docutils literal notranslate"><span class="pre">x</span></code> would get the new value.
This is <em>not</em> the same as assignment in an imperative language,
because it doesn’t overwrite the old binding.
Instead, this code creates a <em>new</em> binding to <code class="docutils literal notranslate"><span class="pre">x</span></code> which
“shadows” the old binding, but the old binding still exists,
and in some cases can still have effects.</p>
</div>
</section>
<section id="local-let-expressions">
<h3>Local <code class="docutils literal notranslate"><span class="pre">let</span></code> expressions<a class="headerlink" href="#local-let-expressions" title="Permalink to this headline">#</a></h3>
<p>A “local” <code class="docutils literal notranslate"><span class="pre">let</span></code> expression is a <code class="docutils literal notranslate"><span class="pre">let</span></code> expression where a name is bound
to a value and then immediately used in another expression, such as this:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span> <span class="k">in</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
</pre></div>
</div>
<p>In this case, the name <code class="docutils literal notranslate"><span class="pre">x</span></code> has a meaning inside the body of the expression
(the <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">*</span> <span class="pre">x</span></code> part) but not outside.  To evaluate this, you:</p>
<ul class="simple">
<li><p>evaluate the <em>binding expression</em>
(here, <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">+</span> <span class="pre">3</span></code>, which evaluates to <code class="docutils literal notranslate"><span class="pre">5</span></code>),</p></li>
<li><p>bind the name to the value (here, bind <code class="docutils literal notranslate"><span class="pre">x</span></code> to <code class="docutils literal notranslate"><span class="pre">5</span></code>),</p></li>
<li><p>and evaluate the <em>body expression</em> (here, <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">*</span> <span class="pre">x</span></code>).</p></li>
</ul>
<p>In the body expression, of course, you can use the name <code class="docutils literal notranslate"><span class="pre">x</span></code>, which
has a value (<code class="docutils literal notranslate"><span class="pre">5</span></code>).  Outside of this expression, the name <code class="docutils literal notranslate"><span class="pre">x</span></code>
either has no value (if it wasn’t bound before) or has the value it
previously had (if it was).
Remember: you aren’t changing a previous binding (to <code class="docutils literal notranslate"><span class="pre">x</span></code>),
you’re creating a new one that is used only in a single expression.</p>
</section>
</section>
<section id="if-expressions">
<h2><code class="docutils literal notranslate"><span class="pre">if</span></code> expressions<a class="headerlink" href="#if-expressions" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">if</span></code> expressions consist of three subexpressions:</p>
<ul class="simple">
<li><p>the <em>test</em> subexpression (between the <code class="docutils literal notranslate"><span class="pre">if</span></code> and the <code class="docutils literal notranslate"><span class="pre">then</span></code> keywords)</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">then</span></code> subexpression (between the <code class="docutils literal notranslate"><span class="pre">then</span></code> and the <code class="docutils literal notranslate"><span class="pre">else</span></code> keywords)</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">else</span></code> subexpression (everything following the <code class="docutils literal notranslate"><span class="pre">else</span></code> keyword)</p></li>
</ul>
<p>They have the following evaluation rule.</p>
<ol class="arabic simple">
<li><p>Evaluate the test subexpression.</p></li>
<li><p>If the test subexpression evaluates to <code class="docutils literal notranslate"><span class="pre">true</span></code>,
evaluate the <code class="docutils literal notranslate"><span class="pre">then</span></code> subexpression.</p></li>
<li><p>If the test subexpression evaluates to <code class="docutils literal notranslate"><span class="pre">false</span></code>,
evaluate the <code class="docutils literal notranslate"><span class="pre">else</span></code> subexpression.</p></li>
</ol>
<p>One consequence of this is that you never evaluate both the
<code class="docutils literal notranslate"><span class="pre">then</span></code> and <code class="docutils literal notranslate"><span class="pre">else</span></code> subexpressions.
This is why <code class="docutils literal notranslate"><span class="pre">if</span></code> can’t be a function (it’s not just the syntax!) <a class="footnote-reference brackets" href="#id5" id="id2">2</a></p>
<section id="if-without-else">
<h3><code class="docutils literal notranslate"><span class="pre">if</span></code> without <code class="docutils literal notranslate"><span class="pre">else</span></code><a class="headerlink" href="#if-without-else" title="Permalink to this headline">#</a></h3>
<p>When writing purely functional code in OCaml,
<code class="docutils literal notranslate"><span class="pre">if</span></code> expressions always have both a <code class="docutils literal notranslate"><span class="pre">then</span></code> subexpression
and an <code class="docutils literal notranslate"><span class="pre">else</span></code> subexpression.
(These are sometimes called the “then clause” and the “else clause”.)
With respect to the substitution model, we will always have
<code class="docutils literal notranslate"><span class="pre">else</span></code> subexpressions in <code class="docutils literal notranslate"><span class="pre">if</span></code> expressions.</p>
<p>To learn more about how <code class="docutils literal notranslate"><span class="pre">if</span></code> expressions without <code class="docutils literal notranslate"><span class="pre">else</span></code> subexpressions
work, see the <a class="reference internal" href="ocaml_cheat_sheet.html"><span class="doc">OCaml cheat sheet</span></a>.</p>
</section>
</section>
<section id="fun-expressions">
<h2><code class="docutils literal notranslate"><span class="pre">fun</span></code> expressions<a class="headerlink" href="#fun-expressions" title="Permalink to this headline">#</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">fun</span></code> expression (like <code class="docutils literal notranslate"><span class="pre">fun</span> <span class="pre">x</span> <span class="pre">y</span> <span class="pre">-&gt;</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">y</span></code>) represents an anonymous
function.
In the substitution model, a <code class="docutils literal notranslate"><span class="pre">fun</span></code> expression is usually the result of
desugaring a regular function definition, like</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">f</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
<p>which desugars to:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">f</span> <span class="o">=</span> <span class="k">fun</span> <span class="n">x</span> <span class="n">y</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">fun</span></code> expressions consist of two parts:</p>
<ul class="simple">
<li><p>the <em>formal parameters</em> of the function (here, <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>),</p></li>
<li><p>the <em>body</em> of the function (here, <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">+</span> <span class="pre">y</span></code>).</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">fun</span></code> expressions are trivial to evaluate:
you basically just leave them alone.
For this reason, in written evaluations you can write:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fun x y -&gt; x + y  --&gt;  fun x y -&gt; x + y
</pre></div>
</div>
<p>or just:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fun x y -&gt; x + y  --&gt;  itself
</pre></div>
</div>
</section>
<section id="function-application">
<h2>Function application<a class="headerlink" href="#function-application" title="Permalink to this headline">#</a></h2>
<p>Function application is at the heart of the substitution model.
There are two cases.</p>
<section id="applying-built-in-functions-or-operators">
<h3>Applying built-in functions or operators<a class="headerlink" href="#applying-built-in-functions-or-operators" title="Permalink to this headline">#</a></h3>
<p>Applying a built-in function or operator is simple: you just do it.
For instance:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Evaluate: 2 + 3
  2 --&gt; 2
  3 --&gt; 3
  + --&gt; [primitive function +]
  apply + to 2, 3 --&gt; 5

Evaluate: abs (-10)
  -10 --&gt; -10
  abs --&gt; [primitive function abs]
  apply abs to -10 --&gt; 10
</pre></div>
</div>
<p>In some cases we’ll allow you to shorten lines like</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>abs --&gt; [primitive function abs]
</pre></div>
</div>
<p>to just:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>abs --&gt; abs
</pre></div>
</div>
<p>Don’t do this unless we explicitly say it’s OK.</p>
</section>
<section id="applying-user-defined-functions-substitution">
<h3>Applying user-defined functions: substitution<a class="headerlink" href="#applying-user-defined-functions-substitution" title="Permalink to this headline">#</a></h3>
<p>Now we come to the “substitution” part of the substitution model.
It happens when you are applying a user-defined function
(which means a <code class="docutils literal notranslate"><span class="pre">fun</span></code> expression, or a function which gets desugared
to a <code class="docutils literal notranslate"><span class="pre">fun</span></code> expression) to its arguments
(which have already been evaluated to values, so they aren’t expressions
anymore).</p>
<p>The rules for applying user-define functions are:</p>
<ol class="arabic simple">
<li><p><em>Substitute</em> the function argument variables (formal parameters)
with the values given in the call
everywhere they occur in the function body.</p></li>
<li><p>Evaluate the resulting expression.</p></li>
</ol>
<p>For the most part, the substitution process is straightforward.
For each function parameter, you substitute the argument value
for the function parameter name in the function body
to get the substituted expression, which you then evaluate.
For instance, this expression:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="n">y</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">)</span> <span class="mi">2</span> <span class="mi">3</span>
</pre></div>
</div>
<p>evaluates as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Evaluate: (fun x y -&gt; x + y) 2 3
  2 --&gt; 2
  3 --&gt; 3
  (fun x y -&gt; x + y) --&gt; itself
  apply (fun x y -&gt; x + y) to 2, 3
<span class="hll">    substitute 2 for x, 3 for y in x + y --&gt; 2 + 3
</span>    evaluate: 2 + 3
      2 --&gt; 2
      3 --&gt; 3
      + --&gt; [primitive function +]
      apply + to 2, 3 --&gt; 5
</pre></div>
</div>
<p>You can even evaluate inside a complex expression
(for instance, an <code class="docutils literal notranslate"><span class="pre">if</span></code> expression):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Evaluate (fun x y -&gt; if x &gt; y then x + y else x - y) 2 3
  2 --&gt; 2
  3 --&gt; 3
  (fun x y -&gt; ...) --&gt; itself
  apply (fun x y -&gt; ...) to 2, 3
<span class="hll">    substitute 2 for x, 3 for y in if x &gt; y then x + y else x - y
</span><span class="hll">    --&gt; if 2 &gt; 3 then 2 + 3 else 2 - 3
</span>    evaluate: if 2 &gt; 3 then 2 + 3 else 2 - 3
      if is a special form; evaluate 2 &gt; 3
        2 --&gt; 2
        3 --&gt; 3
        &gt; --&gt; [primitive function &gt;]
        apply &gt; to 2, 3 --&gt; false
      For false case, evaluate else clause: 2 - 3
        2 --&gt; 2
        3 --&gt; 3
        - --&gt; [primitive function -]
        apply - to 2, 3 --&gt; -1
</pre></div>
</div>
<p>Notice that the substitution goes right inside the <code class="docutils literal notranslate"><span class="pre">if</span></code> expression,
regardless of which branch of the <code class="docutils literal notranslate"><span class="pre">if</span></code>
will eventually end up being evaluated.
(Here we also see that for long <code class="docutils literal notranslate"><span class="pre">fun</span></code> expression bodies,
we can abbreviate them with <code class="docutils literal notranslate"><span class="pre">...</span></code>.)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On the other hand, we can’t substitute inside a nested <code class="docutils literal notranslate"><span class="pre">fun</span></code>
expression in all cases.  See below for more details.</p>
</div>
</section>
<section id="recursion">
<h3>Recursion<a class="headerlink" href="#recursion" title="Permalink to this headline">#</a></h3>
<p>Recursion doesn’t require any special treatment in the substitution model,
except that you have to replace a function name with the correct
definition of that function when looking up the name.
This is usually obvious and probably won’t cause you any problems.
It could get weird in pathological cases where you redefine a name.
Here’s a silly example:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">factorial</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">(* obviously wrong *)</span>

<span class="c">(* Redefine factorial. *)</span>
<span class="k">let</span> <span class="n">factorial</span> <span class="n">n</span> <span class="o">=</span>     <span class="c">(* oops, forgot the &quot;rec&quot; *)</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
    <span class="mi">1</span>
  <span class="k">else</span>
    <span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span> <span class="o">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span>
</pre></div>
</div>
<p>When evaluating this function, the “recursive” call to <code class="docutils literal notranslate"><span class="pre">factorial</span></code>
will actually pick up the previous definition,
and <code class="docutils literal notranslate"><span class="pre">factorial</span></code> will return <code class="docutils literal notranslate"><span class="pre">0</span></code> for any input but <code class="docutils literal notranslate"><span class="pre">0</span></code>.
The solution is to include the <code class="docutils literal notranslate"><span class="pre">rec</span></code> in the second definition:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">factorial</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">(* obviously wrong *)</span>

<span class="c">(* Redefine factorial. *)</span>
<span class="k">let</span> <span class="k">rec</span> <span class="n">factorial</span> <span class="n">n</span> <span class="o">=</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
    <span class="mi">1</span>
  <span class="k">else</span>
    <span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span> <span class="o">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span>
</pre></div>
</div>
<p>Then everything will work correctly because the <code class="docutils literal notranslate"><span class="pre">rec</span></code> tells OCaml
that any references to <code class="docutils literal notranslate"><span class="pre">factorial</span></code> inside the body of <code class="docutils literal notranslate"><span class="pre">factorial</span></code>
represent the function being defined. <a class="footnote-reference brackets" href="#id6" id="id3">3</a></p>
<p>Of course, this normally doesn’t come up
because you normally don’t redefine functions in a file,
but something like this could happen when defining functions interactively
inside the OCaml interpreter.
This can lead to very peculiar bugs.</p>
</section>
<section id="nested-fun-expressions-and-shielding">
<h3>Nested <code class="docutils literal notranslate"><span class="pre">fun</span></code> expressions and shielding<a class="headerlink" href="#nested-fun-expressions-and-shielding" title="Permalink to this headline">#</a></h3>
<p>TODO</p>
<hr class="docutils" />
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Technically speaking, this isn’t a true expression,
since it doesn’t return a value.
It would be more accurate to call this a top-level <code class="docutils literal notranslate"><span class="pre">let</span></code> <em>binding</em>.</p>
</dd>
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>In a lazy functional language like Haskell, <code class="docutils literal notranslate"><span class="pre">if</span></code> <em>could</em> be
a function, except for the syntax.</p>
</dd>
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>This would make an awesome assignment problem,
but I’m not quite that mean.</p>
</dd>
</dl>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="ocaml_cheat_sheet.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">OCaml syntax cheat sheet</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Michael Vanier<br/>
  
      &copy; Copyright 2023, Michael C. Vanier. All rights reserved.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>