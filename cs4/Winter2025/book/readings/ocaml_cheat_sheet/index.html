
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mvanier.github.io/cs4/Winter2025/book/readings/ocaml_cheat_sheet/">
      
      
        <link rel="prev" href="../../assignments/1/partC_recursion/">
      
      
        <link rel="next" href="../subst/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>OCaml Cheat Sheet - The CS 4 book (Winter 2025)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ocaml-syntax-cheat-sheet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="The CS 4 book (Winter 2025)" class="md-header__button md-logo" aria-label="The CS 4 book (Winter 2025)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The CS 4 book (Winter 2025)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OCaml Cheat Sheet
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to medium mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to medium mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="medium" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="The CS 4 book (Winter 2025)" class="md-nav__button md-logo" aria-label="The CS 4 book (Winter 2025)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    The CS 4 book (Winter 2025)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/welcome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to CS 4!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/motivation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Motivation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Administrative
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Administrative
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/syllabus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syllabus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/collab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collaboration policies
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignments
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Assignments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assignments/0/assignment0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assignment 0: Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignment 1: Evaluation and recursion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Assignment 1: Evaluation and recursion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assignments/1/assignment1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assignments/1/ocaml_notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCaml notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assignments/1/partA_exercises/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part A: Exercises
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assignments/1/partB_evaluation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part B: Evaluation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assignments/1/partC_recursion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part C: Recursion
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Readings
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Readings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    OCaml Cheat Sheet
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    OCaml Cheat Sheet
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#operators" class="md-nav__link">
    <span class="md-ellipsis">
      Operators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operator-underloading" class="md-nav__link">
    <span class="md-ellipsis">
      Operator underloading
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operator-overloading" class="md-nav__link">
    <span class="md-ellipsis">
      Operator overloading
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operators-as-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Operators as functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#equalityinequality-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Equality/inequality operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#word-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Word operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unusual-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Unusual operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-new-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Defining new operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#printf-and-format-strings" class="md-nav__link">
    <span class="md-ellipsis">
      printf and format strings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lists" class="md-nav__link">
    <span class="md-ellipsis">
      Lists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arrays" class="md-nav__link">
    <span class="md-ellipsis">
      Arrays
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuples" class="md-nav__link">
    <span class="md-ellipsis">
      Tuples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tuples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type-notation" class="md-nav__link">
    <span class="md-ellipsis">
      Type notation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implicit-parentheses" class="md-nav__link">
    <span class="md-ellipsis">
      Implicit parentheses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commas-vs-semicolons" class="md-nav__link">
    <span class="md-ellipsis">
      Commas vs. semicolons
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#records" class="md-nav__link">
    <span class="md-ellipsis">
      Records
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Records">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pattern-matching-and-field-punning" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern matching and field punning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matching-a-part-of-a-record" class="md-nav__link">
    <span class="md-ellipsis">
      Matching a part of a record
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strings" class="md-nav__link">
    <span class="md-ellipsis">
      Strings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conditionals" class="md-nav__link">
    <span class="md-ellipsis">
      Conditionals
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conditionals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      if expressions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-without-else" class="md-nav__link">
    <span class="md-ellipsis">
      if without else
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#else-if" class="md-nav__link">
    <span class="md-ellipsis">
      else if
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#syntax-and-currying" class="md-nav__link">
    <span class="md-ellipsis">
      Syntax and currying
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Anonymous functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unused-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Unused arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#match-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      match expressions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="match expressions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optional-before-first-match" class="md-nav__link">
    <span class="md-ellipsis">
      Optional | before first match
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nested-match-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      Nested match expressions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      function expressions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-fragile-pattern-match-compiler-warning" class="md-nav__link">
    <span class="md-ellipsis">
      The "fragile pattern match" compiler warning
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#let-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      let expressions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="let expressions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#explicit-recursion" class="md-nav__link">
    <span class="md-ellipsis">
      Explicit recursion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#imperative-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Imperative programming
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Imperative programming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence expressions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weakly-polymorphic-types" class="md-nav__link">
    <span class="md-ellipsis">
      Weakly polymorphic types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../subst/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Substitution Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#operators" class="md-nav__link">
    <span class="md-ellipsis">
      Operators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operator-underloading" class="md-nav__link">
    <span class="md-ellipsis">
      Operator underloading
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operator-overloading" class="md-nav__link">
    <span class="md-ellipsis">
      Operator overloading
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operators-as-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Operators as functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#equalityinequality-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Equality/inequality operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#word-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Word operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unusual-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Unusual operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-new-operators" class="md-nav__link">
    <span class="md-ellipsis">
      Defining new operators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#printf-and-format-strings" class="md-nav__link">
    <span class="md-ellipsis">
      printf and format strings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lists" class="md-nav__link">
    <span class="md-ellipsis">
      Lists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arrays" class="md-nav__link">
    <span class="md-ellipsis">
      Arrays
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuples" class="md-nav__link">
    <span class="md-ellipsis">
      Tuples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tuples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type-notation" class="md-nav__link">
    <span class="md-ellipsis">
      Type notation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implicit-parentheses" class="md-nav__link">
    <span class="md-ellipsis">
      Implicit parentheses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commas-vs-semicolons" class="md-nav__link">
    <span class="md-ellipsis">
      Commas vs. semicolons
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#records" class="md-nav__link">
    <span class="md-ellipsis">
      Records
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Records">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pattern-matching-and-field-punning" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern matching and field punning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matching-a-part-of-a-record" class="md-nav__link">
    <span class="md-ellipsis">
      Matching a part of a record
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strings" class="md-nav__link">
    <span class="md-ellipsis">
      Strings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conditionals" class="md-nav__link">
    <span class="md-ellipsis">
      Conditionals
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Conditionals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      if expressions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-without-else" class="md-nav__link">
    <span class="md-ellipsis">
      if without else
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#else-if" class="md-nav__link">
    <span class="md-ellipsis">
      else if
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#syntax-and-currying" class="md-nav__link">
    <span class="md-ellipsis">
      Syntax and currying
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Anonymous functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unused-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Unused arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#match-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      match expressions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="match expressions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optional-before-first-match" class="md-nav__link">
    <span class="md-ellipsis">
      Optional | before first match
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nested-match-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      Nested match expressions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#function-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      function expressions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-fragile-pattern-match-compiler-warning" class="md-nav__link">
    <span class="md-ellipsis">
      The "fragile pattern match" compiler warning
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#let-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      let expressions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="let expressions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#explicit-recursion" class="md-nav__link">
    <span class="md-ellipsis">
      Explicit recursion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#imperative-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Imperative programming
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Imperative programming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence expressions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weakly-polymorphic-types" class="md-nav__link">
    <span class="md-ellipsis">
      Weakly polymorphic types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="ocaml-syntax-cheat-sheet">OCaml syntax cheat sheet</h1>
<p>OCaml is a great language, but its syntax is not its best feature.
More importantly,
the syntax is probably quite different
from any other language you know,
so getting comfortable with it will take some time.</p>
<p>In this document we describe aspects of OCaml syntax
that are most likely to be confusing and/or counterintuitive,
as well as some other features which may trip you up.
This document is <strong>not</strong> a complete description of OCaml syntax.
For that, consult the lectures and the online OCaml documentation.
We also refer you to the official OCaml cheat sheet which is
<a href="http://alhassy.com/OCamlCheatSheet/CheatSheet.pdf">here</a>.</p>
<p>Along the way, we will also sometimes mention non-syntactic aspects of OCaml
that are confusing to new OCaml programmers.</p>
<h2 id="operators">Operators</h2>
<h3 id="operator-underloading">Operator underloading</h3>
<p>OCaml doesn't overload most of its operators.
Notably, arithmetic operators like <code>+</code>, <code>-</code>, <code>*</code> and <code>/</code> are not overloaded.
Instead, they are considered to be exclusively integer operators.
The corresponding operators on floating-point numbers
have an extra dot (<code>.</code>) at the end <em>e.g.</em> <code>+.</code>, <code>-.</code>, <code>*.</code> and <code>/.</code>.
Confusingly, the floating-point power operator (<code>**</code>)
<em>doesn't</em> have a dot at the end.</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">sumsq</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*.</span> <span class="n">x</span> <span class="o">+.</span> <span class="n">y</span> <span class="o">*.</span> <span class="n">y</span><span class="o">;;</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">val</span> <span class="n">sumsq</span> <span class="o">:</span> <span class="kt">float</span> <span class="o">-&gt;</span> <span class="kt">float</span> <span class="o">-&gt;</span> <span class="kt">float</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>This is by far the most annoying aspect of OCaml's syntax.
The reason for it is so that every operator has a very specific type,
which makes type inference much simpler.</p>
<h3 id="operator-overloading">Operator overloading</h3>
<p>On the other hand, OCaml <em>does</em> overload some operators.
The comparison/equality operators (<code>=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>)
are all <em>polymorphic</em>,
which means they work on arbitrary OCaml datatypes.
(This is also true of the <code>max</code> and <code>min</code> functions.)
One exception: you are not allowed to compare functional values,
though you can check identity:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">#</span> <span class="n">abs</span><span class="o">;;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">#</span> <span class="n">abs</span> <span class="o">==</span> <span class="n">abs</span><span class="o">;;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">bool</span> <span class="o">=</span> <span class="bp">true</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="o">#</span> <span class="n">abs</span> <span class="o">=</span> <span class="n">abs</span><span class="o">;;</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="nc">Exception</span><span class="o">:</span> <span class="nc">Invalid_argument</span> <span class="s2">&quot;compare: functional value&quot;</span><span class="o">.</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="o">#</span> <span class="n">max</span> <span class="n">abs</span> <span class="n">abs</span><span class="o">;;</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="nc">Exception</span><span class="o">:</span> <span class="nc">Invalid_argument</span> <span class="s2">&quot;compare: functional value&quot;</span><span class="o">.</span>
</span></code></pre></div>
<p>We'll discuss equality comparisons and identity comparisons below.</p>
<h3 id="operators-as-functions">Operators as functions</h3>
<p>This is a good feature, but it can be confusing as well.
Operators can be converted into two-argument functions
by wrapping parentheses around them.
For instance, the operator <code>+</code>
can be made into the two-argument function <code>(+)</code>.</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">#</span> <span class="o">(+);;</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="o">#</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">;;</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="o">#</span> <span class="o">(+)</span> <span class="mi">2</span> <span class="mi">3</span><span class="o">;;</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">5</span>
</span></code></pre></div>
<p>The only time this causes problems
is with the multiplication operators (<code>*</code>) and (<code>*.</code>),
because if the left parenthesis is next to the asterisk
OCaml thinks it's the start of a comment:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a># (*);;
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>Line 1, characters 0-3:
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>1 | (*);;
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    ^^^
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>Warning 1: this `(*&#39; is the start of a comment.
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>Hint: Did you forget spaces when writing the infix operator `( * )&#39;?
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>* *);;
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a># ( * ) ;;
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>- : int -&gt; int -&gt; int = &lt;fun&gt;
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a># ( *);;
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>Line 1, characters 2-4:
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>1 | ( *);;
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>      ^^
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>Warning 2: this is not the end of a comment.
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>- : int -&gt; int -&gt; int = &lt;fun&gt;
</span></code></pre></div>
<p>(Notice that after the first error the prompt changed to <code>*</code>
(which means that OCaml thinks we're still inside a comment)
and we had to manually insert a <code>*)</code> to close the comment.)</p>
<p>Fortunately, here OCaml is smart enough
to catch this problem and issue a warning.
However, this doesn't always happen (see below).</p>
<h3 id="equalityinequality-operators">Equality/inequality operators</h3>
<p>OCaml has two different equality operators
and two different inequality operators:</p>
<ul>
<li>equality: <code>=</code> and <code>==</code></li>
<li>inequality: <code>&lt;&gt;</code> and <code>!=</code></li>
</ul>
<p>Almost always, you want to use the <code>=</code> operator for equality testing
and the <code>&lt;&gt;</code> operator for inequality testing.
They test for structural equality
<em>i.e.</em> whether one operand is equivalent to the other
(or "has the same contents").
The <code>==</code> and <code>!=</code> operators check for identity
<em>i.e.</em> whether two things are the <strong>exact same thing in memory</strong>.
Even though this may sometimes work,
it can lead to very difficult-to-find bugs.
(It's unfortunate that the operators you shouldn't use in OCaml
are the ones you <em>should</em> use in most other languages.)</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="o">#</span> <span class="s2">&quot;foo&quot;</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="o">;;</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">bool</span> <span class="o">=</span> <span class="bp">false</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="o">#</span> <span class="s2">&quot;foo&quot;</span> <span class="o">=</span> <span class="s2">&quot;foo&quot;</span><span class="o">;;</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">bool</span> <span class="o">=</span> <span class="bp">true</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="o">#</span> <span class="s2">&quot;foo&quot;</span> <span class="o">==</span> <span class="s2">&quot;foo&quot;</span><span class="o">;;</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">bool</span> <span class="o">=</span> <span class="bp">false</span>   <span class="c">(* not the same object in memory! *)</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="o">#</span> <span class="s2">&quot;foo&quot;</span> <span class="o">&lt;&gt;</span> <span class="s2">&quot;bar&quot;</span><span class="o">;;</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">bool</span> <span class="o">=</span> <span class="bp">true</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="o">#</span> <span class="s2">&quot;foo&quot;</span> <span class="o">!=</span> <span class="s2">&quot;bar&quot;</span><span class="o">;;</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">bool</span> <span class="o">=</span> <span class="bp">true</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="o">#</span> <span class="s2">&quot;foo&quot;</span> <span class="o">&lt;&gt;</span> <span class="s2">&quot;foo&quot;</span><span class="o">;;</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">bool</span> <span class="o">=</span> <span class="bp">false</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="o">#</span> <span class="s2">&quot;foo&quot;</span> <span class="o">!=</span> <span class="s2">&quot;foo&quot;</span><span class="o">;;</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">bool</span> <span class="o">=</span> <span class="bp">true</span>
</span></code></pre></div>
<p>Here, the two <code>"foo"</code>s are different objects in memory.</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;foo&quot;</span><span class="o">;;</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">val</span> <span class="n">x</span> <span class="o">:</span> <span class="kt">string</span> <span class="o">=</span> <span class="s2">&quot;foo&quot;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="o">#</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">;;</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">bool</span> <span class="o">=</span> <span class="bp">true</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="o">#</span> <span class="n">x</span> <span class="o">==</span> <span class="n">x</span><span class="o">;;</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">bool</span> <span class="o">=</span> <span class="bp">true</span>
</span></code></pre></div>
<p>Here, <code>x</code> is equal to itself and is also the same object in memory as itself.</p>
<h3 id="word-operators">Word operators</h3>
<p>OCaml has a number of infix operators which are words.
Here they are:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Operator</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>mod</code></td>
<td>integer remainder (modulus)</td>
</tr>
<tr>
<td style="text-align: center;"><code>asr</code></td>
<td>arithmetic shift right</td>
</tr>
<tr>
<td style="text-align: center;"><code>lsr</code></td>
<td>logical shift right</td>
</tr>
<tr>
<td style="text-align: center;"><code>lsl</code></td>
<td>logical shift left</td>
</tr>
<tr>
<td style="text-align: center;"><code>land</code></td>
<td>logical (bitwise) AND</td>
</tr>
<tr>
<td style="text-align: center;"><code>lor</code></td>
<td>logical (bitwise) OR</td>
</tr>
<tr>
<td style="text-align: center;"><code>lxor</code></td>
<td>logical (bitwise) XOR</td>
</tr>
<tr>
<td style="text-align: center;"><code>lnot</code></td>
<td>logical (bitwise) NOT</td>
</tr>
</tbody>
</table>
<p>You probably won't need any of these except the <code>mod</code> operator,
which is handy:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="o">#</span> <span class="mi">5</span> <span class="ow">mod</span> <span class="mi">2</span><span class="o">;;</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">1</span>
</span></code></pre></div>
<h3 id="unusual-operators">Unusual operators</h3>
<p>The built-in OCaml operators are described
in the documentation for the <code>Stdlib</code> library,
which is <a href="https://v2.ocaml.org/api/Stdlib.html">here</a>.</p>
<p>Note especially the following operators:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Operator</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>^</code></td>
<td>string concatenation</td>
</tr>
<tr>
<td style="text-align: center;"><code>^^</code></td>
<td>format string concatenation</td>
</tr>
<tr>
<td style="text-align: center;"><code>@</code></td>
<td>list concatenation</td>
</tr>
<tr>
<td style="text-align: center;"><code>~-</code></td>
<td>unary negation</td>
</tr>
<tr>
<td style="text-align: center;"><code>~-.</code></td>
<td>unary float negation</td>
</tr>
<tr>
<td style="text-align: center;"><code>@@</code></td>
<td>function application (<code>f @@ x</code> is the same as <code>f x</code>)</td>
</tr>
<tr>
<td style="text-align: center;"><code>|&gt;</code></td>
<td>reverse function application (<code>x |&gt; f</code> is the same as <code>f x</code>)</td>
</tr>
<tr>
<td style="text-align: center;"><code>!</code></td>
<td>dereference a <code>ref</code> cell</td>
</tr>
<tr>
<td style="text-align: center;"><code>:=</code></td>
<td>assignment into a <code>ref</code> cell</td>
</tr>
</tbody>
</table>
<p>Note that unary negation can also be indicated
by a <code>-</code> or <code>-.</code> operator without a left-hand operand,
if there is no ambiguity.
The <code>~-</code> and <code>~-.</code> operators are strictly unary operators
and can work in contexts where conventional unary negation doesn't:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a># -1;;
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>- : int = -1
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a># abs (-1);;
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>- : int = 1
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a># abs -1;;
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>Line 1, characters 0-3:
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>1 | abs -1;;
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>    ^^^
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>Error: This expression has type int -&gt; int
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>       but an expression was expected of type int
</span></code></pre></div>
<p>OCaml is telling you you can't subtract 1 from the <code>abs</code> function.</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="o">#</span> <span class="o">~-</span><span class="mi">1</span><span class="o">;;</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="o">#</span> <span class="n">abs</span> <span class="o">~-</span><span class="mi">1</span><span class="o">;;</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">1</span>
</span></code></pre></div>
<p>This works.
Here's another example where these operators are handy:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="o">#</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="o">(~-)</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">5</span><span class="o">];;</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[-</span><span class="mi">1</span><span class="o">;</span> <span class="o">-</span><span class="mi">2</span><span class="o">;</span> <span class="o">-</span><span class="mi">3</span><span class="o">;</span> <span class="o">-</span><span class="mi">4</span><span class="o">;</span> <span class="o">-</span><span class="mi">5</span><span class="o">]</span>
</span></code></pre></div>
<p>Nevertheless,
most people don't bother with the unary negation operators
and just add extra parentheses if needed.</p>
<p>The function application operators are interesting.
The reverse function application operator <code>|&gt;</code>
is nearly always used to chain together a series of computations,
each taking the result of the previous one:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="o">#</span> <span class="k">open</span> <span class="nc">List</span><span class="o">;;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="o">#</span> <span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">];;</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">2</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">6</span><span class="o">;</span> <span class="mi">8</span><span class="o">;</span> <span class="mi">10</span><span class="o">]</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="o">#</span> <span class="n">filter</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="o">)</span> <span class="o">(</span><span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">]);;</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">6</span><span class="o">;</span> <span class="mi">8</span><span class="o">;</span> <span class="mi">10</span><span class="o">]</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="o">#</span> <span class="nn">List</span><span class="p">.</span><span class="n">fold_left</span> <span class="n">max</span> <span class="mi">0</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>    <span class="o">(</span><span class="n">filter</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="o">)</span> <span class="o">(</span><span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">]));;</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="o">#</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">]</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>    <span class="o">|&gt;</span> <span class="n">map</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>    <span class="o">|&gt;</span> <span class="n">filter</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="o">)</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>    <span class="o">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">fold_left</span> <span class="n">max</span> <span class="mi">0</span><span class="o">;;</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">10</span>
</span></code></pre></div>
<p>I'd argue that the last expression
is much more readable than the second-last one.
You read it as "take the list from 1 to 5,
double all the numbers,
keep only the numbers that are greater than 5,
and find the maximum".
(You don't have to line up the <code>|&gt;</code> operators, but it looks good that way.)</p>
<p>The function call after a <code>|&gt;</code> gets one less argument than usual,
which is supplied by the result of evaluating the expression before the <code>|&gt;</code>.</p>
<p>The <code>@@</code> operator might seem useless
since <code>f @@ x</code> is the same as <code>f x</code>.
However, its precedence is extremely low,
so the expression to the right of the <code>@@</code>
will be evaluated before calling the function.
This can allow us to drop some parentheses:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="o">#</span> <span class="n">abs</span> <span class="o">(-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);;</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="o">#</span> <span class="n">abs</span> <span class="o">@@</span> <span class="o">(-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);;</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="o">#</span> <span class="n">abs</span> <span class="o">@@</span> <span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;;</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">1</span>
</span></code></pre></div>
<p>Note that the expression <code>-2 + 1</code>
is evaluated in the last case before calling the <code>abs</code> function.
This can be useful if you have a lot of functions
acting on the result of other functions.
(Note that this is just like the <code>|&gt;</code> operator
except that the function calls
are arranged right-to-left instead of left-to-right.)
Another example:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="o">#</span> <span class="nn">List</span><span class="p">.</span><span class="n">rev</span> <span class="o">(</span><span class="nn">List</span><span class="p">.</span><span class="n">sort</span> <span class="n">compare</span> <span class="o">[</span><span class="mi">4</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">5</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">7</span><span class="o">;</span><span class="mi">5</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">9</span><span class="o">;</span><span class="mi">0</span><span class="o">]);;</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">9</span><span class="o">;</span> <span class="mi">7</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">1</span><span class="o">;</span> <span class="mi">0</span><span class="o">]</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="o">#</span> <span class="nn">List</span><span class="p">.</span><span class="n">rev</span> <span class="o">@@</span> <span class="nn">List</span><span class="p">.</span><span class="n">sort</span> <span class="n">compare</span> <span class="o">[</span><span class="mi">4</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">5</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">7</span><span class="o">;</span><span class="mi">5</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">1</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">9</span><span class="o">;</span><span class="mi">0</span><span class="o">];;</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">9</span><span class="o">;</span> <span class="mi">7</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">1</span><span class="o">;</span> <span class="mi">0</span><span class="o">]</span>
</span></code></pre></div>
<p>One of the least-used operators is the <code>^^</code> operator,
which concatenates strings used as format strings.
We will talk about this below.</p>
<p>Note that some libraries define their own operators (see below).
For instance, the <code>Num</code> library defines operators on rational numbers:
<code>+/</code>, <code>-/</code>, <code>*/</code>, and <code>//</code>.
(These also work with arbitrary-precision integers,
since the <code>Num</code> data type contains both these
and arbitrary-precision rationals.)</p>
<h3 id="defining-new-operators">Defining new operators</h3>
<p>Unusually for programming languages,
OCaml allows you to define your own operators.
All user-defined operators must be made from "operator characters"
and get their operator precedence and associativity
from the first character of the operator (if it is itself an operator).</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="o">#</span> <span class="k">let</span> <span class="o">(++)</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="o">;;</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="k">val</span> <span class="o">(</span> <span class="o">++</span> <span class="o">)</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="o">#</span> <span class="mi">2</span> <span class="o">++</span> <span class="mi">3</span><span class="o">;;</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">6</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="o">#</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">++</span> <span class="mi">3</span><span class="o">;;</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">9</span>
</span></code></pre></div>
<p>Note that the <code>++</code> operator has the same precedence as the <code>+</code> operator,
so the expression <code>1 + 2 ++ 3</code> is evaluated from left to right.
Let's try this with a new operator that starts with the <code>*</code> character instead:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a># let (*+) x y = x * y;;
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>* *);;
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>Line 2, characters 2-4:
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>2 | *);;
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>      ^^
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>Error: Syntax error
</span></code></pre></div>
<p>Oops! We forgot that the <code>(*</code> characters
will be interpreted as the start of a comment.
Notice that we didn't even get an error message;
the prompt just turned to a <code>*</code>
(indicating that OCaml thought we were still in a comment).
When we added the <code>*)</code> to terminate the comment,
we got an unhelpful error message.</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="o">#</span> <span class="k">let</span> <span class="o">(</span> <span class="o">*+</span> <span class="o">)</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="o">;;</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="k">val</span> <span class="o">(</span> <span class="o">*+</span> <span class="o">)</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="o">#</span> <span class="mi">2</span> <span class="o">*+</span> <span class="mi">3</span><span class="o">;;</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">6</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="o">#</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*+</span> <span class="mi">3</span><span class="o">;;</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">7</span>
</span></code></pre></div>
<p>Now we see that the <code>*+</code> operator
has the same precedence as the <code>*</code> operator.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When defining new operators,
it's always a good idea to put a blank space
after the <code>(</code> and before the <code>)</code> characters that surround the operator.</p>
</div>
<p>You can even define unary prefix operators,
as long as they start with the <code>!</code> character:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="o">#</span> <span class="k">let</span> <span class="o">(</span> <span class="o">!++</span> <span class="o">)</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">:=</span> <span class="o">!</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;;</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="k">val</span> <span class="o">(</span> <span class="o">!++</span> <span class="o">)</span> <span class="o">:</span> <span class="kt">int</span> <span class="n">ref</span> <span class="o">-&gt;</span> <span class="kt">unit</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="o">#</span> <span class="k">let</span> <span class="n">r</span> <span class="o">=</span> <span class="n">ref</span> <span class="mi">0</span><span class="o">;;</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="k">val</span> <span class="n">r</span> <span class="o">:</span> <span class="kt">int</span> <span class="n">ref</span> <span class="o">=</span> <span class="o">{</span><span class="n">contents</span> <span class="o">=</span> <span class="mi">0</span><span class="o">}</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="o">#</span> <span class="o">!++</span> <span class="n">r</span><span class="o">;;</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="o">#</span> <span class="o">!</span><span class="n">r</span><span class="o">;;</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">1</span>
</span></code></pre></div>
<p>We will have more to say about <code>ref</code> types below.</p>
<h3 id="printf-and-format-strings"><code>printf</code> and format strings</h3>
<p>OCaml has a <code>printf</code> function (technically, <code>Printf.printf</code>)
which has a number of pecularities. Check this out:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="o">#</span> <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span><span class="o">;;</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="o">-</span> <span class="o">:</span> <span class="o">(</span><span class="k">&#39;</span><span class="n">a</span><span class="o">,</span> <span class="n">out_channel</span><span class="o">,</span> <span class="kt">unit</span><span class="o">)</span> <span class="n">format</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">a</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="o">#</span> <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">;;</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">unit</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="o">#</span> <span class="s2">&quot;%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">;;</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">string</span> <span class="o">=</span> <span class="s2">&quot;%d</span><span class="se">\n</span><span class="s2">&quot;</span>
</span></code></pre></div>
<p>So even though <code>"%d\n"</code> appears to be just a string,
somehow it can also be the first argument of <code>Printf.printf</code>,
where it is somehow compatible with the type <code>('a, out_channel, unit) format</code>.
What is actually happening is that OCaml is turning a <em>literal</em> string
into a something that does <em>not</em> have the <code>string</code> type,
but is instead something called a <em>format string</em>.
You can actually convert strings to format strings manually,
but do not expect to understand the process:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="o">#</span> <span class="n">format_of_string</span><span class="o">;;</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="o">-</span> <span class="o">:</span> <span class="o">(</span><span class="k">&#39;</span><span class="n">a</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">b</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">c</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">d</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">e</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">f</span><span class="o">)</span> <span class="n">format6</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="k">&#39;</span><span class="n">a</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">b</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">c</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">d</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">e</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">f</span><span class="o">)</span> <span class="n">format6</span> <span class="o">=</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="o">#</span> <span class="k">let</span> <span class="n">fs</span> <span class="o">=</span> <span class="n">format_of_string</span> <span class="s2">&quot;%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">;;</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="k">val</span> <span class="n">fs</span> <span class="o">:</span> <span class="o">(</span><span class="kt">int</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak1</span><span class="o">,</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak2</span><span class="o">,</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak3</span><span class="o">,</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak4</span><span class="o">,</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak4</span><span class="o">,</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak1</span><span class="o">)</span> <span class="n">format6</span> <span class="o">=</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>  <span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">Format</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>   <span class="o">(</span><span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">Int</span> <span class="o">(</span><span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">Int_d</span><span class="o">,</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>     <span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">No_padding</span><span class="o">,</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>     <span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">No_precision</span><span class="o">,</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>     <span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">Char_literal</span> <span class="o">(</span><span class="sc">&#39;\n&#39;</span><span class="o">,</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>      <span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">End_of_format</span><span class="o">)),</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>   <span class="s2">&quot;%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">)</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="o">#</span> <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="n">fs</span><span class="o">;;</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">unit</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="o">#</span> <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="n">fs</span> <span class="mi">10</span><span class="o">;;</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="mi">10</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Another peculiarity is that <code>format_of_string</code> only works
when the string argument is a literal string;
its first argument is not actually a string.
Don't worry about any of this!</p>
</div>
<p>Regardless of the weird types that format strings have,
when you give a (literal) format string
as the first argument of <code>Printf.printf</code>,
the result will have the correct type
(here, <code>int -&gt; unit</code> because it takes an <code>int</code>
and returns a value of type <code>unit</code>).</p>
<p>Since format strings aren't strings, this doesn't work:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a># let fs = &quot;%d\n&quot;;;
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>val fs : string = &quot;%d\n&quot;
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a># Printf.printf fs 10;;
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>Line 1, characters 14-16:
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>1 | Printf.printf fs 10;;
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>                  ^^
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>Error: The value fs has type string but an expression was expected of type
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>         (&#39;a -&gt; &#39;b, out_channel, unit) format =
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>           (&#39;a -&gt; &#39;b, out_channel, unit, unit, unit, unit) format6
</span></code></pre></div>
<p>One issue with format strings is that
sometimes you would like to be able to divide them over multiple lines.
However, you can't just concatenate them as if they were strings:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a># Printf.printf (&quot;int: %d\t&quot; ^ &quot;string: %s\n&quot;) 10 &quot;foo&quot;;;
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>Line 1, characters 14-44:
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>1 | Printf.printf (&quot;int: %d\t&quot; ^ &quot;string: %s\n&quot;) 10 &quot;foo&quot;;;
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>Error: This expression has type string but an expression was expected of type
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>         (&#39;a -&gt; &#39;b -&gt; &#39;c, out_channel, unit) format =
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>           (&#39;a -&gt; &#39;b -&gt; &#39;c, out_channel, unit, unit, unit, unit) format6
</span></code></pre></div>
<p>Instead, you have to use the special
<em>format string concatenation operator</em> <code>(^^)</code> to do the job:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="o">#</span> <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="o">(</span><span class="s2">&quot;int: %d</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">^^</span> <span class="s2">&quot;string: %s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">)</span> <span class="mi">10</span> <span class="s2">&quot;foo&quot;</span><span class="o">;;</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="kt">int</span><span class="o">:</span> <span class="mi">10</span> <span class="kt">string</span><span class="o">:</span> <span class="n">foo</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="o">#</span> <span class="o">(^^)</span> <span class="o">;;</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="o">-</span> <span class="o">:</span> <span class="o">(</span><span class="k">&#39;</span><span class="n">a</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">b</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">c</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">d</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">e</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">f</span><span class="o">)</span> <span class="n">format6</span> <span class="o">-&gt;</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>    <span class="o">(</span><span class="k">&#39;</span><span class="n">f</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">b</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">c</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">e</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">g</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">h</span><span class="o">)</span> <span class="n">format6</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="k">&#39;</span><span class="n">a</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">b</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">c</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">d</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">g</span><span class="o">,</span> <span class="k">&#39;</span><span class="n">h</span><span class="o">)</span> <span class="n">format6</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="o">#</span> <span class="s2">&quot;int: %d</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">^^</span> <span class="s2">&quot;string: %s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">;;</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="o">-</span> <span class="o">:</span> <span class="o">(</span><span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">string</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak9</span><span class="o">,</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak10</span><span class="o">,</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak11</span><span class="o">,</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak12</span><span class="o">,</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak12</span><span class="o">,</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>     <span class="k">&#39;</span><span class="o">_</span><span class="n">weak9</span><span class="o">)</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>    <span class="n">format6</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="o">=</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">Format</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a> <span class="o">(</span><span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">String_literal</span> <span class="o">(</span><span class="s2">&quot;int: &quot;</span><span class="o">,</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>   <span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">Int</span> <span class="o">(</span><span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">Int_d</span><span class="o">,</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>    <span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">No_padding</span><span class="o">,</span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a>    <span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">No_precision</span><span class="o">,</span>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a>    <span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">Char_literal</span> <span class="o">(</span><span class="sc">&#39;\t&#39;</span><span class="o">,</span>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>     <span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">String_literal</span> <span class="o">(</span><span class="s2">&quot;string: &quot;</span><span class="o">,</span>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a>      <span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">String</span> <span class="o">(</span><span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">No_padding</span><span class="o">,</span>
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a>       <span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">Char_literal</span> <span class="o">(</span><span class="sc">&#39;\n&#39;</span><span class="o">,</span>
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a>        <span class="nn">CamlinternalFormatBasics</span><span class="p">.</span><span class="nc">End_of_format</span><span class="o">)))))),</span>
</span><span id="__span-21-23"><a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a> <span class="s2">&quot;int: %d</span><span class="se">\t</span><span class="s2">%,string: %s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">)</span>
</span></code></pre></div>
<p>Fortunately, you probably won't need this operator.</p>
<h2 id="lists">Lists</h2>
<p>There are three important things you need to remember about lists in OCaml:</p>
<ol>
<li>All the elements of a list must be of the same type.</li>
<li>You can't change the elements of a list.</li>
<li>Elements are separated with semicolons (<code>;</code>), not commas.</li>
</ol>
<p>A very common pitfall is to use commas instead of semicolons,
which not only doesn't do what you expect,
but sometimes seems to work only to fail later
while giving hilariously obscure type errors.
We will see why in the section on tuples below.
Remember: OCaml's syntax is different from Python's!</p>
<p>There is a <a href="https://v2.ocaml.org/api/List.html">List</a> module
with many useful functions on lists.</p>
<h2 id="arrays">Arrays</h2>
<p>Syntactically, arrays are exactly like lists
except that they use different delimiters.
Instead of <code>[</code> and <code>]</code> arrays use <code>[|</code> and <code>|]</code>.
Here is a literal array:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">my_array</span> <span class="o">=</span> <span class="o">[|</span> <span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span> <span class="o">|];;</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="k">val</span> <span class="n">my_array</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">array</span> <span class="o">=</span> <span class="o">[|</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">|]</span>
</span></code></pre></div>
<p>Notice that the array has type <code>int array</code>;
the type of the elements is part of the type of the array.</p>
<p>Accessing elements from arrays uses the unusual <code>&lt;array&gt;.(&lt;index&gt;)</code> syntax:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="o">#</span> <span class="n">my_array</span><span class="o">.(</span><span class="mi">0</span><span class="o">);;</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="o">#</span> <span class="n">my_array</span><span class="o">.(</span><span class="mi">4</span><span class="o">);;</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="o">#</span> <span class="n">my_array</span><span class="o">.(</span><span class="mi">5</span><span class="o">);;</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="nc">Exception</span><span class="o">:</span> <span class="nc">Invalid_argument</span> <span class="s2">&quot;index out of bounds&quot;</span><span class="o">.</span>
</span></code></pre></div>
<p>Mutating (changing) elements in an array also uses an unusual syntax:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="o">#</span> <span class="n">my_array</span><span class="o">;;</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">array</span> <span class="o">=</span> <span class="o">[|</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">|]</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="o">#</span> <span class="n">my_array</span><span class="o">.(</span><span class="mi">0</span><span class="o">)</span> <span class="o">&lt;-</span> <span class="mi">42</span><span class="o">;;</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="o">#</span> <span class="n">my_array</span><span class="o">;;</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">array</span> <span class="o">=</span> <span class="o">[|</span><span class="mi">42</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">|]</span>
</span></code></pre></div>
<p>There is an <a href="https://v2.ocaml.org/api/Array.html">Array</a> module
with many useful functions on arrays.</p>
<h2 id="tuples">Tuples</h2>
<p>A fundamental data type in OCaml is the <em>tuple</em>
(pronounced "too-ple" or "tup-ple" depending on your preference;
I prefer "too-ple").
It is nothing more than a sequence of arbitrary OCaml values
wrapped in parentheses, separated by commas.
Tuples can (and usually do) contain data of different types.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Tuples exist in Python too,
but in that language they are almost superfluous,
being basically a restricted form of lists.
In OCaml, tuples are necessary
because lists can only contain one type of data,
whereas tuples can contain arbitrarily-typed data.</p>
</div>
<h3 id="type-notation">Type notation</h3>
<p>The notation for tuple types is a bit weird;
they are written as the <em>product</em> of the individual types:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="o">#</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s2">&quot;foo&quot;</span><span class="o">,</span> <span class="mi">3</span><span class="o">.</span><span class="mi">14</span><span class="o">);;</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">string</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">=</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s2">&quot;foo&quot;</span><span class="o">,</span> <span class="mi">3</span><span class="o">.</span><span class="mi">14</span><span class="o">)</span>
</span></code></pre></div>
<p>This tuple has the type <code>int * string * float</code>,
which is a type-theoretic "product" of the individual types.
This notion of "product" is basically the same as the set-theoretic notion,
but don't worry about that.
Just make sure you realize that this use of the <code>*</code> operator
doesn't represent multiplication.</p>
<h3 id="implicit-parentheses">Implicit parentheses</h3>
<p>Unfortunately, OCaml (like Python)
allows you to omit the parentheses in many situations:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="o">#</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s2">&quot;foo&quot;</span><span class="o">,</span> <span class="mi">3</span><span class="o">.</span><span class="mi">14</span><span class="o">);;</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">string</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">=</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s2">&quot;foo&quot;</span><span class="o">,</span> <span class="mi">3</span><span class="o">.</span><span class="mi">14</span><span class="o">)</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="o">#</span> <span class="mi">1</span><span class="o">,</span> <span class="s2">&quot;foo&quot;</span><span class="o">,</span> <span class="mi">3</span><span class="o">.</span><span class="mi">14</span><span class="o">;;</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">string</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">=</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s2">&quot;foo&quot;</span><span class="o">,</span> <span class="mi">3</span><span class="o">.</span><span class="mi">14</span><span class="o">)</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="o">#</span> <span class="k">let</span> <span class="n">tup</span> <span class="o">=</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s2">&quot;foo&quot;</span><span class="o">,</span> <span class="mi">3</span><span class="o">.</span><span class="mi">14</span><span class="o">);;</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="k">val</span> <span class="n">tup</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">string</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">=</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s2">&quot;foo&quot;</span><span class="o">,</span> <span class="mi">3</span><span class="o">.</span><span class="mi">14</span><span class="o">)</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="o">#</span> <span class="k">let</span> <span class="n">tup</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="s2">&quot;foo&quot;</span><span class="o">,</span> <span class="mi">3</span><span class="o">.</span><span class="mi">14</span><span class="o">;;</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="k">val</span> <span class="n">tup</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">string</span> <span class="o">*</span> <span class="kt">float</span> <span class="o">=</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s2">&quot;foo&quot;</span><span class="o">,</span> <span class="mi">3</span><span class="o">.</span><span class="mi">14</span><span class="o">)</span>
</span></code></pre></div>
<p>"So what?", you say. "What's the big deal?"
Well, look at this code:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="o">#</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">];;</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">]</span>
</span></code></pre></div>
<p>This is the correct way to write a list, using semicolons as separators.
A common error is to write lists with commas, which gives this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="o">#</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">];;</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="o">-</span> <span class="o">:</span> <span class="o">(</span><span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span><span class="o">)</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)]</span>
</span></code></pre></div>
<p>Note that this is <em>not</em> a syntax error!
Instead, OCaml has interepreted the commas as meaning a tuple,
so it thinks you want a list with a single element which is a 3-tuple.
Then, when you try to use this list, it will not do what you expect,
and the error messages will probably not be very helpful.</p>
<p>We recommend that you <em>never</em> write a tuple without explicit parentheses.
However, this will not fix the problem above,
because OCaml will still interpret the wrongly-written "list"
as a list of N-tuples.
Ultimately,
you just have to be able to recognize this problem for what it is,
and learn to write lists the right way.</p>
<h3 id="commas-vs-semicolons">Commas <em>vs.</em> semicolons</h3>
<p>What about the opposite problem:
writing a tuple with semicolons as separators instead of using commas?</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a># (1, &quot;foo&quot;, 3.14);;
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>- : int * string * float = (1, &quot;foo&quot;, 3.14)
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a># (1; &quot;foo&quot;; 3.14);;
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>Line 1, characters 1-2:
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>1 | (1; &quot;foo&quot;; 3.14);;
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>     ^
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>Warning 10: this expression should have type unit.
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>Line 1, characters 4-9:
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>1 | (1; &quot;foo&quot;; 3.14);;
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>        ^^^^^
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a>Warning 10: this expression should have type unit.
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a>- : float = 3.14
</span></code></pre></div>
<p>A parenthesized expression with semicolon separators
is a <em>sequence expression</em>,
which is mainly used in imperative code.
(You can also write them with <code>begin</code>/<code>end</code> delimiters instead of parentheses,
which we prefer.)
In a sequence expression,
all but the last subexpression should have type <code>unit</code>,
or you get warnings (as you see above).
You probably won't run into this pitfall, but you should be aware of it.
We will talk about sequence expressions more below
when we discuss imperative programming.</p>
<h2 id="records">Records</h2>
<p>Records are basically a generalization of tuples
where each component of the record has a name
(called a "field name", so each component is a "field" of the record).
You need to define a record type before using a record.</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="k">type</span> <span class="n">my_record</span> <span class="o">=</span> <span class="o">{</span> <span class="n">foo</span> <span class="o">:</span> <span class="kt">int</span><span class="o">;</span> <span class="n">bar</span> <span class="o">:</span> <span class="kt">string</span> <span class="o">}</span>
</span></code></pre></div>
<p>Then you can create records
by giving the field names and the values like this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="k">let</span> <span class="n">a_record</span> <span class="o">=</span> <span class="o">{</span> <span class="n">foo</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span> <span class="n">bar</span> <span class="o">=</span> <span class="s2">&quot;ten&quot;</span> <span class="o">}</span>
</span></code></pre></div>
<p>You can extract the contents of a record using the "dot notation"
as in most programming languages:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;foo field: %d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="n">a_record</span><span class="o">.</span><span class="n">foo</span>
</span></code></pre></div>
<h3 id="pattern-matching-and-field-punning">Pattern matching and field punning</h3>
<p>To pattern match on a record,
you give the field names and corresponding variable names that you choose.</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="k">type</span> <span class="n">point</span> <span class="o">=</span> <span class="o">{</span> <span class="n">x</span> <span class="o">:</span> <span class="kt">int</span><span class="o">;</span> <span class="n">y</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">}</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="k">let</span> <span class="n">sum_xy</span> <span class="o">{</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x_coord</span><span class="o">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y_coord</span> <span class="o">}</span> <span class="o">=</span> <span class="n">x_coord</span> <span class="o">+</span> <span class="n">y_coord</span>
</span></code></pre></div>
<p>Note that <code>x</code> and <code>y</code> are field names here,
and <code>x_coord</code> and <code>y_coord</code> are variable names you chose for this function.</p>
<p>Note that the field names don't have to come in any particular order:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="k">type</span> <span class="n">point</span> <span class="o">=</span> <span class="o">{</span> <span class="n">x</span> <span class="o">:</span> <span class="kt">int</span><span class="o">;</span> <span class="n">y</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">}</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="k">let</span> <span class="n">sum_xy</span> <span class="o">{</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y_coord</span><span class="o">;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x_coord</span> <span class="o">}</span> <span class="o">=</span> <span class="n">x_coord</span> <span class="o">+</span> <span class="n">y_coord</span>
</span></code></pre></div>
<p>A shortcut is to use the field name as a variable name.
This is called <em>field punning</em>.</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="k">type</span> <span class="n">point</span> <span class="o">=</span> <span class="o">{</span> <span class="n">x</span> <span class="o">:</span> <span class="kt">int</span><span class="o">;</span> <span class="n">y</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">}</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="k">let</span> <span class="n">sum_xy</span> <span class="o">{</span> <span class="n">x</span><span class="o">;</span> <span class="n">y</span> <span class="o">}</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="c">(* Also OK: let sum_xy { y; x } = x + y *)</span>
</span></code></pre></div>
<p>This is exactly equivalent to:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="k">type</span> <span class="n">point</span> <span class="o">=</span> <span class="o">{</span> <span class="n">x</span> <span class="o">:</span> <span class="kt">int</span><span class="o">;</span> <span class="n">y</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">}</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="k">let</span> <span class="n">sum_xy</span> <span class="o">{</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">}</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</span></code></pre></div>
<p>but shorter.</p>
<h3 id="matching-a-part-of-a-record">Matching a part of a record</h3>
<p>Often, we only need part of a record.
You could write code like this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="k">type</span> <span class="n">point</span> <span class="o">=</span> <span class="o">{</span> <span class="n">x</span> <span class="o">:</span> <span class="kt">int</span><span class="o">;</span> <span class="n">y</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">}</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="k">let</span> <span class="n">point_x</span> <span class="o">{</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x_coord</span><span class="o">;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y_coord</span> <span class="o">}</span> <span class="o">=</span> <span class="n">x_coord</span>
</span></code></pre></div>
<p>but you might get a warning about unused variable names.
The solution is to use the <code>_</code> syntax:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="k">type</span> <span class="n">point</span> <span class="o">=</span> <span class="o">{</span> <span class="n">x</span> <span class="o">:</span> <span class="kt">int</span><span class="o">;</span> <span class="n">y</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">}</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="k">let</span> <span class="n">point_x</span> <span class="o">{</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x_coord</span><span class="o">;</span> <span class="o">_</span> <span class="o">}</span> <span class="o">=</span> <span class="n">x_coord</span>
</span></code></pre></div>
<p>The <code>_</code> means "all other fields in the record, which we don't care about".</p>
<p>With field punning, this becomes:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="k">type</span> <span class="n">point</span> <span class="o">=</span> <span class="o">{</span> <span class="n">x</span> <span class="o">:</span> <span class="kt">int</span><span class="o">;</span> <span class="n">y</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">}</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="k">let</span> <span class="n">point_x</span> <span class="o">{</span> <span class="n">x</span><span class="o">;</span> <span class="o">_</span> <span class="o">}</span> <span class="o">=</span> <span class="n">x</span>
</span></code></pre></div>
<h2 id="strings">Strings</h2>
<p>Strings are pretty standard in OCaml,
except that the notation for accessing characters in a string is weird:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;this is a string&quot;</span><span class="o">;;</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="k">val</span> <span class="n">s</span> <span class="o">:</span> <span class="kt">string</span> <span class="o">=</span> <span class="s2">&quot;this is a string&quot;</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="o">#</span> <span class="n">s</span><span class="o">.[</span><span class="mi">0</span><span class="o">];;</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">char</span> <span class="o">=</span> <span class="sc">&#39;t&#39;</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="o">#</span> <span class="n">s</span><span class="o">.[</span><span class="mi">9</span><span class="o">];;</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">char</span> <span class="o">=</span> <span class="sc">&#39; &#39;</span>
</span></code></pre></div>
<p>OCaml treats strings like a kind of specialized array.
Strings are immutable.
(There is a mutable string type called <code>bytes</code>
if you really need that.)</p>
<h2 id="conditionals">Conditionals</h2>
<h3 id="if-expressions"><code>if</code> expressions</h3>
<p>In most programming languages, <code>if</code> is a statement,
but in functional languages like OCaml, <code>if</code> is an expression.
This means that an <code>if</code> expression returns a value.
This is nice in that you can use <code>if</code> expressions
anywhere an expression is desired.
For instance, this function computes the ratio
of the maximum and minimum of two floats:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="k">let</span> <span class="n">scale</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="o">(</span><span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span> <span class="k">then</span> <span class="n">x</span> <span class="k">else</span> <span class="n">y</span><span class="o">)</span> <span class="o">/.</span> <span class="o">(</span><span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span> <span class="k">then</span> <span class="n">y</span> <span class="k">else</span> <span class="n">x</span><span class="o">)</span>
</span></code></pre></div>
<p>(Note the <code>/.</code> operator for float division.)
This is not the most elegant way to write this function,
but it illustrates that <code>if</code> expressions
can be embedded in larger expressions.</p>
<p>Since <code>if</code> is an expression,
<code>if</code> expressions must have a specific type
regardless of whether the test clause of the <code>if</code>
returns <code>true</code> or <code>false</code>.
Therefore, both branches of the <code>if</code>
(the <code>then</code> branch and the <code>else</code> branch)
must be expressions which have the exact same type.
Something like this is not legal:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a># let a = 10;;
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>val a : int = 10
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a># let b = 20;;
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>val b : int = 20
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a># if a &gt; b then &quot;success&quot; else 0;;
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a>Line 1, characters 29-30:
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a>1 | if a &gt; b then &quot;success&quot; else 0;;
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a>                                 ^
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a>Error: This expression has type int but an expression was expected of type
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a>         string
</span></code></pre></div>
<p>This is easy to understand,
but things are not always so clear, as we will see.</p>
<h3 id="if-without-else"><code>if</code> without <code>else</code></h3>
<p>OCaml allows you to have an <code>if</code> expression without an <code>else</code> clause,
but if you do that, the <code>then</code> clause <em>must</em> have type <code>unit</code>.</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;;</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="k">val</span> <span class="n">a</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="o">#</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="k">then</span> <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;big!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">;;</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="n">big</span><span class="o">!</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span></code></pre></div>
<p>This works because <code>printf</code> has a return type of <code>unit</code>.
But this won't work:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a># let b = if a &gt; 5 then 10;;
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>Line 1, characters 22-24:
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>1 | let b = if a &gt; 5 then 10;;
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>                          ^^
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>Error: This expression has type int but an expression was expected of type
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a>         unit
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>       because it is in the result of a conditional with no else branch
</span></code></pre></div>
<p>Both branches of a conditional must have the same type,
and if you leave out the <code>else</code> branch, its type is assumed to be <code>unit</code>.
In other words, <code>if</code> without <code>else</code> is desugared as follows.
This:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="k">if</span> <span class="o">&lt;</span><span class="n">bool_expr</span><span class="o">&gt;</span> <span class="k">then</span> <span class="o">&lt;</span><span class="n">then_expr</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>is equivalent to this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="k">if</span> <span class="o">&lt;</span><span class="n">bool_expr</span><span class="o">&gt;</span> <span class="k">then</span> <span class="o">&lt;</span><span class="n">then_expr</span><span class="o">&gt;</span> <span class="k">else</span> <span class="bp">()</span>
</span></code></pre></div>
<p>When you think about it, this makes perfect sense.
Normally you would only want to do an <code>if</code>-without-<code>else</code>
if you are writing imperative code in the <code>then</code> clause (see below).</p>
<h3 id="else-if"><code>else if</code></h3>
<p>Technically, OCaml doesn't have an <code>else if</code> construct.
However, if you're careful you can use it anyway:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">abs</span> <span class="n">x</span> <span class="o">=</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>  <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>    <span class="o">-</span><span class="n">x</span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>  <span class="k">else</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a>    <span class="n">x</span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a>  <span class="k">else</span> <span class="mi">0</span><span class="o">;;</span>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a><span class="k">val</span> <span class="n">abs</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>What's actually happening is that there are two <em>nested</em> <code>if</code> expressions:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">abs</span> <span class="n">x</span> <span class="o">=</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>  <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>    <span class="o">-</span><span class="n">x</span>
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>  <span class="k">else</span>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a>    <span class="o">(</span><span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>       <span class="n">x</span>
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a>     <span class="k">else</span> <span class="mi">0</span><span class="o">);;</span>
</span></code></pre></div>
<p>As long as you can write your code
as a sequence of nested <code>if</code> expressions like this,
it will work as you expect.
But if you put something more complicated
in one of the <code>then</code> or <code>else</code> clauses
(like another <code>if</code> expression)
you may have to wrap parentheses
or a <code>begin</code>/<code>end</code> pair around the inner expression:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">test</span> <span class="n">n</span> <span class="o">=</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>    <span class="k">if</span> <span class="n">n</span> <span class="ow">mod</span> <span class="mi">5</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>      <span class="k">if</span> <span class="n">n</span> <span class="ow">mod</span> <span class="mi">3</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a>        <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;inner if</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a>    <span class="c">(* no else! *)</span>
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a>    <span class="k">else</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">mod</span> <span class="mi">3</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-49-7"><a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a>      <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;outer if 1</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-49-8"><a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a>    <span class="k">else</span>
</span><span id="__span-49-9"><a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a>      <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;outer if 2</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-49-10"><a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a>  <span class="o">;;</span>
</span><span id="__span-49-11"><a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a><span class="k">val</span> <span class="n">test</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">unit</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-49-12"><a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a><span class="o">#</span> <span class="n">test</span> <span class="mi">15</span><span class="o">;;</span>
</span><span id="__span-49-13"><a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a><span class="n">inner</span> <span class="k">if</span>
</span><span id="__span-49-14"><a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span><span id="__span-49-15"><a id="__codelineno-49-15" name="__codelineno-49-15" href="#__codelineno-49-15"></a><span class="o">#</span> <span class="n">test</span> <span class="mi">9</span><span class="o">;;</span>
</span><span id="__span-49-16"><a id="__codelineno-49-16" name="__codelineno-49-16" href="#__codelineno-49-16"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span></code></pre></div>
<p>Note that <code>test 9</code> doesn't print anything,
though we might expect it to print <code>"outer if 1"</code>.
The code above is parsed as follows:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">test</span> <span class="n">n</span> <span class="o">=</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>    <span class="k">if</span> <span class="n">n</span> <span class="ow">mod</span> <span class="mi">5</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>      <span class="o">(</span><span class="k">if</span> <span class="n">n</span> <span class="ow">mod</span> <span class="mi">3</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>        <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;inner if</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>       <span class="k">else</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">mod</span> <span class="mi">3</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>         <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;outer if 1</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>       <span class="k">else</span>
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a>         <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;outer if 2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">)</span>
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a>  <span class="o">;;</span>
</span></code></pre></div>
<p>which is probably not what was intended.
To fix it, insert either parentheses
or a <code>begin</code>/<code>end</code> pair to disambiguate it:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">test</span> <span class="n">n</span> <span class="o">=</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>    <span class="k">if</span> <span class="n">n</span> <span class="ow">mod</span> <span class="mi">5</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>      <span class="o">(</span><span class="k">if</span> <span class="n">n</span> <span class="ow">mod</span> <span class="mi">3</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a>        <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;inner if</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">)</span>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a>    <span class="k">else</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">mod</span> <span class="mi">3</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a>      <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;outer if 1</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a>    <span class="k">else</span>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a>      <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;outer if 2</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a>  <span class="o">;;</span>
</span><span id="__span-51-10"><a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a><span class="k">val</span> <span class="n">test</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">unit</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-51-11"><a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a><span class="o">#</span> <span class="n">test</span> <span class="mi">15</span><span class="o">;;</span>
</span><span id="__span-51-12"><a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a><span class="n">inner</span> <span class="k">if</span>
</span><span id="__span-51-13"><a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span><span id="__span-51-14"><a id="__codelineno-51-14" name="__codelineno-51-14" href="#__codelineno-51-14"></a><span class="o">#</span> <span class="n">test</span> <span class="mi">9</span><span class="o">;;</span>
</span><span id="__span-51-15"><a id="__codelineno-51-15" name="__codelineno-51-15" href="#__codelineno-51-15"></a><span class="n">outer</span> <span class="k">if</span> <span class="mi">1</span>
</span><span id="__span-51-16"><a id="__codelineno-51-16" name="__codelineno-51-16" href="#__codelineno-51-16"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span><span id="__span-51-17"><a id="__codelineno-51-17" name="__codelineno-51-17" href="#__codelineno-51-17"></a><span class="o">#</span> <span class="n">test</span> <span class="mi">8</span><span class="o">;;</span>
</span><span id="__span-51-18"><a id="__codelineno-51-18" name="__codelineno-51-18" href="#__codelineno-51-18"></a><span class="n">outer</span> <span class="k">if</span> <span class="mi">2</span>
</span><span id="__span-51-19"><a id="__codelineno-51-19" name="__codelineno-51-19" href="#__codelineno-51-19"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span></code></pre></div>
<p>With <code>begin</code>/<code>end</code> it looks like this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">test</span> <span class="n">n</span> <span class="o">=</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>    <span class="k">if</span> <span class="n">n</span> <span class="ow">mod</span> <span class="mi">5</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>      <span class="k">begin</span>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a>        <span class="k">if</span> <span class="n">n</span> <span class="ow">mod</span> <span class="mi">3</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>          <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;inner if</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a>      <span class="k">end</span>
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a>    <span class="k">else</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">mod</span> <span class="mi">3</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a>      <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;outer if 1</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a>    <span class="k">else</span>
</span><span id="__span-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a>      <span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">&quot;outer if 2</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="__span-52-11"><a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a>  <span class="o">;;</span>
</span></code></pre></div>
<p>Either are acceptable.</p>
<p>If OCaml's <code>else if</code> situation makes you uneasy,
there is a perfectly reasonable alternative...
that will probably also make you uneasy!
It's a way of using OCaml's <code>match</code> form
that is like a sequence of <code>if</code>/<code>else if</code>/<code>else</code> forms.
Example:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="k">let</span> <span class="n">abs</span> <span class="n">n</span> <span class="o">=</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>  <span class="k">match</span> <span class="bp">()</span> <span class="k">with</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a>    <span class="o">|</span> <span class="o">_</span> <span class="k">when</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">-&gt;</span> <span class="n">n</span>
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a>    <span class="o">|</span> <span class="o">_</span> <span class="k">when</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">-&gt;</span> <span class="o">-</span><span class="n">n</span>
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a>    <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="mi">0</span>
</span></code></pre></div>
<p>We match against <code>()</code> because we don't care about the value matched;
that's also why we use the <code>_</code> in each clause of the match. Instead,
we're using the <code>match</code> form solely because of the ability to use
<code>when</code> pattern guards; these contain the actual logic. This can often
be a bit more concise and clean than an actual <code>else if</code>, but be
careful: if you need to do another <code>match</code> in the expression following
the right arrow (<code>-&gt;</code>) you may have to wrap it in parentheses or a
<code>begin</code>/<code>end</code> form (see below for why).</p>
<h2 id="functions">Functions</h2>
<p>OCaml is a functional language, so functions are fundamental.
There are a number of unusual features of OCaml functions.</p>
<h3 id="syntax-and-currying">Syntax and currying</h3>
<p>Unlike most conventional languages,
OCaml doesn't require you to put parentheses
around the arguments to a function.
In fact, if you do, you change the meaning!
Consider this innocent-looking function:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">add</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">;;</span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="k">val</span> <span class="n">add</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a><span class="o">#</span> <span class="n">add</span> <span class="mi">2</span> <span class="mi">3</span><span class="o">;;</span>
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a><span class="o">#</span> <span class="n">add</span> <span class="o">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">)</span> <span class="o">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="o">);;</span>
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">12</span>
</span></code></pre></div>
<p>OK, so we can get by without parentheses around the arguments.
(The parentheses in the last line are to create the arguments,
not to surround them for the function call.)
What if we use them anyway?</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a># add (2, 3);;
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>Line 1, characters 4-10:
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>1 | add (2, 3);;
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>        ^^^^^^
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>Error: This expression has type &#39;a * &#39;b
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a>       but an expression was expected of type int
</span></code></pre></div>
<p>Nope, that isn't correct.
The error message may confuse you.
Let's see a variation:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">add&#39;</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">;;</span>
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="k">val</span> <span class="n">add&#39;</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="o">#</span> <span class="n">add&#39;</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">);;</span>
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">5</span>
</span></code></pre></div>
<p>(Note that in OCaml, you can use the <code>'</code> character
(pronounced "prime") in identifiers.)</p>
<p>If we define the function with parentheses,
we have to call it with parentheses.
If not:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a># add&#39; 2 3;;
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>Line 1, characters 0-4:
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>1 | add&#39; 2 3;;
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a>    ^^^^
</span><span id="__span-57-5"><a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a>Error: This function has type int * int -&gt; int
</span><span id="__span-57-6"><a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a>       It is applied to too many arguments; maybe you forgot a `;&#39;.
</span></code></pre></div>
<p>Huh. What is really going on here?</p>
<p>Look at the second version again:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">add&#39;</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">;;</span>
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="k">val</span> <span class="n">add&#39;</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>Look at the type signature.
The <code>int * int</code> part says that the input to the function
is a <em>single</em> argument which must be a two-tuple
(a tuple with two elements),
where both elements are <code>int</code>s.
If you leave the arguments "naked", they don't form a two-tuple,
and there are <em>two</em> arguments, not one.
This explains the error message.
Now look at the first version:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">add</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">;;</span>
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="k">val</span> <span class="n">add</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>The type signature is a bit odd.
Since the <code>-&gt;</code> type operator associates to the right,
this is equivalent to:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">add</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">;;</span>
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a><span class="k">val</span> <span class="n">add</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span><span class="o">)</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>This is an example of what's called <em>currying</em>.
What the type signature means is that the <code>add</code> function
actually only takes a <em>single</em> argument (an <code>int</code>)
and returns a <em>function</em> of type <code>int -&gt; int</code>.
If you call the function with both arguments,
the function returned by applying <code>add</code> to the first argument
(which has type <code>int -&gt; int</code>)
is immediately applied to the second argument (of type <code>int</code>)
to give the result, which is an <code>int</code>.
So this function call:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="o">#</span> <span class="n">add</span> <span class="mi">2</span> <span class="mi">3</span><span class="o">;;</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">5</span>
</span></code></pre></div>
<p>is actually this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="o">#</span> <span class="o">(</span><span class="n">add</span> <span class="mi">2</span><span class="o">)</span> <span class="mi">3</span><span class="o">;;</span>
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">5</span>
</span></code></pre></div>
<p>And if we leave out the second argument, we get this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="o">#</span> <span class="n">add</span> <span class="mi">2</span><span class="o">;;</span>
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>which shows currying in action. We can use this function:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">add2</span> <span class="o">=</span> <span class="n">add</span> <span class="mi">2</span><span class="o">;;</span>
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="k">val</span> <span class="n">add2</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a><span class="o">#</span> <span class="n">add2</span> <span class="mi">3</span><span class="o">;;</span>
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">5</span>
</span></code></pre></div>
<p>Curried functions are often useful
to create a partially-evaluated function
whose final value will be supplied later.
For instance:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="o">#</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="o">(</span><span class="n">add</span> <span class="mi">2</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">]</span>
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">3</span><span class="o">;</span> <span class="mi">4</span><span class="o">;</span> <span class="mi">5</span><span class="o">;</span> <span class="mi">6</span><span class="o">;</span> <span class="mi">7</span><span class="o">]</span>
</span></code></pre></div>
<h3 id="anonymous-functions">Anonymous functions</h3>
<p>Functions are a kind of data in functional languages like OCaml,
and you can define function values directly using the <code>fun</code> expression.
So instead of writing:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">add</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">;;</span>
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a><span class="k">val</span> <span class="n">add</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>we could write the definition like this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">add</span> <span class="o">=</span> <span class="k">fun</span> <span class="n">x</span> <span class="n">y</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">;;</span>
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a><span class="k">val</span> <span class="n">add</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>The meaning is exactly the same.
We say that the first form is <em>syntactic sugar</em> for the latter form.
We can even use a <code>fun</code> expression without giving it a name at all:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="o">#</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="n">y</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">)</span> <span class="mi">2</span> <span class="mi">3</span><span class="o">;;</span>
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">5</span>
</span></code></pre></div>
<p>Therefore, we say that the <code>fun</code> form defines an <em>anonymous function</em>.
Anonymous functions are often used with higher-order functions
(functions that take functions as input and/or return functions as output).</p>
<p>Note also that because of currying, the function</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="k">fun</span> <span class="n">x</span> <span class="n">y</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</span></code></pre></div>
<p>is the same as:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="k">fun</span> <span class="n">y</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</span></code></pre></div>
<p>You should think of the first form as syntactic sugar for the second.</p>
<h3 id="unused-arguments">Unused arguments</h3>
<p>If you define a function which doesn't use one (or more) of its arguments,
and strict warning settings are enabled
(as they are in the <code>Makefile</code>s for most assignments,
but not by default in <code>utop</code>)
you will get a warning.
You can even see this in <code>utop</code> if you enable warnings:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>$ utop -w A
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a># let f s z = z;;
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a>Warning 27 [unused-var-strict]: unused variable s.
</span><span id="__span-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a>val f : &#39;a -&gt; &#39;b -&gt; &#39;b = &lt;fun&gt;
</span></code></pre></div>
<p>(The <code>-w A</code> argument to <code>utop</code> turns on all compiler warnings.)</p>
<p>The way to fix this is simply to replace each unused argument with <code>_</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a>$ utop -w A
</span><span id="__span-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a># let f _ z = z;;
</span><span id="__span-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a>val f : &#39;a -&gt; &#39;b -&gt; &#39;b = &lt;fun&gt;
</span></code></pre></div>
<p>Now the warning has disappeared.</p>
<h2 id="match-expressions"><code>match</code> expressions</h2>
<p>OCaml <code>match</code> expressions are pretty straightforward. They have a
couple of subtleties you should know about.</p>
<h3 id="optional-before-first-match">Optional <code>|</code> before first match</h3>
<p>In a <code>match</code> expression,
the alternatives are separated by a vertical bar character (<code>|</code>).
You can also (optionally) put a vertical bar character
before the first pattern to be matched.
This often makes the code look cleaner.
Compare:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="k">let</span> <span class="k">rec</span> <span class="n">sum_list</span> <span class="n">lst</span> <span class="o">=</span>
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>  <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span>
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a>      <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">[]</span>
</span><span id="__span-73-4"><a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a>    <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">h</span> <span class="o">+</span> <span class="n">sum_list</span> <span class="n">t</span>
</span></code></pre></div>
<p>with</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="k">let</span> <span class="k">rec</span> <span class="n">sum_list</span> <span class="n">lst</span> <span class="o">=</span>
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a>  <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span>
</span><span id="__span-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a>    <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">[]</span>
</span><span id="__span-74-4"><a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a>    <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">h</span> <span class="o">+</span> <span class="n">sum_list</span> <span class="n">t</span>
</span></code></pre></div>
<p>These two functions are identical in terms of their functionality,
but the code for the second looks cleaner
because of the extra <code>|</code> before the first match.</p>
<h3 id="nested-match-expressions">Nested match expressions</h3>
<p>It's not uncommon to want to put a <code>match</code> expression
inside another <code>match</code> expression.
If you do, you have to be careful with the inner <code>match</code> expression
so that its clauses aren't confused with the outer <code>match</code>'s clauses.
Here's an
<a href="https://stackoverflow.com/questions/257605/ocaml-match-expression-inside-another-one">example</a>
from the internet:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="k">let</span> <span class="k">rec</span> <span class="n">filter</span> <span class="n">exp</span> <span class="o">=</span>
</span><span id="__span-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a>  <span class="k">match</span> <span class="n">exp</span> <span class="k">with</span>
</span><span id="__span-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a>    <span class="o">|</span> <span class="nc">Var</span> <span class="n">v</span> <span class="o">-&gt;</span> <span class="nc">Var</span> <span class="n">v</span>
</span><span id="__span-75-4"><a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a>    <span class="o">|</span> <span class="nc">Sum</span><span class="o">(</span><span class="n">e1</span><span class="o">,</span> <span class="n">e2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">Sum</span><span class="o">(</span><span class="n">e1</span><span class="o">,</span> <span class="n">e2</span><span class="o">)</span>
</span><span id="__span-75-5"><a id="__codelineno-75-5" name="__codelineno-75-5" href="#__codelineno-75-5"></a>    <span class="o">|</span> <span class="nc">Prod</span><span class="o">(</span><span class="n">e1</span><span class="o">,</span> <span class="n">e2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">Prod</span><span class="o">(</span><span class="n">e1</span><span class="o">,</span> <span class="n">e2</span><span class="o">)</span>
</span><span id="__span-75-6"><a id="__codelineno-75-6" name="__codelineno-75-6" href="#__codelineno-75-6"></a>    <span class="o">|</span> <span class="nc">Diff</span><span class="o">(</span><span class="n">e1</span><span class="o">,</span> <span class="n">e2</span><span class="o">)</span> <span class="o">-&gt;</span>
</span><span id="__span-75-7"><a id="__codelineno-75-7" name="__codelineno-75-7" href="#__codelineno-75-7"></a>      <span class="k">match</span> <span class="n">e2</span> <span class="k">with</span>  <span class="c">(* nested match *)</span>
</span><span id="__span-75-8"><a id="__codelineno-75-8" name="__codelineno-75-8" href="#__codelineno-75-8"></a>        <span class="o">|</span> <span class="nc">Sum</span><span class="o">(</span><span class="n">e3</span><span class="o">,</span> <span class="n">e4</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">filter</span> <span class="o">(</span><span class="n">diffRule</span> <span class="n">e2</span><span class="o">)</span>
</span><span id="__span-75-9"><a id="__codelineno-75-9" name="__codelineno-75-9" href="#__codelineno-75-9"></a>        <span class="o">|</span> <span class="nc">Diff</span><span class="o">(</span><span class="n">e3</span><span class="o">,</span> <span class="n">e4</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">filter</span> <span class="o">(</span><span class="n">diffRule</span> <span class="n">e2</span><span class="o">)</span>
</span><span id="__span-75-10"><a id="__codelineno-75-10" name="__codelineno-75-10" href="#__codelineno-75-10"></a>        <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="n">filter</span> <span class="n">e2</span>
</span><span id="__span-75-11"><a id="__codelineno-75-11" name="__codelineno-75-11" href="#__codelineno-75-11"></a>    <span class="c">(* Oops! These following clauses should belong to the outer match, but</span>
</span><span id="__span-75-12"><a id="__codelineno-75-12" name="__codelineno-75-12" href="#__codelineno-75-12"></a><span class="c">       they actually belong to the inner match. *)</span>
</span><span id="__span-75-13"><a id="__codelineno-75-13" name="__codelineno-75-13" href="#__codelineno-75-13"></a>    <span class="o">|</span> <span class="nc">Quot</span><span class="o">(</span><span class="n">e1</span><span class="o">,</span> <span class="n">e2</span><span class="o">)</span> <span class="o">-&gt;</span>
</span><span id="__span-75-14"><a id="__codelineno-75-14" name="__codelineno-75-14" href="#__codelineno-75-14"></a>        <span class="k">match</span> <span class="n">e2</span> <span class="k">with</span>
</span><span id="__span-75-15"><a id="__codelineno-75-15" name="__codelineno-75-15" href="#__codelineno-75-15"></a>        <span class="o">|</span> <span class="nc">Quot</span><span class="o">(</span><span class="n">e3</span><span class="o">,</span> <span class="n">e4</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">filter</span> <span class="o">(</span><span class="n">quotRule</span> <span class="n">e2</span><span class="o">)</span>
</span><span id="__span-75-16"><a id="__codelineno-75-16" name="__codelineno-75-16" href="#__codelineno-75-16"></a>        <span class="o">|</span> <span class="nc">Prod</span><span class="o">(</span><span class="n">e3</span><span class="o">,</span> <span class="n">e4</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">filter</span> <span class="o">(</span><span class="n">quotRule</span> <span class="n">e2</span><span class="o">)</span>
</span><span id="__span-75-17"><a id="__codelineno-75-17" name="__codelineno-75-17" href="#__codelineno-75-17"></a>        <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="n">filter</span> <span class="n">e2</span>
</span></code></pre></div>
<p>The solution is to wrap the inner <code>match</code> using parentheses or <code>begin</code>/<code>end</code>.
For instance:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="k">let</span> <span class="k">rec</span> <span class="n">filter</span> <span class="n">exp</span> <span class="o">=</span>
</span><span id="__span-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a>  <span class="k">match</span> <span class="n">exp</span> <span class="k">with</span>
</span><span id="__span-76-3"><a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a>    <span class="o">|</span> <span class="nc">Var</span> <span class="n">v</span> <span class="o">-&gt;</span> <span class="nc">Var</span> <span class="n">v</span>
</span><span id="__span-76-4"><a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a>    <span class="o">|</span> <span class="nc">Sum</span><span class="o">(</span><span class="n">e1</span><span class="o">,</span> <span class="n">e2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">Sum</span><span class="o">(</span><span class="n">e1</span><span class="o">,</span> <span class="n">e2</span><span class="o">)</span>
</span><span id="__span-76-5"><a id="__codelineno-76-5" name="__codelineno-76-5" href="#__codelineno-76-5"></a>    <span class="o">|</span> <span class="nc">Prod</span><span class="o">(</span><span class="n">e1</span><span class="o">,</span> <span class="n">e2</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="nc">Prod</span><span class="o">(</span><span class="n">e1</span><span class="o">,</span> <span class="n">e2</span><span class="o">)</span>
</span><span id="__span-76-6"><a id="__codelineno-76-6" name="__codelineno-76-6" href="#__codelineno-76-6"></a>    <span class="o">|</span> <span class="nc">Diff</span><span class="o">(</span><span class="n">e1</span><span class="o">,</span> <span class="n">e2</span><span class="o">)</span> <span class="o">-&gt;</span>
</span><span id="__span-76-7"><a id="__codelineno-76-7" name="__codelineno-76-7" href="#__codelineno-76-7"></a>      <span class="k">begin</span>
</span><span id="__span-76-8"><a id="__codelineno-76-8" name="__codelineno-76-8" href="#__codelineno-76-8"></a>        <span class="k">match</span> <span class="n">e2</span> <span class="k">with</span>  <span class="c">(* nested match *)</span>
</span><span id="__span-76-9"><a id="__codelineno-76-9" name="__codelineno-76-9" href="#__codelineno-76-9"></a>          <span class="o">|</span> <span class="nc">Sum</span><span class="o">(</span><span class="n">e3</span><span class="o">,</span> <span class="n">e4</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">filter</span> <span class="o">(</span><span class="n">diffRule</span> <span class="n">e2</span><span class="o">)</span>
</span><span id="__span-76-10"><a id="__codelineno-76-10" name="__codelineno-76-10" href="#__codelineno-76-10"></a>          <span class="o">|</span> <span class="nc">Diff</span><span class="o">(</span><span class="n">e3</span><span class="o">,</span> <span class="n">e4</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">filter</span> <span class="o">(</span><span class="n">diffRule</span> <span class="n">e2</span><span class="o">)</span>
</span><span id="__span-76-11"><a id="__codelineno-76-11" name="__codelineno-76-11" href="#__codelineno-76-11"></a>          <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="n">filter</span> <span class="n">e2</span>
</span><span id="__span-76-12"><a id="__codelineno-76-12" name="__codelineno-76-12" href="#__codelineno-76-12"></a>      <span class="k">end</span>
</span><span id="__span-76-13"><a id="__codelineno-76-13" name="__codelineno-76-13" href="#__codelineno-76-13"></a>    <span class="o">|</span> <span class="nc">Quot</span><span class="o">(</span><span class="n">e1</span><span class="o">,</span> <span class="n">e2</span><span class="o">)</span> <span class="o">-&gt;</span>
</span><span id="__span-76-14"><a id="__codelineno-76-14" name="__codelineno-76-14" href="#__codelineno-76-14"></a>        <span class="k">match</span> <span class="n">e2</span> <span class="k">with</span>
</span><span id="__span-76-15"><a id="__codelineno-76-15" name="__codelineno-76-15" href="#__codelineno-76-15"></a>        <span class="o">|</span> <span class="nc">Quot</span><span class="o">(</span><span class="n">e3</span><span class="o">,</span> <span class="n">e4</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">filter</span> <span class="o">(</span><span class="n">quotRule</span> <span class="n">e2</span><span class="o">)</span>
</span><span id="__span-76-16"><a id="__codelineno-76-16" name="__codelineno-76-16" href="#__codelineno-76-16"></a>        <span class="o">|</span> <span class="nc">Prod</span><span class="o">(</span><span class="n">e3</span><span class="o">,</span> <span class="n">e4</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">filter</span> <span class="o">(</span><span class="n">quotRule</span> <span class="n">e2</span><span class="o">)</span>
</span><span id="__span-76-17"><a id="__codelineno-76-17" name="__codelineno-76-17" href="#__codelineno-76-17"></a>        <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="n">filter</span> <span class="n">e2</span>
</span></code></pre></div>
<p>Now it will do what it's supposed to.
<strong>This is the most common mistake with pattern matching,</strong>
so make sure you are aware of it.</p>
<h3 id="function-expressions"><code>function</code> expressions</h3>
<p>This kind of pattern is extremely common:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a><span class="k">let</span> <span class="k">rec</span> <span class="o">&lt;</span><span class="k">function</span> <span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">arg</span><span class="o">&gt;</span> <span class="o">=</span>
</span><span id="__span-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a>  <span class="k">match</span> <span class="o">&lt;</span><span class="n">arg</span><span class="o">&gt;</span> <span class="k">with</span>
</span><span id="__span-77-3"><a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a>    <span class="o">|</span> <span class="o">&lt;</span><span class="n">pattern</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span id="__span-77-4"><a id="__codelineno-77-4" name="__codelineno-77-4" href="#__codelineno-77-4"></a>    <span class="o">|</span> <span class="o">&lt;</span><span class="n">pattern</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span id="__span-77-5"><a id="__codelineno-77-5" name="__codelineno-77-5" href="#__codelineno-77-5"></a>    <span class="o">...</span>
</span></code></pre></div>
<p>For instance, the <code>sum_list</code> function above
is an example of this pattern.
The essence of this pattern is that you pattern match on the last argument.
Sometimes you have more arguments:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a><span class="k">let</span> <span class="k">rec</span> <span class="o">&lt;</span><span class="k">function</span> <span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">arg1</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">arg2</span><span class="o">&gt;</span> <span class="o">...</span> <span class="o">&lt;</span><span class="n">argN</span><span class="o">&gt;</span> <span class="o">=</span>
</span><span id="__span-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a>  <span class="k">match</span> <span class="o">&lt;</span><span class="n">argN</span><span class="o">&gt;</span> <span class="k">with</span>
</span><span id="__span-78-3"><a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a>    <span class="o">|</span> <span class="o">&lt;</span><span class="n">pattern</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span id="__span-78-4"><a id="__codelineno-78-4" name="__codelineno-78-4" href="#__codelineno-78-4"></a>    <span class="o">|</span> <span class="o">&lt;</span><span class="n">pattern</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span id="__span-78-5"><a id="__codelineno-78-5" name="__codelineno-78-5" href="#__codelineno-78-5"></a>    <span class="o">...</span>
</span></code></pre></div>
<p>Whenever you have a function that pattern matches on its last argument,
you can rewrite it using the <code>function</code> keyword.
This is like an automatic <code>match</code> on the last argument.
The patterns above would be written like this using <code>function</code>:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="k">let</span> <span class="k">rec</span> <span class="o">&lt;</span><span class="k">function</span> <span class="n">name</span><span class="o">&gt;</span> <span class="o">=</span> <span class="k">function</span> <span class="c">(* leave off &lt;arg&gt; *)</span>
</span><span id="__span-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a>  <span class="o">|</span> <span class="o">&lt;</span><span class="n">pattern</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span id="__span-79-3"><a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a>  <span class="o">|</span> <span class="o">&lt;</span><span class="n">pattern</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span id="__span-79-4"><a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a>  <span class="o">...</span>
</span><span id="__span-79-5"><a id="__codelineno-79-5" name="__codelineno-79-5" href="#__codelineno-79-5"></a>
</span><span id="__span-79-6"><a id="__codelineno-79-6" name="__codelineno-79-6" href="#__codelineno-79-6"></a><span class="k">let</span> <span class="k">rec</span> <span class="o">&lt;</span><span class="k">function</span> <span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">arg1</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">arg2</span><span class="o">&gt;</span> <span class="o">...</span> <span class="o">=</span> <span class="k">function</span> <span class="c">(* leave off &lt;argN&gt; *)</span>
</span><span id="__span-79-7"><a id="__codelineno-79-7" name="__codelineno-79-7" href="#__codelineno-79-7"></a>  <span class="o">|</span> <span class="o">&lt;</span><span class="n">pattern</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span id="__span-79-8"><a id="__codelineno-79-8" name="__codelineno-79-8" href="#__codelineno-79-8"></a>  <span class="o">|</span> <span class="o">&lt;</span><span class="n">pattern</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="o">-&gt;</span> <span class="o">...</span>
</span><span id="__span-79-9"><a id="__codelineno-79-9" name="__codelineno-79-9" href="#__codelineno-79-9"></a>  <span class="o">...</span>
</span></code></pre></div>
<p>Rewriting <code>sum_list</code> using <code>function</code> gives this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="k">let</span> <span class="k">rec</span> <span class="n">sum_list</span> <span class="o">=</span> <span class="k">function</span> <span class="c">(* leave off &lt;arg1&gt; *)</span>
</span><span id="__span-80-2"><a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a>  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">[]</span>
</span><span id="__span-80-3"><a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a>  <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">h</span> <span class="o">+</span> <span class="n">sum_list</span> <span class="n">t</span>
</span></code></pre></div>
<p>This way of writing functions has advantages and disadvantages.
The advantage is that it's more concise.
The disadvantage is that you have to remember
that the <code>function</code> keyword means that the function you are defining
has an extra argument that doesn't have a name.
Also, if you do need the name of the argument inside the body of the function,
you can't use <code>function</code>.
<code>function</code> is mostly used for simple functions of a simple argument
where the only thing you do with the argument is pattern match on it.
It's never necessary, though,
so feel free to write all your code without it if you don't like it.</p>
<h3 id="the-fragile-pattern-match-compiler-warning">The "fragile pattern match" compiler warning</h3>
<p>We like to compile OCaml code with most of the warning settings enabled.
This provides a lot of suggestions for fixing problematic code
which is still technically correct.
You can turn on all compiler warnings by compiling with the <code>-w A</code>
(<code>A</code> means "all") command-line option.
This works both for <code>ocamlc</code>
and for the interactive interpreters <code>ocaml</code> and <code>utop</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We don't necessarily recommend the <code>-w A</code> option
for routine use with interactive interpreters,
because some warnings would cause problems with normal use of interpreters,
such as redefining datatypes.</p>
</div>
<p>One particular compiler warning can be very confusing.
Consider this code:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a><span class="k">type</span> <span class="n">foo</span> <span class="o">=</span>
</span><span id="__span-81-2"><a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a>  <span class="o">|</span> <span class="nc">Foo</span>
</span><span id="__span-81-3"><a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a>  <span class="o">|</span> <span class="nc">Bar</span> <span class="k">of</span> <span class="kt">int</span>
</span><span id="__span-81-4"><a id="__codelineno-81-4" name="__codelineno-81-4" href="#__codelineno-81-4"></a>  <span class="o">|</span> <span class="nc">Baz</span> <span class="k">of</span> <span class="kt">string</span>
</span><span id="__span-81-5"><a id="__codelineno-81-5" name="__codelineno-81-5" href="#__codelineno-81-5"></a>
</span><span id="__span-81-6"><a id="__codelineno-81-6" name="__codelineno-81-6" href="#__codelineno-81-6"></a><span class="k">let</span> <span class="n">get_foo_int</span> <span class="n">f</span> <span class="o">=</span>
</span><span id="__span-81-7"><a id="__codelineno-81-7" name="__codelineno-81-7" href="#__codelineno-81-7"></a>  <span class="k">match</span> <span class="n">f</span> <span class="k">with</span>
</span><span id="__span-81-8"><a id="__codelineno-81-8" name="__codelineno-81-8" href="#__codelineno-81-8"></a>    <span class="o">|</span> <span class="nc">Bar</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span>
</span><span id="__span-81-9"><a id="__codelineno-81-9" name="__codelineno-81-9" href="#__codelineno-81-9"></a>    <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="mi">0</span>
</span></code></pre></div>
<p>With warnings enabled, this gives this warning:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a>Warning 4 [fragile-match]: this pattern-matching is fragile.
</span><span id="__span-82-2"><a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a>It will remain exhaustive when constructors are added to type foo.
</span><span id="__span-82-3"><a id="__codelineno-82-3" name="__codelineno-82-3" href="#__codelineno-82-3"></a>val get_foo_int : foo -&gt; int = &lt;fun&gt;
</span></code></pre></div>
<p>What this is complaining about is the last line
in the <code>get_foo_int</code> function: <code>| _ -&gt; 0</code>.
The intent of this line is to say that for all constructors
except the <code>Bar</code> constructor,
return the integer <code>0</code>.
This is not incorrect code!
On the other hand, let's say we modified the <code>foo</code> type
to have another constructor that contained an <code>int</code> value:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="k">type</span> <span class="n">foo</span> <span class="o">=</span>
</span><span id="__span-83-2"><a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a>  <span class="o">|</span> <span class="nc">Foo</span>
</span><span id="__span-83-3"><a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a>  <span class="o">|</span> <span class="nc">Bar</span> <span class="k">of</span> <span class="kt">int</span>
</span><span id="__span-83-4"><a id="__codelineno-83-4" name="__codelineno-83-4" href="#__codelineno-83-4"></a>  <span class="o">|</span> <span class="nc">Baz</span> <span class="k">of</span> <span class="kt">string</span>
</span><span id="__span-83-5"><a id="__codelineno-83-5" name="__codelineno-83-5" href="#__codelineno-83-5"></a>  <span class="o">|</span> <span class="nc">Boom</span> <span class="k">of</span> <span class="kt">int</span>
</span></code></pre></div>
<p>but we forgot to change the <code>get_foo_int</code> function.
The function will still work, but it won't do the right thing.
You would probably want to change it to this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="k">let</span> <span class="n">get_foo_int</span> <span class="n">f</span> <span class="o">=</span>
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a>  <span class="k">match</span> <span class="n">f</span> <span class="k">with</span>
</span><span id="__span-84-3"><a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a>    <span class="o">|</span> <span class="nc">Bar</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span>
</span><span id="__span-84-4"><a id="__codelineno-84-4" name="__codelineno-84-4" href="#__codelineno-84-4"></a>    <span class="o">|</span> <span class="nc">Boom</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span>
</span><span id="__span-84-5"><a id="__codelineno-84-5" name="__codelineno-84-5" href="#__codelineno-84-5"></a>    <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="mi">0</span>
</span></code></pre></div>
<p>so that any constructor with an <code>int</code> value has the <code>int</code> value returned.
But since the old code still compiles,
you won't know that you need to make this change.</p>
<p>This is what a "fragile pattern match" means:
it's a catch-all case that matches more than one constructor,
so if you happen to add more constructors to the datatype,
it will match those as well. 
What you would like it to do is to warn you:
"Hey!  I've never seen the <code>Boom</code> case before,
and you're not handling it, so that's probably an error!"
The way to do this is to explicitly handle all constructors
in the original function.</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a><span class="k">let</span> <span class="n">get_foo_int</span> <span class="n">f</span> <span class="o">=</span>
</span><span id="__span-85-2"><a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a>  <span class="k">match</span> <span class="n">f</span> <span class="k">with</span>
</span><span id="__span-85-3"><a id="__codelineno-85-3" name="__codelineno-85-3" href="#__codelineno-85-3"></a>    <span class="o">|</span> <span class="nc">Bar</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span>
</span><span id="__span-85-4"><a id="__codelineno-85-4" name="__codelineno-85-4" href="#__codelineno-85-4"></a>    <span class="o">|</span> <span class="nc">Foo</span> <span class="o">-&gt;</span> <span class="mi">0</span>
</span><span id="__span-85-5"><a id="__codelineno-85-5" name="__codelineno-85-5" href="#__codelineno-85-5"></a>    <span class="o">|</span> <span class="nc">Baz</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="mi">0</span>
</span></code></pre></div>
<p>Then the warning will go away.<br />
On the other hand, it's annoying to have to write the same value
(here, <code>0</code>) for two cases.
In this case, we can use the "fall through" mechanism of pattern matching
to make the code simpler:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a><span class="k">let</span> <span class="n">get_foo_int</span> <span class="n">f</span> <span class="o">=</span>
</span><span id="__span-86-2"><a id="__codelineno-86-2" name="__codelineno-86-2" href="#__codelineno-86-2"></a>  <span class="k">match</span> <span class="n">f</span> <span class="k">with</span>
</span><span id="__span-86-3"><a id="__codelineno-86-3" name="__codelineno-86-3" href="#__codelineno-86-3"></a>    <span class="o">|</span> <span class="nc">Bar</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span>
</span><span id="__span-86-4"><a id="__codelineno-86-4" name="__codelineno-86-4" href="#__codelineno-86-4"></a>    <span class="o">|</span> <span class="nc">Foo</span>   <span class="c">(* no `-&gt;` so fall through to next case *)</span>
</span><span id="__span-86-5"><a id="__codelineno-86-5" name="__codelineno-86-5" href="#__codelineno-86-5"></a>    <span class="o">|</span> <span class="nc">Baz</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="mi">0</span>
</span></code></pre></div>
<p>And we can write all the catch-all cases on one line:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a><span class="k">let</span> <span class="n">get_foo_int</span> <span class="n">f</span> <span class="o">=</span>
</span><span id="__span-87-2"><a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a>  <span class="k">match</span> <span class="n">f</span> <span class="k">with</span>
</span><span id="__span-87-3"><a id="__codelineno-87-3" name="__codelineno-87-3" href="#__codelineno-87-3"></a>    <span class="o">|</span> <span class="nc">Bar</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span>
</span><span id="__span-87-4"><a id="__codelineno-87-4" name="__codelineno-87-4" href="#__codelineno-87-4"></a>    <span class="o">|</span> <span class="nc">Foo</span> <span class="o">|</span> <span class="nc">Baz</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="mi">0</span>
</span></code></pre></div>
<p>Now, if we add the <code>Boom</code> constructor, we will have to add a case for that:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a><span class="k">type</span> <span class="n">foo</span> <span class="o">=</span>
</span><span id="__span-88-2"><a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a>  <span class="o">|</span> <span class="nc">Foo</span>
</span><span id="__span-88-3"><a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a>  <span class="o">|</span> <span class="nc">Bar</span> <span class="k">of</span> <span class="kt">int</span>
</span><span id="__span-88-4"><a id="__codelineno-88-4" name="__codelineno-88-4" href="#__codelineno-88-4"></a>  <span class="o">|</span> <span class="nc">Baz</span> <span class="k">of</span> <span class="kt">string</span>
</span><span id="__span-88-5"><a id="__codelineno-88-5" name="__codelineno-88-5" href="#__codelineno-88-5"></a>  <span class="o">|</span> <span class="nc">Boom</span> <span class="k">of</span> <span class="kt">int</span>   <span class="c">(* new constructor *)</span>
</span><span id="__span-88-6"><a id="__codelineno-88-6" name="__codelineno-88-6" href="#__codelineno-88-6"></a>
</span><span id="__span-88-7"><a id="__codelineno-88-7" name="__codelineno-88-7" href="#__codelineno-88-7"></a><span class="k">let</span> <span class="n">get_foo_int</span> <span class="n">f</span> <span class="o">=</span>
</span><span id="__span-88-8"><a id="__codelineno-88-8" name="__codelineno-88-8" href="#__codelineno-88-8"></a>  <span class="k">match</span> <span class="n">f</span> <span class="k">with</span>
</span><span id="__span-88-9"><a id="__codelineno-88-9" name="__codelineno-88-9" href="#__codelineno-88-9"></a>    <span class="o">|</span> <span class="nc">Bar</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span>
</span><span id="__span-88-10"><a id="__codelineno-88-10" name="__codelineno-88-10" href="#__codelineno-88-10"></a>    <span class="o">|</span> <span class="nc">Boom</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span>   <span class="c">(* new case *)</span>
</span><span id="__span-88-11"><a id="__codelineno-88-11" name="__codelineno-88-11" href="#__codelineno-88-11"></a>    <span class="o">|</span> <span class="nc">Foo</span> <span class="o">|</span> <span class="nc">Baz</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="mi">0</span>
</span></code></pre></div>
<p>If we left out the <code>Boom</code> case,
we would get a warning about a non-exhaustive pattern-match,
and we would know just what to fix.</p>
<p>Writing out catch-all cases like this is a bit tedious at times,
but if you don't do it,
you can sometimes get bugs that are extremely hard to track down.<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></p>
<h2 id="let-expressions"><code>let</code> expressions</h2>
<h3 id="explicit-recursion">Explicit recursion</h3>
<p>OCaml requires you to say <code>let rec</code> when defining a recursive function.</p>
<p>You can easily define mutually recursive functions by using the</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a><span class="k">let</span> <span class="k">rec</span> <span class="n">f</span> <span class="n">x</span> <span class="o">=</span>
</span><span id="__span-89-2"><a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a>  <span class="o">...</span>  <span class="c">(* expression using g *)</span>
</span><span id="__span-89-3"><a id="__codelineno-89-3" name="__codelineno-89-3" href="#__codelineno-89-3"></a><span class="k">and</span> <span class="n">g</span> <span class="n">y</span> <span class="o">=</span>
</span><span id="__span-89-4"><a id="__codelineno-89-4" name="__codelineno-89-4" href="#__codelineno-89-4"></a>  <span class="o">...</span>  <span class="c">(* expression using f *)</span>
</span></code></pre></div>
<p>syntax for top-level mutually-recursive functions,
or the</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a><span class="k">let</span> <span class="k">rec</span> <span class="n">f</span> <span class="n">x</span> <span class="o">=</span>
</span><span id="__span-90-2"><a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a>  <span class="o">...</span>  <span class="c">(* expression using g *)</span>
</span><span id="__span-90-3"><a id="__codelineno-90-3" name="__codelineno-90-3" href="#__codelineno-90-3"></a><span class="k">and</span> <span class="n">g</span> <span class="n">y</span> <span class="o">=</span>
</span><span id="__span-90-4"><a id="__codelineno-90-4" name="__codelineno-90-4" href="#__codelineno-90-4"></a>  <span class="o">...</span>  <span class="c">(* expression using f *)</span>
</span><span id="__span-90-5"><a id="__codelineno-90-5" name="__codelineno-90-5" href="#__codelineno-90-5"></a><span class="k">in</span>
</span><span id="__span-90-6"><a id="__codelineno-90-6" name="__codelineno-90-6" href="#__codelineno-90-6"></a>  <span class="o">...</span>
</span></code></pre></div>
<p>syntax for mutually-recursive functions inside an expression. 
<strong>Leaving out the <code>rec</code> is one of the commonest mistakes
beginning OCaml programmers make.</strong>
Conversely, don't use the <code>rec</code> unless the function is actually recursive!
(This will rarely cause problems, but it's poor style,
and it may generate a warning.)</p>
<h2 id="imperative-programming">Imperative programming</h2>
<h3 id="references">References</h3>
<p>OCaml doesn't have "variables"
in the sense that most programming languages do. 
Instead, it has <em>references</em>,
which are basically records with a single mutable field. 
These are effectively the same as variables
except that you have to explicitly dereference them
to get the value they contain. 
I'm not going to lie to you, this is a pain in highly imperative code!
However, it is extremely explicit
and it allows you to define useful functions on references.</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">r</span> <span class="o">=</span> <span class="n">ref</span> <span class="mi">0</span><span class="o">;;</span>  <span class="c">(* r is a reference *)</span>
</span><span id="__span-91-2"><a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a><span class="k">val</span> <span class="n">r</span> <span class="o">:</span> <span class="kt">int</span> <span class="n">ref</span> <span class="o">=</span> <span class="o">{</span><span class="n">contents</span> <span class="o">=</span> <span class="mi">0</span><span class="o">}</span>
</span><span id="__span-91-3"><a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a><span class="o">#</span> <span class="n">r</span><span class="o">;;</span>
</span><span id="__span-91-4"><a id="__codelineno-91-4" name="__codelineno-91-4" href="#__codelineno-91-4"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="n">ref</span> <span class="o">=</span> <span class="o">{</span><span class="n">contents</span> <span class="o">=</span> <span class="mi">0</span><span class="o">}</span>
</span><span id="__span-91-5"><a id="__codelineno-91-5" name="__codelineno-91-5" href="#__codelineno-91-5"></a><span class="o">#</span> <span class="o">(!);;</span>      <span class="c">(* ! is the dereference operator *)</span>
</span><span id="__span-91-6"><a id="__codelineno-91-6" name="__codelineno-91-6" href="#__codelineno-91-6"></a><span class="o">-</span> <span class="o">:</span> <span class="k">&#39;</span><span class="n">a</span> <span class="n">ref</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">a</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-91-7"><a id="__codelineno-91-7" name="__codelineno-91-7" href="#__codelineno-91-7"></a><span class="o">#</span> <span class="o">!</span><span class="n">r</span><span class="o">;;</span>
</span><span id="__span-91-8"><a id="__codelineno-91-8" name="__codelineno-91-8" href="#__codelineno-91-8"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-91-9"><a id="__codelineno-91-9" name="__codelineno-91-9" href="#__codelineno-91-9"></a><span class="o">#</span> <span class="o">(:=);;</span>     <span class="c">(* := is the assignment operator *)</span>
</span><span id="__span-91-10"><a id="__codelineno-91-10" name="__codelineno-91-10" href="#__codelineno-91-10"></a><span class="o">-</span> <span class="o">:</span> <span class="k">&#39;</span><span class="n">a</span> <span class="n">ref</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">unit</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-91-11"><a id="__codelineno-91-11" name="__codelineno-91-11" href="#__codelineno-91-11"></a><span class="o">#</span> <span class="n">r</span> <span class="o">:=</span> <span class="mi">42</span><span class="o">;;</span>
</span><span id="__span-91-12"><a id="__codelineno-91-12" name="__codelineno-91-12" href="#__codelineno-91-12"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span><span id="__span-91-13"><a id="__codelineno-91-13" name="__codelineno-91-13" href="#__codelineno-91-13"></a><span class="o">#</span> <span class="n">r</span><span class="o">;;</span>
</span><span id="__span-91-14"><a id="__codelineno-91-14" name="__codelineno-91-14" href="#__codelineno-91-14"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="n">ref</span> <span class="o">=</span> <span class="o">{</span><span class="n">contents</span> <span class="o">=</span> <span class="mi">42</span><span class="o">}</span>
</span><span id="__span-91-15"><a id="__codelineno-91-15" name="__codelineno-91-15" href="#__codelineno-91-15"></a><span class="o">#</span> <span class="o">!</span><span class="n">r</span><span class="o">;;</span>
</span><span id="__span-91-16"><a id="__codelineno-91-16" name="__codelineno-91-16" href="#__codelineno-91-16"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">42</span>
</span><span id="__span-91-17"><a id="__codelineno-91-17" name="__codelineno-91-17" href="#__codelineno-91-17"></a><span class="o">#</span> <span class="n">incr</span><span class="o">;;</span>     <span class="c">(* incr is a function on references *)</span>
</span><span id="__span-91-18"><a id="__codelineno-91-18" name="__codelineno-91-18" href="#__codelineno-91-18"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="n">ref</span> <span class="o">-&gt;</span> <span class="kt">unit</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-91-19"><a id="__codelineno-91-19" name="__codelineno-91-19" href="#__codelineno-91-19"></a><span class="o">#</span> <span class="n">incr</span> <span class="n">r</span><span class="o">;;</span>
</span><span id="__span-91-20"><a id="__codelineno-91-20" name="__codelineno-91-20" href="#__codelineno-91-20"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span><span id="__span-91-21"><a id="__codelineno-91-21" name="__codelineno-91-21" href="#__codelineno-91-21"></a><span class="o">#</span> <span class="o">!</span><span class="n">r</span><span class="o">;;</span>
</span><span id="__span-91-22"><a id="__codelineno-91-22" name="__codelineno-91-22" href="#__codelineno-91-22"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">43</span>
</span></code></pre></div>
<p>Fun fact: we could have defined the <code>!</code> and <code>:=</code> operators ourselves,
and we could have defined the <code>incr</code> function as well:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-92-1"><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a><span class="o">#</span> <span class="k">let</span> <span class="o">(</span> <span class="o">!</span> <span class="o">)</span> <span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">contents</span><span class="o">;;</span>
</span><span id="__span-92-2"><a id="__codelineno-92-2" name="__codelineno-92-2" href="#__codelineno-92-2"></a><span class="k">val</span> <span class="o">(</span> <span class="o">!</span> <span class="o">)</span> <span class="o">:</span> <span class="k">&#39;</span><span class="n">a</span> <span class="n">ref</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">a</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-92-3"><a id="__codelineno-92-3" name="__codelineno-92-3" href="#__codelineno-92-3"></a><span class="o">#</span> <span class="k">let</span> <span class="o">(</span> <span class="o">:=</span> <span class="o">)</span> <span class="n">r</span> <span class="n">v</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">contents</span> <span class="o">&lt;-</span> <span class="n">v</span><span class="o">;;</span>
</span><span id="__span-92-4"><a id="__codelineno-92-4" name="__codelineno-92-4" href="#__codelineno-92-4"></a><span class="k">val</span> <span class="o">(</span> <span class="o">:=</span> <span class="o">)</span> <span class="o">:</span> <span class="k">&#39;</span><span class="n">a</span> <span class="n">ref</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">unit</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-92-5"><a id="__codelineno-92-5" name="__codelineno-92-5" href="#__codelineno-92-5"></a><span class="o">#</span> <span class="k">let</span> <span class="n">incr</span> <span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">contents</span> <span class="o">&lt;-</span> <span class="o">!</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;;</span>
</span><span id="__span-92-6"><a id="__codelineno-92-6" name="__codelineno-92-6" href="#__codelineno-92-6"></a><span class="k">val</span> <span class="n">incr</span> <span class="o">:</span> <span class="kt">int</span> <span class="n">ref</span> <span class="o">-&gt;</span> <span class="kt">unit</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>This works because references (<code>ref</code> cells)
are records with a single field called <code>contents</code>,
so the record accessing and mutating syntax can be used on them.</p>
<h3 id="sequence-expressions">Sequence expressions</h3>
<p>When you are doing imperative programming,
it's often necessary to have a notion of sequencing,
as in do-this-then-do-that <em>etc.</em>
In OCaml, this requires a <em>sequence expression</em>, which has two forms:</p>
<ul>
<li>a series of statements separated by semicolons
   and wrapped with <code>begin</code>/<code>end</code></li>
<li>the same, but using parentheses instead of <code>begin</code>/<code>end</code></li>
</ul>
<p>The choice between using <code>begin</code>/<code>end</code> or parentheses is a style decision.
I prefer parentheses for very short (one-liner) sequence expressions
and <code>begin</code>/<code>end</code> for sequence expressions that span multiple lines.</p>
<p>Here's an example of an (inefficient) imperative function to compute
greatest common denominators (GCDs):</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-93-1"><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a><span class="k">let</span> <span class="n">gcd</span> <span class="n">m</span> <span class="n">n</span> <span class="o">=</span>
</span><span id="__span-93-2"><a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a>  <span class="k">let</span> <span class="n">p</span> <span class="o">=</span> <span class="n">ref</span> <span class="n">m</span> <span class="k">in</span>
</span><span id="__span-93-3"><a id="__codelineno-93-3" name="__codelineno-93-3" href="#__codelineno-93-3"></a>  <span class="k">let</span> <span class="n">q</span> <span class="o">=</span> <span class="n">ref</span> <span class="n">n</span> <span class="k">in</span>
</span><span id="__span-93-4"><a id="__codelineno-93-4" name="__codelineno-93-4" href="#__codelineno-93-4"></a>    <span class="k">begin</span>
</span><span id="__span-93-5"><a id="__codelineno-93-5" name="__codelineno-93-5" href="#__codelineno-93-5"></a>      <span class="k">while</span> <span class="o">!</span><span class="n">p</span> <span class="o">&lt;&gt;</span> <span class="o">!</span><span class="n">q</span> <span class="k">do</span>
</span><span id="__span-93-6"><a id="__codelineno-93-6" name="__codelineno-93-6" href="#__codelineno-93-6"></a>          <span class="k">if</span> <span class="o">!</span><span class="n">p</span> <span class="o">&gt;</span> <span class="o">!</span><span class="n">q</span> <span class="k">then</span>
</span><span id="__span-93-7"><a id="__codelineno-93-7" name="__codelineno-93-7" href="#__codelineno-93-7"></a>            <span class="n">p</span> <span class="o">:=</span> <span class="o">!</span><span class="n">p</span> <span class="o">-</span> <span class="o">!</span><span class="n">q</span>
</span><span id="__span-93-8"><a id="__codelineno-93-8" name="__codelineno-93-8" href="#__codelineno-93-8"></a>          <span class="k">else</span>
</span><span id="__span-93-9"><a id="__codelineno-93-9" name="__codelineno-93-9" href="#__codelineno-93-9"></a>            <span class="n">q</span> <span class="o">:=</span> <span class="o">!</span><span class="n">q</span> <span class="o">-</span> <span class="o">!</span><span class="n">p</span>
</span><span id="__span-93-10"><a id="__codelineno-93-10" name="__codelineno-93-10" href="#__codelineno-93-10"></a>      <span class="k">done</span><span class="o">;</span>
</span><span id="__span-93-11"><a id="__codelineno-93-11" name="__codelineno-93-11" href="#__codelineno-93-11"></a>      <span class="o">!</span><span class="n">p</span>
</span><span id="__span-93-12"><a id="__codelineno-93-12" name="__codelineno-93-12" href="#__codelineno-93-12"></a>    <span class="k">end</span>
</span></code></pre></div>
<p>This also shows the use of an imperative <code>while</code> loop. It also shows
how annoying imperative programming is in OCaml <code>!</code> because <code>!</code> of
<code>!</code> all <code>!</code> the <code>!</code> exclamation <code>!</code> points!</p>
<h3 id="weakly-polymorphic-types">Weakly polymorphic types</h3>
<p>OCaml's type system has some peculiarities. 
One that you are likely to run into when you do imperative programming
is that there are types that are "weakly polymorphic". 
A truly polymorphic type can be parameterized on one or more type variables,
which are written with a leading quote <em>i.e.</em> <code>'a</code>, <code>'b</code> <em>etc.</em>
But some types are not actually polymorphic, they are "write-once" types. 
Look at this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-94-1"><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">r</span> <span class="o">=</span> <span class="n">ref</span> <span class="bp">[]</span><span class="o">;;</span>
</span><span id="__span-94-2"><a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a><span class="k">val</span> <span class="n">r</span> <span class="o">:</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak1</span> <span class="kt">list</span> <span class="n">ref</span> <span class="o">=</span> <span class="o">{</span><span class="n">contents</span> <span class="o">=</span> <span class="bp">[]</span><span class="o">}</span>
</span><span id="__span-94-3"><a id="__codelineno-94-3" name="__codelineno-94-3" href="#__codelineno-94-3"></a><span class="o">#</span> <span class="o">!</span><span class="n">r</span><span class="o">;;</span>
</span><span id="__span-94-4"><a id="__codelineno-94-4" name="__codelineno-94-4" href="#__codelineno-94-4"></a><span class="o">-</span> <span class="o">:</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak1</span> <span class="kt">list</span> <span class="o">=</span> <span class="bp">[]</span>
</span><span id="__span-94-5"><a id="__codelineno-94-5" name="__codelineno-94-5" href="#__codelineno-94-5"></a><span class="o">#</span> <span class="n">r</span> <span class="o">:=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">];;</span>
</span><span id="__span-94-6"><a id="__codelineno-94-6" name="__codelineno-94-6" href="#__codelineno-94-6"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">unit</span> <span class="o">=</span> <span class="bp">()</span>
</span><span id="__span-94-7"><a id="__codelineno-94-7" name="__codelineno-94-7" href="#__codelineno-94-7"></a><span class="o">#</span> <span class="n">r</span><span class="o">;;</span>
</span><span id="__span-94-8"><a id="__codelineno-94-8" name="__codelineno-94-8" href="#__codelineno-94-8"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="n">ref</span> <span class="o">=</span> <span class="o">{</span><span class="n">contents</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">]}</span>
</span><span id="__span-94-9"><a id="__codelineno-94-9" name="__codelineno-94-9" href="#__codelineno-94-9"></a><span class="o">#</span> <span class="o">!</span><span class="n">r</span><span class="o">;;</span>
</span><span id="__span-94-10"><a id="__codelineno-94-10" name="__codelineno-94-10" href="#__codelineno-94-10"></a><span class="o">-</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span> <span class="mi">2</span><span class="o">;</span> <span class="mi">3</span><span class="o">]</span>
</span></code></pre></div>
<p>The initial type of <code>r</code> is <code>'_weak1 list ref</code>, which is pretty odd.
You might expect it to be <code>'a list ref</code>
<em>i.e.</em> that <code>r</code> is a reference which can contain any kind of list. 
But this would not be type-safe;
if <code>r</code> holds a list of <code>int</code>s at one time and a list of <code>bool</code>s at another,
then all the types are not known at compile-time,
and you might as well be writing Python code.</p>
<p>Instead, what this odd type means is that <code>r</code> is a reference
containing a list <em>of currently unspecified type</em>. 
That's what the <code>'_weak1 list ref</code> means. 
Since <code>r</code> was initialized with an empty list,
which could have any element type, you can't say any more. 
Once you reassign a list of known type to <code>r</code>,
it then has a concrete type (<code>int list</code> in this case),
and the type is fixed thereafter.</p>
<p>OK, so what if you aren't using references or imperative features?
Unfortunately, you can still get weakly polymorphic types
if you partially apply a function. 
Here's a trivial example:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-95-1"><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">const</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">;;</span>
</span><span id="__span-95-2"><a id="__codelineno-95-2" name="__codelineno-95-2" href="#__codelineno-95-2"></a><span class="k">val</span> <span class="n">const</span> <span class="o">:</span> <span class="k">&#39;</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">b</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-95-3"><a id="__codelineno-95-3" name="__codelineno-95-3" href="#__codelineno-95-3"></a><span class="o">#</span> <span class="k">let</span> <span class="n">f</span> <span class="o">=</span> <span class="n">const</span> <span class="bp">()</span> <span class="o">;;</span>  <span class="c">(* partial application of the const function *)</span>
</span><span id="__span-95-4"><a id="__codelineno-95-4" name="__codelineno-95-4" href="#__codelineno-95-4"></a><span class="k">val</span> <span class="n">f</span> <span class="o">:</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak1</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="o">_</span><span class="n">weak1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>This is purely functional code, but you still get a weak type!
The reasons for this are quite involved (see the references below),
but one trick that will work in most cases
is to change the partial application to a full application
by adding arguments:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-96-1"><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a><span class="o">#</span> <span class="k">let</span> <span class="n">const</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">;;</span>
</span><span id="__span-96-2"><a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a><span class="k">val</span> <span class="n">const</span> <span class="o">:</span> <span class="k">&#39;</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">b</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span><span id="__span-96-3"><a id="__codelineno-96-3" name="__codelineno-96-3" href="#__codelineno-96-3"></a><span class="o">#</span> <span class="k">let</span> <span class="n">f</span> <span class="n">x</span> <span class="o">=</span> <span class="n">const</span> <span class="bp">()</span> <span class="n">x</span> <span class="o">;;</span>  <span class="c">(* no longer a partial application of the const function *)</span>
</span><span id="__span-96-4"><a id="__codelineno-96-4" name="__codelineno-96-4" href="#__codelineno-96-4"></a><span class="k">val</span> <span class="n">f</span> <span class="o">:</span> <span class="k">&#39;</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">a</span> <span class="o">=</span> <span class="o">&lt;</span><span class="k">fun</span><span class="o">&gt;</span>
</span></code></pre></div>
<p>Now <code>f</code> has the expected type. 
This trick (called "eta expansion") is definitely worth remembering.</p>
<p>For more on this issue
(really far more than you need to know at this point),
here are some good references:</p>
<ul>
<li><a href="https://ocaml.org/manual/5.3/polymorphism.html">https://ocaml.org/manual/5.3/polymorphism.html</a></li>
<li><a href="https://ocamlverse.github.io/content/weak_type_variables.html">https://ocamlverse.github.io/content/weak_type_variables.html</a></li>
</ul>
<p>However, don't stress too much about it.
This is expert-level stuff,
and at this point in your OCaml learning process,
the main reason we're bringing this up
is in case you encounter this in practice
and want to have an idea about what's going on.
Sophisticated type systems like OCaml's are quite involved,
and few people have completely mastered all of the details.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>In the CS 164 course (Compilers), which uses OCaml,
this kind of situation comes up quite frequently,
because many of the compilers start with compiler passes
from a simpler compiler and extend them to handle
new constructors.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../assignments/1/partC_recursion/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Part C: Recursion">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Part C: Recursion
              </div>
            </div>
          </a>
        
        
          
          <a href="../subst/" class="md-footer__link md-footer__link--next" aria-label="Next: The Substitution Model">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                The Substitution Model
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.footer", "navigation.top"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="../../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>