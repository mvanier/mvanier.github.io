
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mvanier.github.io/cs4/Winter2025/book/assignments/6/partC_modules_functors/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Part C: Modules and functors (30 points) - The CS 4 book (Winter 2025)</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#part-c-modules-and-functors-30-points" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="The CS 4 book (Winter 2025)" class="md-header__button md-logo" aria-label="The CS 4 book (Winter 2025)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The CS 4 book (Winter 2025)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Part C: Modules and functors (30 points)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to medium mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to medium mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="medium" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="The CS 4 book (Winter 2025)" class="md-nav__button md-logo" aria-label="The CS 4 book (Winter 2025)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    The CS 4 book (Winter 2025)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/welcome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to CS 4!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/motivation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Motivation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Administrative
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Administrative
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/syllabus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syllabus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/collab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collaboration policies
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignments
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Assignments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0/assignment0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assignment 0: Setup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Readings
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Readings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../readings/ocaml_cheat_sheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OCaml Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../readings/subst/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Substitution Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#priority-queues" class="md-nav__link">
    <span class="md-ellipsis">
      Priority queues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Priority queues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leftist-heaps" class="md-nav__link">
    <span class="md-ellipsis">
      Leftist heaps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#merging-leftist-heaps" class="md-nav__link">
    <span class="md-ellipsis">
      Merging leftist heaps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insertion-and-delete-minimum-element" class="md-nav__link">
    <span class="md-ellipsis">
      Insertion and delete minimum element
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-priorityqueue-module" class="md-nav__link">
    <span class="md-ellipsis">
      1. PriorityQueue module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-makepriorityqueue-functor" class="md-nav__link">
    <span class="md-ellipsis">
      2. MakePriorityQueue functor
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="part-c-modules-and-functors-30-points">Part C: Modules and functors (30 points)</h1>
<p>In this section,
you will work with OCaml modules and functors
by implementing a data structure called a <em>priority queue</em>.
("Queue" is pronounced "kyoo".)
The specific implementation you will create is called a <em>leftist heap</em>.
So let's talk about these things now.</p>
<h2 id="priority-queues">Priority queues</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is a priority queue implementation given in the OCaml manual
as part of the module documentation.
Please don't consult that for this assignment
(the implementations are different anyway).</p>
</div>
<p>A priority queue is a data structure
that is ordered so that it provides fast access to its minimum element,
as defined by some ordering relationship.
Conceptually, you can think of that element as
"the next thing to be processed".
It also has to have an operation which deletes the minimum element
and returns another priority queue
(which would be useful after processing that element),
as well as several other operations,
which are summarized here as an OCaml module type:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">module</span> <span class="k">type</span> <span class="nc">PRIORITY_QUEUE</span> <span class="o">=</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>  <span class="k">sig</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">exception</span> <span class="nc">Empty</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="k">type</span> <span class="n">elem</span>      <span class="c">(* Abstract type of elements of queue. *)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="k">type</span> <span class="n">t</span>         <span class="c">(* Abstract type of queue. *)</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="k">val</span> <span class="n">empty</span>      <span class="o">:</span> <span class="n">t</span>                <span class="c">(* The empty queue.         *)</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="k">val</span> <span class="n">is_empty</span>   <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">bool</span>        <span class="c">(* Check if queue is empty. *)</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="k">val</span> <span class="n">insert</span>     <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">elem</span> <span class="o">-&gt;</span> <span class="n">t</span>   <span class="c">(* Insert item into queue.  *)</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="k">val</span> <span class="n">find_min</span>   <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">elem</span>        <span class="c">(* Return minimum element.  *)</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="k">val</span> <span class="n">delete_min</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span>           <span class="c">(* Delete minimum element.  *)</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="k">val</span> <span class="n">from_list</span>  <span class="o">:</span> <span class="n">elem</span> <span class="kt">list</span> <span class="o">-&gt;</span> <span class="n">t</span>   <span class="c">(* Convert list to queue.   *)</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>  <span class="k">end</span>
</span></code></pre></div>
<p>Of these operations,
note that the operation <code>from_list</code> is not fundamental
to the definition of a priority queue,
but it's useful.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When we refer to "queue" in this section,
we always mean a priority queue,
not a first-in/first-out data structure
which is the usual meaning of the word "queue" in programming.
So here, "queue" is just short for "priority queue".</p>
</div>
<p>Also note that we are being loose about the words "insert" and "delete".
These operations are purely functional,
so that when we say we "insert" an element into a queue,
we really mean that we create a new queue which has the extra element in it;
the original queue is unchanged.
Similarly, when we "delete" an element from a queue,
we really mean that we create a new queue without the offending element;
the original queue is once again unchanged.</p>
<h3 id="leftist-heaps">Leftist heaps</h3>
<p>Now that we know how our data structure is supposed to behave,
the next question is: how do we implement it?
Naturally, there are lots of choices,
each of which will have different trade-offs.
In this section you're going to implement priority queues as <em>leftist heaps</em>.
This is a data structure that has the following attributes:</p>
<ul>
<li>
<p>It can either be a leaf (representing an empty heap)
or a node which contains:</p>
<ul>
<li>a stored element</li>
<li>a non-negative integer value called its "rank"</li>
<li>a left and right subheap, each of which is also a leftist heap</li>
</ul>
<p>Thus, a leftist heap is a binary tree
with additional rank information stored in the nodes.
The tree will in general <strong>not</strong> be balanced;
it will usually have more elements in the left subtree
than in the right.
We say that the tree "skews to the left".</p>
</li>
<li>
<p>The element stored at the top of the tree is smaller
(more precisely, is no larger)
than any of the elements stored beneath it in either subtree.</p>
</li>
<li>
<p>As mentioned, each node has an integer value associated with it,
which is called its <em>rank</em>.
The rank of a node is equal to the length of its <em>right spine</em>,
which is the number of nodes
in the rightmost path from the node in question
to an empty (leaf) node
(this will also turn out to be the shortest path to a leaf node).
Thus, a leaf node has rank 0,
and a heap with a right subheap which is a leaf has rank 1.
However, ranks are only stored in nodes, not in leaves.
Having the rank stored in the nodes makes many operations much faster.</p>
</li>
<li>
<p>The rank of any left child is required to be at least as large
as the rank of its right sibling.
This is why it's called a "leftist" heap.</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be aware that a heap is <em>not</em>
an ordered binary tree in the usual sense.
In other words,
it is <em>not</em> necessarily the case
that all the elements in the left subheap
are smaller than those in the right subheap.
The only requirement is that an element in a node
is smaller than elements in the left <em>and</em> right subheaps of that node.</p>
</div>
<p>The interesting feature of leftist heaps
is that they support very efficient merging of two heaps
to form a combined heap.
(Of course, since we're using purely functional code,
you don't alter the original heaps.)
Leftist heaps can be merged in <span class="arithmatex">\(\Theta(log\ N)\)</span> time,
where <span class="arithmatex">\(N\)</span> is the total number of elements in the resulting heap.</p>
<p>Furthermore, once the merge operation
(which, you'll note, is not a required operation for priority queues)
is implemented,
you can easily define most of the rest of the heap operations in terms of it.
Specifically, you can define the <code>insert</code> and <code>delete_min</code> operations
in terms of merging,
and the other operations are then trivial to define,
except for the list-to-heap conversion routine.
That can be done easily in <span class="arithmatex">\(\Theta(N\ log(N))\)</span> time,
and with more difficulty in <span class="arithmatex">\(\Theta(N)\)</span> time.
(You're not required to find the most efficient solution,
but it's a good exercise.)</p>
<h3 id="merging-leftist-heaps">Merging leftist heaps</h3>
<p>OK, so now we need to figure out
how to merge two leftist heaps to create a new leftist heap.
The basic algorithm is quite simple:</p>
<ul>
<li>
<p>If either heap is empty, return the other heap.</p>
</li>
<li>
<p>If the first heap's minimum element
is smaller than the second heap's minimum element,
make a new heap from the first heap's minimum element,
the first heap's left subheap,
and the result of merging the first heap's right subheap
with the second heap.</p>
</li>
<li>
<p>Otherwise, make a new heap from the second heap's minimum element,
the second heap's left subheap,
and the result of merging the first heap
with the second heap's right subheap.</p>
</li>
</ul>
<p>Here is how to make a new heap from a minimum element and two heaps:
the resulting heap must have:</p>
<ul>
<li>the given minimum element</li>
<li>a rank which is the smaller of the ranks of the original heaps, plus 1</li>
<li>a left subheap which is the original heap with the larger rank</li>
<li>a right subheap which is the original heap with the smaller rank</li>
</ul>
<p>This algorithm will preserve the leftist heap property in the merged heap.</p>
<h3 id="insertion-and-delete-minimum-element">Insertion and delete minimum element</h3>
<p>Once you have the <code>merge</code> operation,
insertion and deletion of the minimum element are simple to implement.</p>
<p>The minimum element will always be at the root of the tree structure
(assuming the tree isn't empty).
If you merge the two subtrees,
their result is the priority queue that corresponds to 
deleting the minimum element.</p>
<p>To insert a new element into the priority queue,
just create a one-element tree and merge it with the existing priority queue.</p>
<p>Here are the problems.</p>
<h2 id="1-priorityqueue-module">1. <code>PriorityQueue</code> module</h2>
<p>[<strong>20 points</strong>]</p>
<p>Write a module <code>PriorityQueue</code>
which implements the <code>PRIORITY_QUEUE</code> module type.
Assume that the <code>elem</code> type will be <code>int</code>.
Here is a template for your code:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">module</span> <span class="nc">PriorityQueue</span> <span class="o">:</span> <span class="o">(</span><span class="nc">PRIORITY_QUEUE</span> <span class="k">with</span> <span class="k">type</span> <span class="n">elem</span> <span class="o">=</span> <span class="kt">int</span><span class="o">)</span> <span class="o">=</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>  <span class="k">struct</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="k">exception</span> <span class="nc">Empty</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    <span class="k">type</span> <span class="n">elem</span> <span class="o">=</span> <span class="kt">int</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    <span class="c">(*</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c">     * Data type: either</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="c">     * -- a Leaf, or</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="c">     * -- a Node of (rank, item, left heap, right heap).</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="c">     *)</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>    <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="nc">Leaf</span> <span class="o">|</span> <span class="nc">Node</span> <span class="k">of</span> <span class="kt">int</span> <span class="o">*</span> <span class="n">elem</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">t</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    <span class="c">(* Your code goes here. *)</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>  <span class="k">end</span>
</span></code></pre></div>
<p>You will need to fill in the definitions for all the module functions
(the functions whose signatures are in the <code>PRIORITY_QUEUE</code> module type).
You can also write additional unexported helper functions in the module,
if that will make things easier.
Make sure you raise the <code>Empty</code> exception when trying to do invalid things
<em>e.g.</em> finding the minimum value in an empty queue.
Don't change the <code>PRIORITY_QUEUE</code> module type!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Based on the discussion given above,
one unexported helper function you will definitely want to implement
is the <code>merge</code> function.</p>
</div>
<p>Note that since the type <code>elem</code> is abstract,
if you want to use a real type
as the elements of your priority queue
(and it would be pretty useless otherwise),
you have to specify which type you want
the <code>PRIORITY_QUEUE</code>'s <code>elem</code> value to represent.
(This is fairly clunky syntax.)
Also, you might ask why you can't just make it parametric,
like a type <code>'a list</code>.
You actually can in some cases,
but here we need a type with an ordering relation,
and there is no way to guarantee
that any arbitrary type will
(a) be orderable at all — what if it's a function type? or
(b) will be orderable using the same function
(<em>e.g.</em> the built-in <code>compare</code> function).
So it's better to write the code as it's written above.
Also, this will make it easy to transform into a functor (see below).</p>
<p>Here's an interesting point to ponder:
why don't we also have to specify
what the abstract priority queue <code>t</code> type represents in the code above?
(You don't have to write down the answer in your code,
but if you can't figure this out, ask a TA.)</p>
<p>Use the built-in (overloaded) comparison function <code>compare</code>
and/or the overloaded comparison operators (<code>&lt;</code>, <code>&gt;</code> <em>etc.</em>)
to do whatever comparisons may need to be done.
This works because OCaml's comparison operators work on any type.
(We'll see a more elegant way to do this below.)</p>
<p>Use your priority queue implementation
to write a <em>heap sort</em> function called <code>heap_sort</code>.
This will take a list of <code>int</code>s as its argument and will</p>
<ul>
<li>
<p>first convert the list to a priority queue
(implemented as a leftist heap)
using the <code>from_list</code> function of the module</p>
</li>
<li>
<p>successively remove the smallest element from the heap
and "cons" it onto (<em>i.e.</em> place it onto the front of)
a list until there are no more items in the heap</p>
</li>
<li>
<p>reverse the list to get a sorted list in ascending order</p>
</li>
</ul>
<p>This function should be defined <em>outside</em> of the <code>PriorityQueue</code> module,
which means that the only functions from that module you can use
are the exported ones
(those whose signatures are in the <code>PRIORITY_QUEUE</code> module type).</p>
<h2 id="2-makepriorityqueue-functor">2. <code>MakePriorityQueue</code> functor</h2>
<p>[<strong>10 points</strong>]</p>
<p>As written, the code is dependent on the built-in comparison functions.
To make this more generic, let's define some types and module types:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c">(* Signature for ordered objects. *)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="k">module</span> <span class="k">type</span> <span class="nc">ORDERED_TYPE</span> <span class="o">=</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>  <span class="k">sig</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="k">type</span> <span class="n">t</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="k">val</span> <span class="n">compare</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>  <span class="k">end</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c">(* Signature for priority queues. *)</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="k">module</span> <span class="k">type</span> <span class="nc">PRIORITY_QUEUE</span> <span class="o">=</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>  <span class="k">sig</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>    <span class="k">exception</span> <span class="nc">Empty</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>    <span class="k">type</span> <span class="n">elem</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>    <span class="k">type</span> <span class="n">t</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>    <span class="k">val</span> <span class="n">empty</span>      <span class="o">:</span> <span class="n">t</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>    <span class="k">val</span> <span class="n">is_empty</span>   <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">bool</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>    <span class="k">val</span> <span class="n">insert</span>     <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">elem</span> <span class="o">-&gt;</span> <span class="n">t</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>    <span class="k">val</span> <span class="n">find_min</span>   <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">elem</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>    <span class="k">val</span> <span class="n">delete_min</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>    <span class="k">val</span> <span class="n">from_list</span>  <span class="o">:</span> <span class="n">elem</span> <span class="kt">list</span> <span class="o">-&gt;</span> <span class="n">t</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>  <span class="k">end</span>
</span></code></pre></div>
<p>What you have to do now is generalize your priority queue implementation
into a functor that takes a module
implementing the <code>ORDERED_TYPE</code> module type as its argument,
and produces a priority queue (implemented using a leftist heap)
which is specialized for that particular type of data.
For instance, you can define a module of ordered strings like this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">module</span> <span class="nc">OrderedString</span> <span class="o">=</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>  <span class="k">struct</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="kt">string</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="k">let</span> <span class="n">compare</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>      <span class="k">if</span> <span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="k">then</span> <span class="mi">0</span> <span class="k">else</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="k">then</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>  <span class="k">end</span>
</span></code></pre></div>
<p>and then define your string priority queue like this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">module</span> <span class="nc">StringPQ</span> <span class="o">=</span> <span class="nc">MakePriorityQueue</span><span class="o">(</span><span class="nc">OrderedString</span><span class="o">)</span>
</span></code></pre></div>
<p>Here, <code>MakePriorityQueue</code> is in fact a functor.
It takes an input module (in this case, <code>OrderedString</code>),
and returns an output module (in this case <code>StringPQ</code>)
which is a priority queue specialized to work only on strings.</p>
<p>Once you've done this,
redefine your heap sort function (again, outside of the <code>StringPQ</code> module)
using a <code>StringPQ</code> as the heap.
Call the new function <code>heap_sort_2</code>.
Note that this heap sort will only work on strings.</p>
<p>To get you started,
here is a skeleton of the code you should use for the functor definition:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">module</span> <span class="nc">MakePriorityQueue</span> <span class="o">(</span><span class="nc">Elt</span> <span class="o">:</span> <span class="nc">ORDERED_TYPE</span><span class="o">)</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>  <span class="o">:</span> <span class="o">(</span><span class="nc">PRIORITY_QUEUE</span> <span class="k">with</span> <span class="k">type</span> <span class="n">elem</span> <span class="o">=</span> <span class="nn">Elt</span><span class="p">.</span><span class="n">t</span><span class="o">)</span> <span class="o">=</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>  <span class="k">struct</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    <span class="c">(* Your code goes here... *)</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>  <span class="k">end</span>
</span></code></pre></div>
<p>Note that again you have to specify
what the type <code>elem</code> in the <code>PRIORITY_QUEUE</code> represents.
Here, it had better be the same type
as the type <code>t</code> in the <code>ORDERED_TYPE</code> argument
(which we have called <code>Elt</code>).</p>
<p>This code will be nearly identical to the code above.
All you are really doing is repackaging that code into a functor.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.footer", "navigation.top"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="../../../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>