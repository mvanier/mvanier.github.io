
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mvanier.github.io/cs131/Spring2024/book/assignments/4/partA_implementing_arrays/">
      
      
        <link rel="prev" href="../assignment4/">
      
      
        <link rel="next" href="../partB_implementing_local_variables/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>Part A: Implementing arrays - The CS 131 book (Spring 2024)</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#part-a-implementing-arrays-55-points" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="The CS 131 book (Spring 2024)" class="md-header__button md-logo" aria-label="The CS 131 book (Spring 2024)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The CS 131 book (Spring 2024)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Part A: Implementing arrays
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to medium mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to medium mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="medium" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="The CS 131 book (Spring 2024)" class="md-nav__button md-logo" aria-label="The CS 131 book (Spring 2024)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    The CS 131 book (Spring 2024)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/welcome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to CS 131!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installing the course software
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../lectures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lecture slides
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Administrative
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Administrative
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/syllabus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syllabus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/collab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collaboration policies
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignment 1: The Imp language
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Assignment 1: The Imp language
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1/assignment1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1/partA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part A: Programming in Imp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1/partB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part B: Extending Imp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1/partC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part C: Programming in extended Imp
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignment 2: The uScheme language
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Assignment 2: The uScheme language
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2/assignment2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2/debugging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debugging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2/partA_extending1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part A: Finishing and extending uScheme: parsing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2/partB_extending2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part B: Finishing and extending uScheme: evaluation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2/partC_programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part C: Programming in extended uScheme
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignment 3: The uScheme+ language
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Assignment 3: The uScheme+ language
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3/assignment3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3/partA_control_operators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part A: Implementing control operators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3/partB_tail_calls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part B: Implementing tail call optimization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignment 4: The Typed Imp language
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Assignment 4: The Typed Imp language
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignment4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Part A: Implementing arrays
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Part A: Implementing arrays
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#array-forms" class="md-nav__link">
    <span class="md-ellipsis">
      Array forms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-adding-syntactic-support-for-arrays" class="md-nav__link">
    <span class="md-ellipsis">
      1. Adding syntactic support for arrays
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-adding-array-values" class="md-nav__link">
    <span class="md-ellipsis">
      2. Adding array values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-adding-array-related-error-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      3. Adding array-related error conditions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-adding-type-checking-code-for-array-forms" class="md-nav__link">
    <span class="md-ellipsis">
      4. Adding type checking code for array forms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-adding-evaluator-code-for-array-forms" class="md-nav__link">
    <span class="md-ellipsis">
      5. Adding evaluator code for array forms
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../partB_implementing_local_variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part B: Implementing local variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../partC_functions_with_arrays_and_locals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part C: Writing functions with arrays and locals
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignment 5: The Typed uScheme language
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Assignment 5: The Typed uScheme language
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5/assignment5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5/partA_substitution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part A: Implementing capture-avoiding substitution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../5/partB_type_checking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part B: Implementing the type checker
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#array-forms" class="md-nav__link">
    <span class="md-ellipsis">
      Array forms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-adding-syntactic-support-for-arrays" class="md-nav__link">
    <span class="md-ellipsis">
      1. Adding syntactic support for arrays
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-adding-array-values" class="md-nav__link">
    <span class="md-ellipsis">
      2. Adding array values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-adding-array-related-error-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      3. Adding array-related error conditions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-adding-type-checking-code-for-array-forms" class="md-nav__link">
    <span class="md-ellipsis">
      4. Adding type checking code for array forms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-adding-evaluator-code-for-array-forms" class="md-nav__link">
    <span class="md-ellipsis">
      5. Adding evaluator code for array forms
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="part-a-implementing-arrays-55-points">Part A: Implementing arrays (55 points)</h1>
<p>Implementing arrays naturally divides into several steps,
which we describe below.</p>
<h2 id="array-forms">Array forms</h2>
<p>Here are the array forms you'll be implementing:</p>
<ul>
<li>
<p><code>make-array</code></p>
<p>This takes two arguments: an integer
(representing the length of the resulting array) and a value,
and creates an array of the given length
where each element equals the value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the value being replicated into the array
is itself an array,
you are <em>not</em> required to make unique copies of the value;
it's OK to just do a reference copy.
Making unique copies is desirable but tricky.
If you do want to attempt it,
you may find the <code>Array.init</code> function to be helpful,
and we suggest that you define a <code>deepcopy</code> function
that computes a deep copy of a <code>value</code>.</p>
</div>
</li>
<li>
<p><code>array-at</code></p>
<p>This takes two arguments: an array and an integer index.
It returns the element at the index.
If the index is out of range,
an <code>IndexError</code> is raised
using the <code>index_err</code> function you will define below.</p>
</li>
<li>
<p><code>array-put</code></p>
<p>This takes three arguments: an array, an integer index, and a value.
It sets the element at the given index of the array to the value.
If the index is out of range,
an <code>IndexError</code> is raised using the <code>index_err</code> function
you will define below.
<code>array-put</code> returns a unit value (<code>#u</code>).</p>
</li>
<li>
<p><code>array-size</code></p>
<p>This takes one argument (an array),
and returns the length of the array.</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We call these "forms" instead of "functions"
because they are language constructs,
even though they are effectively built-in functions.
They can't be defined as functions in the language
because of the limitations of the <em>Typed Imp</em> type system,
as we've described
(all of these are <em>polymorphic</em> operations,
which means they can act on more than one type).</p>
</div>
<h2 id="1-adding-syntactic-support-for-arrays">1. Adding syntactic support for arrays</h2>
<p>[<strong>10 points</strong>]</p>
<p>Files to edit:</p>
<ul>
<li><code>ast.ml</code></li>
<li><code>ast.mli</code></li>
</ul>
<p>You will need to modify
the abstract syntax types <code>imp_type</code> and <code>exp</code>
to incorporate the array forms.
Here are the modifications:</p>
<ul>
<li>
<p><code>imp_type</code> gets another constructor <code>ArrayType of imp_type</code>
which represents all array types.</p>
</li>
<li>
<p><code>exp</code> gets new constructors
<code>ArrayMake</code>, <code>ArrayAt</code>, <code>ArrayPut</code>, and <code>ArraySize</code>,
corresponding to the expressions
<code>make-array</code>, <code>array-at</code>, <code>array-put</code>, and <code>array-size</code>.
Each constructor gets a <code>loc</code> field
and however many <code>exp</code> fields are needed.
Note that the non-<code>loc</code> arguments of the form are all expressions,
and not <em>e.g.</em> integers,
even if the expression needs to evaluate to an integer.</p>
</li>
</ul>
<p>While you're at it,
make sure you update the <code>loc_of_exp</code> function
so it works for array forms too.
(The compiler will remind you if you forget.)</p>
<p>Then you will have to modify the code
that converts from S-expressions to AST forms.
Here are the steps:</p>
<ul>
<li>
<p>Add the names of the array forms
(<code>make-array</code>, <code>array-at</code>, <code>array-put</code>, and <code>array-size</code>)
to the <code>keywords</code> list.
Also add the type constructor name <code>array</code> to the <code>reserved_ids</code> list.</p>
</li>
<li>
<p>Modify the <code>parse_expr</code> function
to correctly parse all four array forms.
Note that an array form with the wrong number of subexpressions
should result in a syntax error.
Use the other forms handled by the function as models.</p>
</li>
<li>
<p>Modify the <code>parse_type</code> function
to correctly parse array types
(<em>e.g.</em> <code>(array int)</code> or <code>(array (array bool))</code>).</p>
</li>
</ul>
<h2 id="2-adding-array-values">2. Adding array values</h2>
<p>[<strong>10 points</strong>]</p>
<p>Files to edit:</p>
<ul>
<li><code>value.ml</code></li>
<li><code>value.mli</code></li>
</ul>
<p>Modify the <code>value</code> type by adding the array constructor:
<code>Array of value array</code>.
Also modify the <code>string_of_value</code> function
so that it works for arrays as well.
The string representation for an array
puts the array values inside a pair of square brackets.
For instance:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>$ ./typed_imp
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>&gt;&gt;&gt; (make-array 10 0)
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>[0 0 0 0 0 0 0 0 0 0] : (array int)
</span></code></pre></div>
<p>Here, the string representation of the array is <code>[0 0 0 0 0 0 0 0 0 0]</code>.
The <code>(array int)</code> part is the string representation of the array type,
which we'll get to below.</p>
<p>Also modify the function <code>equal_values</code> so that it works for arrays as well.
The algorithm for array equality is simple:
two arrays are equal if they have the same length
and if each of the corresponding elements are equal
in the <code>equal_values</code> sense.
You will probably want to make the <code>equal_values</code> function recursive.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not implement the <code>equal_values</code> function
just by using the <code>=</code> operator
even though equality is polymorphic in OCaml.
<code>equal_values</code> needs to check
that the types of the two values are the same,
even though the type checker should catch it if they aren't.
So if <code>equal_values</code> is ever called with two arguments
which aren't of the same type,
there is a bug in the type checker
and the <code>BugInTypeChecker</code> error must be raised
(using the <code>Error.bug_in_type_checker</code> function).</p>
</div>
<h2 id="3-adding-array-related-error-conditions">3. Adding array-related error conditions</h2>
<p>[<strong>10 points</strong>]</p>
<p>Files to edit:</p>
<ul>
<li><code>error.ml</code></li>
<li><code>error.mli</code></li>
</ul>
<p>When your programming language supports arrays, there is always the chance
that a program will try to access or modify array elements
whose index is outside the range of allowable indices.
Our arrays have indices that start at 0
and go up to one less than the length of the array;
anything outside that range can't be accessed.
Modify the <code>error_tag</code> type in <code>error.ml</code> by adding this constructor:
<code>IndexError of int</code>.
This represents an invalid access/modification,
and the argument is the invalid integer index.
Since we don't want other modules to have to use this type directly,
add a new function <code>index_err</code>
which is modeled after the other <code>XXX_err</code> functions in the <code>Error</code> module.
This function takes a source code location and an <code>int</code>
and raises an <code>Imp_err</code> exception corresponding to an <code>IndexError</code>.
Also modify the <code>print_err</code> function so it also works on <code>IndexError</code>s.</p>
<h2 id="4-adding-type-checking-code-for-array-forms">4. Adding type checking code for array forms</h2>
<p>[<strong>15 points</strong>]</p>
<p>File to edit:</p>
<ul>
<li><code>typecheck.ml</code></li>
</ul>
<p>First, do a couple of simple things.
Modify the <code>string_of_type</code> function
so it converts array types to strings too.
Modify the <code>ty_eq</code> function so it works on array types too.</p>
<p>Now modify the type-checking code in <code>typecheck_expr</code>
to work on all four array forms.
Use the operational semantics from lecture 13 as your guide.
This code is very straightforward to write.
Make sure all arguments to each form are typechecked,
and make sure that arguments with expected types (<em>e.g.</em> <code>int</code>)
do in fact have those types.
Again, use the existing code as a model.
Make sure each form returns the correct type.</p>
<h2 id="5-adding-evaluator-code-for-array-forms">5. Adding evaluator code for array forms</h2>
<p>[<strong>10 points</strong>]</p>
<p>File to edit:</p>
<ul>
<li><code>eval.ml</code></li>
</ul>
<p>First of all, note that the arguments to the array forms
are often required to be either arrays or integers.
If type checking has been successful,
the expressions in these positions will always have the right types.
However, if the type checker has bugs, they may not.
Even if they do have the right types,
you still have to extract the array or integer from a <code>value</code>.
Write two functions called <code>to_int</code> and <code>to_array</code>
which each take two arguments (a code location and a <code>value</code>)
and return an <code>int</code> or an array, respectively.
If they can't convert the argument to the right type,
they should raise an exception
using the <code>Error.bug_in_type_checker</code> function.</p>
<p>Once this is done,
extend the <code>eval_expr</code> function with cases for the array constructors
(<code>ArrayMake</code>, <code>ArrayAt</code>, <code>ArrayPut</code>, <code>ArraySize</code>),
so that they implement the semantics described above.
When an argument needs to be an array or an integer,
use the <code>to_array</code> or <code>to_int</code> function, respectively.
Make sure to update environments after evaluating each subexpression;
remember that a subexpression
can contain <code>set</code> expressions that mutate the environment.
Catch array-out-of-bounds errors when they can occur
and use <code>Error.index_err</code> to raise the corresponding exception.
You'll find all the functions you need
to implement array functionality in the OCaml <code>Array</code> module.
Make sure the return value of <code>ArrayPut</code> is <code>#u</code>.</p>
<p>Once all of these features have been implemented,
all of the test scripts except for <code>locals</code> and <code>lab4</code> should work.
Implementing local variables is the topic of the next section.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../assignment4/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Overview">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Overview
              </div>
            </div>
          </a>
        
        
          
          <a href="../partB_implementing_local_variables/" class="md-footer__link md-footer__link--next" aria-label="Next: Part B: Implementing local variables">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Part B: Implementing local variables
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.footer", "navigation.top"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="../../../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>