
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mvanier.github.io/cs131/Spring2025/book/assignments/5/partB_type_checking/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Part B: Implementing the type checker (50 points) - The CS 131 book (Spring 2025)</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#part-b-implementing-the-type-checker-50-points" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="The CS 131 book (Spring 2025)" class="md-header__button md-logo" aria-label="The CS 131 book (Spring 2025)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The CS 131 book (Spring 2025)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Part B: Implementing the type checker (50 points)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to medium mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to medium mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="medium" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="The CS 131 book (Spring 2025)" class="md-nav__button md-logo" aria-label="The CS 131 book (Spring 2025)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    The CS 131 book (Spring 2025)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/welcome/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome to CS 131!
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installing the course software
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../lectures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture slides
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Administrative
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Administrative
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/syllabus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Syllabus
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/collab/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Collaboration policies
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-typecheck_expr" class="md-nav__link">
    <span class="md-ellipsis">
      1. typecheck_expr
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. typecheck_expr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lambda" class="md-nav__link">
    <span class="md-ellipsis">
      Lambda
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typeapply" class="md-nav__link">
    <span class="md-ellipsis">
      TypeApply
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typelambda" class="md-nav__link">
    <span class="md-ellipsis">
      TypeLambda
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-appears_unprotected_in" class="md-nav__link">
    <span class="md-ellipsis">
      2. appears_unprotected_in
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-typecheck_valrec" class="md-nav__link">
    <span class="md-ellipsis">
      3. typecheck_valrec
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="part-b-implementing-the-type-checker-50-points">Part B: Implementing the type checker (50 points)</h1>
<p>The code you will write for this section is in the <code>Typecheck</code> module,
which consists of the files <code>typecheck.ml</code> and <code>typecheck.mli</code>. You
will only have to modify the <code>typecheck.ml</code> file. In that file you are
provided with a partial implementation of the type checker. You have to
complete the definition of the following functions:</p>
<ul>
<li>
<p><code>typecheck_expr</code></p>
</li>
<li>
<p><code>appears_unprotected_in</code></p>
</li>
<li>
<p><code>typecheck_valrec</code></p>
</li>
</ul>
<p>We describe these three functions below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Makes sure that you read through the code that is provided for you!
There are lots of useful helper functions defined that will make your
code much more concise and understandable if you use them. In
particular, the <code>assert_types_equal</code> function is extremely useful.</p>
</div>
<h2 id="1-typecheck_expr">1. <code>typecheck_expr</code></h2>
<p>[<strong>20 points</strong>]</p>
<p>This is the main type checking function. It takes in three arguments:</p>
<ol>
<li>
<p>a kind environment mapping type names to their kinds (also known as
   <span class="arithmatex">\(\Delta\)</span>)</p>
</li>
<li>
<p>a type environment mapping variable names to their types (also known
   as <span class="arithmatex">\(\Gamma\)</span>)</p>
</li>
<li>
<p>an expression to be type checked</p>
</li>
</ol>
<p>and returns the type of the expression. If there is a type error, a
suitable exception is raised.</p>
<p>Most of the cases are just translations into code of the operational
semantics of type checking described in lecture 17. There are a few
cases that are a bit more subtle, so we discuss them here.</p>
<h3 id="lambda"><code>Lambda</code></h3>
<p>Remember that all the formal argument types are required to have the
kind <code>*</code>.</p>
<h3 id="typeapply"><code>TypeApply</code></h3>
<p>This case can (and should) be written in a single line by taking
advantage of the <code>Subst</code> module.</p>
<h3 id="typelambda"><code>TypeLambda</code></h3>
<p>This is the only slightly tricky case. The operational semantics for
<code>TypeLambda</code> given in lecture 17 talks about picking new type
variables if any of the type variables exist in the type environment
<span class="arithmatex">\(\Gamma\)</span>. That makes sense in an operational semantics, because we are
describing how to derive a proof of the type-correctness of a
<code>type-lambda</code> expression given the correctness of its parts. Here we
are working in the opposite direction; we are given a particular
<code>type-lambda</code> and want to know what its type is. Instead of trying to
rename it to be compatible with the type environment, we choose a
simpler solution and simply don't allow <code>type-lambda</code> expressions
whose type variables are present in <span class="arithmatex">\(\Gamma\)</span>.<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup> If any of the
<code>type-lambda</code> type variables are present in <span class="arithmatex">\(\Gamma\)</span>, simply raise a
type error exception with the error message
<code>"type-lambda type variables are free in type environment"</code>. Then the
programmer can manually rename the type variables as necessary so that
everything type checks.</p>
<p>You'll find that the <code>free_tyvars_gamma</code> function from the <code>Subst</code>
module is useful here.</p>
<p>The other subtle issue here is that when checking the body of a
<code>type-lambda</code> expression, the kind environment <span class="arithmatex">\(\Delta\)</span> must be
extended with the type variable names, each of which must have the kind
<code>*</code>. (This kind is represented in the code as <code>Type</code>.) The body is
then typechecked in this new kind environment, and then the type of the
entire <code>type-lambda</code> expression is returned as a <code>ForAll</code> type.</p>
<h2 id="2-appears_unprotected_in">2. <code>appears_unprotected_in</code></h2>
<p>[<strong>15 points</strong>]</p>
<p>We know that the <code>val-rec</code> definition form is almost always used to
define a recursive function, where the function being defined is
referenced inside the body of the definition. However, nothing actually
requires us to do that. We could use <code>val-rec</code> to define simple
variables, for instance:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">(</span><span class="k">val</span><span class="o">-</span><span class="k">rec</span> <span class="kt">int</span> <span class="n">x</span> <span class="mi">10</span><span class="o">)</span>
</span></code></pre></div>
<p>and there's nothing wrong with that. However, we should disallow uses of
the name being defined (here, <code>x</code>) if they are used outside of a
<code>lambda</code> expression, since then you have a self-referential definition
which can never terminate when evaluated. That would be something like
this:</p>
<div class="language-ocaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">(</span><span class="k">val</span><span class="o">-</span><span class="k">rec</span> <span class="kt">int</span> <span class="n">x</span> <span class="o">(+</span> <span class="n">x</span> <span class="mi">1</span><span class="o">))</span>
</span></code></pre></div>
<p>We refer to errors of this sort as the defined name (here, <code>x</code>)
appearing "unprotected" in the body of the definition (here,
<code>(+ x 1)</code>). The "unprotected" means "not occurring inside a <code>lambda</code>
expression" since a <code>lambda</code> expression delays evaluation of the
name.<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup></p>
<p>We define the function <code>appears_unprotected_in</code> which takes two
arguments: a variable name and a (value) expression. It returns <code>true</code>
if the name appears unprotected in the expression, and otherwise returns
<code>false</code>. The basic rules for this are:</p>
<ol>
<li>
<p>Any name inside a <code>lambda</code> expression is protected.</p>
</li>
<li>
<p>Any literal has no unprotected names inside it.</p>
</li>
<li>
<p>A <code>let</code> or <code>let*</code> expression's bound variables are not unprotected
   inside the scope of the bound variables.</p>
<p>For example, in this expression:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>(val-rec int x (let ([x 0]) x))
</span></code></pre></div>
<p>the <code>x</code> in the <code>(let ([x 0]) x)</code> is not the same
 as the first <code>x</code> (the name of the function),
 since it is bound in the <code>let</code> expression
 (<em>i.e.</em> it's inside the scope of the <code>let</code>).
 This function is equivalent to</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>(val-rec int x 0)
</span></code></pre></div>
<p>which shows that the <code>x</code> function doesn't refer to itself
 outside of a <code>lambda</code> expression.</p>
</li>
<li>
<p>A name is unprotected in a variable
   if the variable name is the same as the name.</p>
</li>
<li>
<p>A name is unprotected in any other expression with subexpressions
   if it's unprotected in <em>any</em> of the subexpressions.</p>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some care is required when handling <code>let</code> and <code>let*</code> expressions.
For <code>let</code>, the algorithm goes like this:</p>
<ol>
<li>
<p>If the name is unprotected in any of the binding expressions,
it's unprotected in the entire <code>let</code>.</p>
</li>
<li>
<p>Otherwise,
if the name is the same as one of the binding names of the <code>let</code>, 
it's <em>not</em> unprotected in the entire <code>let</code>
(because the <code>let</code>-binding shadows the name).</p>
</li>
<li>
<p>Otherwise, check the body of the <code>let</code>.</p>
</li>
</ol>
<p>For <code>let*</code>, treat the first binding like a one-binding <code>let</code>,
and for the body, create a new <code>let*</code> expression
containing all but the first binding and recursively check that.
(This is equivalent to desugaring the <code>let*</code> expression
to a sequence of nested <code>let</code> expressions.)</p>
</div>
<p>This code is a straightforward case analysis on the structure of value
expressions. There is an extensive test suite to make sure that you
don't miss any cases. This function is (obviously) going to be used in
the <code>val-rec</code> type checking code, which we now turn to.</p>
<h2 id="3-typecheck_valrec">3. <code>typecheck_valrec</code></h2>
<p>[<strong>15 points</strong>]</p>
<p>This function type checks <code>val-rec</code> expressions. It's a simple code
translation of the operational semantics of <code>val-rec</code> given in lecture
17. A partial implementation is provided.</p>
<p>[End of assignment]</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>You might wonder how "real" languages handle this problem.
You should keep on wondering, since almost no "real" language
I know of actually has a <code>type-lambda</code> expression
(except Scala, and Scala is pretty complicated even without type lambdas).
Instead, real languages use <em>type inference</em>
to get rid of the need for <code>type-lambda</code> expressions.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Note that this doesn't rule out definitions of functions
which never terminate,
but it does rule out some obviously incorrect cases.&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.footer", "navigation.top"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>