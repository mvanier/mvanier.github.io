
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mvanier.github.io/cs115/Spring2025/book/assignments/3/partA_exercises/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Part A: Basic exercises (40 points) - The CS 115 book (Spring 2025)</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#part-a-basic-exercises-40-points" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="The CS 115 book (Spring 2025)" class="md-header__button md-logo" aria-label="The CS 115 book (Spring 2025)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The CS 115 book (Spring 2025)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Part A: Basic exercises (40 points)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to medium mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to medium mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="medium" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="The CS 115 book (Spring 2025)" class="md-nav__button md-logo" aria-label="The CS 115 book (Spring 2025)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    The CS 115 book (Spring 2025)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/welcome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to CS 115!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installing the course software
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/books/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Books and resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro/papers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interesting papers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Administrative
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Administrative
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/syllabus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syllabus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../admin/collab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collaboration policies
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignments
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Assignments
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0/assignment0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assignment 0: Getting set up
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Assignment 1: Evaluation and recursion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Assignment 1: Evaluation and recursion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1/assignment1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1/partA_exercises/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part A: Exercises
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1/partB_pitfalls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part B: Pitfalls
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1/partC_evaluation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part C: Evaluation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-eq-and-show-for-nat1" class="md-nav__link">
    <span class="md-ellipsis">
      1. Eq and Show for Nat1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-deriving-eq-and-show-for-nat2" class="md-nav__link">
    <span class="md-ellipsis">
      2. Deriving Eq and Show for Nat2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-ord-for-nat2" class="md-nav__link">
    <span class="md-ellipsis">
      3. Ord for Nat2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-eq-and-ord-for-signednat" class="md-nav__link">
    <span class="md-ellipsis">
      4. Eq and Ord for SignedNat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-num-for-signednat" class="md-nav__link">
    <span class="md-ellipsis">
      5. Num for SignedNat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-signednattointeger" class="md-nav__link">
    <span class="md-ellipsis">
      6. signedNatToInteger
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-unaryinteger" class="md-nav__link">
    <span class="md-ellipsis">
      7. UnaryInteger
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-generic-factorial" class="md-nav__link">
    <span class="md-ellipsis">
      8. Generic factorial
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="part-a-basic-exercises-40-points">Part A: Basic exercises (40 points)</h1>
<p>This assignment is mainly concerned
with algebraic data types and type classes.
In this section, we will do some exercises involving
the <code>Eq</code>, <code>Ord</code> and <code>Num</code> type classes.
There is also a test script for this section (see below),
which you should run to see if your code works correctly
before submitting your assignment.</p>
<h2 id="1-eq-and-show-for-nat1">1. <code>Eq</code> and <code>Show</code> for <code>Nat1</code></h2>
<p>[<strong>5 points</strong>]</p>
<p>In class, we saw the definition of
a simple algebraic data type for natural numbers:</p>
<div class="language-haskell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kr">data</span><span class="w"> </span><span class="kt">Nat</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Zero</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kt">Succ</span><span class="w"> </span><span class="kt">Nat</span>
</span></code></pre></div>
<p>We'll be creating our own variants of this type
to experiment with type class instances.
First, we'll write the <code>Nat1</code> type:</p>
<div class="language-haskell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kr">data</span><span class="w"> </span><span class="kt">Nat1</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Zero1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kt">Succ1</span><span class="w"> </span><span class="kt">Nat1</span>
</span></code></pre></div>
<p>Write out manual definitions of instances
of the <code>Eq</code> and <code>Show</code> type classes for <code>Nat1</code>.
Make sure that <code>show (Succ1 Zero1)</code> returns <code>"Succ1 Zero1"</code>
and not <em>e.g.</em> <code>"Succ1 (Zero1)"</code>.
For larger numbers,
put parentheses around all arguments to <code>Succ1</code> except for <code>Zero1</code>
(for instance <code>Succ1 (Succ1 Zero1)</code> for 2.)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this and all the problems
involving <code>Nat</code> and <code>Nat</code>-like types in this section,
<em>do not</em> convert your <code>Nat</code>s (or related types)
to integers (or to other <code>Nat</code>-like types)
and do the required operations on the other type
unless we specifically say to do so.
In fact, the only time we will allow this is when the problem is
to convert a <code>Nat</code> (or related types) to integers.
If you violate this rule, you will get no credit for those problems.</p>
</div>
<h2 id="2-deriving-eq-and-show-for-nat2">2. Deriving <code>Eq</code> and <code>Show</code> for <code>Nat2</code></h2>
<p>[<strong>2 points</strong>]</p>
<p>Next, we'll define the <code>Nat2</code> type:</p>
<div class="language-haskell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kr">data</span><span class="w"> </span><span class="kt">Nat2</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Zero2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kt">Succ2</span><span class="w"> </span><span class="kt">Nat2</span>
</span></code></pre></div>
<p>Make Haskell derive the <code>Eq</code> and <code>Show</code> instances for <code>Nat2</code>
by adding a <code>deriving</code> annotation to this type.</p>
<h2 id="3-ord-for-nat2">3. <code>Ord</code> for <code>Nat2</code></h2>
<p>[<strong>3 points</strong>]</p>
<p>Write out an explicit instance definition
of the <code>Ord</code> type class for the <code>Nat2</code> type.
This can be done with a single method definition (for the <code>&lt;=</code> operator)
since all other <code>Ord</code> methods can be defined in terms of <code>&lt;=</code>.</p>
<p>Also, note that if we wanted,
we could have Haskell derive the <code>Ord</code> instance for us.
Sometimes this will give us the definition we want, and sometimes it won't.
Will it work in this case? Why or why not?
(Include your answer in a comment.)</p>
<h2 id="4-eq-and-ord-for-signednat">4. <code>Eq</code> and <code>Ord</code> for <code>SignedNat</code></h2>
<p>[<strong>5 points</strong>]</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the rest of this section, we'll be using the <code>Nat</code> type defined as:</p>
<div class="language-haskell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kr">data</span><span class="w"> </span><span class="kt">Nat</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Zero</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kt">Succ</span><span class="w"> </span><span class="kt">Nat</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">  </span><span class="kr">deriving</span><span class="w"> </span><span class="p">(</span><span class="kt">Eq</span><span class="p">,</span><span class="w"> </span><span class="kt">Show</span><span class="p">,</span><span class="w"> </span><span class="kt">Ord</span><span class="p">)</span>
</span></code></pre></div>
<p>Make sure you include this code in your submission.</p>
</div>
<p>Let's say we would like to represent negative numbers
as well as natural numbers,
while keeping a unary representation.
I'm not sure why we would want this, but let's say we do.
We define this datatype:</p>
<div class="language-haskell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kr">data</span><span class="w"> </span><span class="kt">SignedNat</span><span class="w"> </span><span class="ow">=</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span><span class="kt">Neg</span><span class="w"> </span><span class="kt">Nat</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kt">Pos</span><span class="w"> </span><span class="kt">Nat</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span><span class="kr">deriving</span><span class="w"> </span><span class="p">(</span><span class="kt">Show</span><span class="p">)</span>
</span></code></pre></div>
<p>The <code>Eq</code> and <code>Ord</code> instances for <code>Nat</code> exist
(since we're deriving them).
Write out the <code>Eq</code> and <code>Ord</code> instance definitions
for the <code>SignedNat</code> type.
Could you just use automatically-derived definitions
for the <code>Eq</code> and <code>Ord</code> instances?
Write the answer in a comment.</p>
<h2 id="5-num-for-signednat">5. <code>Num</code> for <code>SignedNat</code></h2>
<p>[<strong>10 points</strong>]</p>
<p>Write out the <code>Num</code> instance definition for <code>SignedNat</code>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ul>
<li>
<p>For details on the <code>Num</code> methods see
<a href="https://hackage.haskell.org/package/base-4.19.1.0/docs/GHC-Num.html#t:Num">this page</a>
(It's actually more detail than you need.)</p>
</li>
<li>
<p>Note that <code>signum n</code> should be <code>-1</code> if <code>n &lt; 0</code>,
<code>0</code> if <code>n == 0</code>, and <code>+1</code> if <code>n &gt; 0</code>,
where <code>-1</code>, <code>0</code>, and <code>1</code> are expressed
as their <code>SignedNat</code> equivalents.</p>
</li>
<li>
<p>A clean way to do this for longer method definitions
is to implement the <code>Num</code> methods
as separate stand-alone functions
<em>e.g.</em> <code>addSignedNat</code>, <code>mulSignedNat</code> <em>etc.</em>
and then write the instance definition
by referring to those functions.
Also note that you don't have to implement all 7 <code>Num</code> methods;
specifically, you only have to implement one of (<code>(-)</code>, <code>negate</code>)
because the other can be defined trivially in terms of it.</p>
</li>
<li>
<p>Beware of subtle problems involving zero.</p>
</li>
<li>
<p>You'll probably find it useful
to define some helper functions
to do arithmetic operation on <code>Nat</code>s.</p>
</li>
<li>
<p>Watch out for compiler warnings about non-exhaustive pattern matches!
It's easy to miss cases.</p>
</li>
</ul>
</div>
<h2 id="6-signednattointeger">6. <code>signedNatToInteger</code></h2>
<p>[<strong>5 points</strong>]</p>
<p>Write a function called <code>signedNatToInteger</code>
which converts a <code>signedNat</code> value to an <code>Integer</code>,
as the name suggests.
This is used by the test suite.</p>
<p>Of course, here you are allowed (required)
to convert <code>Nat</code>s and <code>signedNat</code>s to integers.</p>
<h2 id="7-unaryinteger">7. <code>UnaryInteger</code></h2>
<p>[<strong>5 points</strong>]</p>
<p>Is there anything about the <code>SignedNat</code> datatype
that strikes you as a bit ugly and redundant?
Come up with a different datatype
to represent positive and negative integers
called <code>UnaryInteger</code> in the spirit of <code>Nat</code> (<em>i.e.</em> a unary encoding)
that doesn't have this redundancy.
Does it have any other problems?
Can you think of a way to fix even those problems,
possibly at the cost of increased complexity?</p>
<p>The purpose of this exercise
is to illustrate the fact that designing datatypes involves tradeoffs,
and it's not always possible to do a perfect job.
In particular,
there are invariants that you may want Haskell to enforce
that Haskell can't enforce.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For this problem, we're not demanding
that you come up with the exact datatypes we did,
just that you try some alternatives
and think about the problems that come up.</p>
<p>Also, note that you don't have to implement
the new datatype's operations.
Just write up the <code>data</code> declarations
and describe them in words in a comment.</p>
</div>
<h2 id="8-generic-factorial">8. Generic <code>factorial</code></h2>
<p>[<strong>5 points</strong>]</p>
<p>Write a definition of the factorial function called <code>factorial</code>
which will work for any instance of <code>Num</code> and <code>Ord</code>.
Make sure that it reports an error when given a negative number.
Verify that it works for the <code>SignedNat</code> datatype
by computing the result of
<code>factorial (Pos (Succ (Succ (Succ Zero))))</code>.
Write the answer in a comment.
(You don't have to do a manual evaluation;
just enter the expression into <code>ghci</code> and write the result.)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Remember that integer literals can represent <em>any</em> type
which is an instance of the <code>Num</code> type class.</p>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.footer", "navigation.top"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="../../../js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>