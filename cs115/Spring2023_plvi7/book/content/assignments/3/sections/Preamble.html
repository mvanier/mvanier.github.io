<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Preamble &mdash; The CS 115 book</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../_static/clipboard.min.js"></script>
        <script src="../../../../_static/copybutton.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Part A: Basic exercises" href="partA_exercises.html" />
    <link rel="prev" title="Assignment 3: A touch of class" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            The CS 115 book, Spring 2023
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Software.html">Installing the course software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../admin/index.html">Administrative information</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Assignments</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../1/index.html">Assignment 1: Evaluation and recursion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2/index.html">Assignment 2: Algebraic datatypes</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Assignment 3: A touch of class</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Preamble</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#due-date">Due date</a></li>
<li class="toctree-l4"><a class="reference internal" href="#coverage">Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#grading-update">Grading update</a></li>
<li class="toctree-l4"><a class="reference internal" href="#what-to-hand-in">What to hand in</a></li>
<li class="toctree-l4"><a class="reference internal" href="#writing-and-testing-your-code">Writing and testing your code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#haskell-note-infinite-loops-in-tests">Haskell note: Infinite loops in tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="#haskell-note-the-scopedtypevariables-pragma">Haskell note: The <code class="docutils literal notranslate"><span class="pre">ScopedTypeVariables</span></code> pragma</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="partA_exercises.html">Part A: Basic exercises</a></li>
<li class="toctree-l3"><a class="reference internal" href="partB_operators.html">Part B: Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="partC_sparse_matrices.html">Part C: Miniproject: Sparse Matrices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../4/index.html">Assignment 4: <code class="docutils literal notranslate"><span class="pre">IO</span></code>, <code class="docutils literal notranslate"><span class="pre">IO</span></code>, it’s off to work we go!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../5/index.html">Assignment 5: Monads and lists, oh my!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../6/index.html">Assignment 6: Fun with parsing</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">The CS 115 book, Spring 2023</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Assignments</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Assignment 3: A touch of class</a></li>
      <li class="breadcrumb-item active">Preamble</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="preamble">
<h1>Preamble<a class="headerlink" href="#preamble" title="Permalink to this heading"></a></h1>
<section id="due-date">
<h2>Due date<a class="headerlink" href="#due-date" title="Permalink to this heading"></a></h2>
<p>This assignment is due on Friday, May 5th at 2 AM.</p>
</section>
<section id="coverage">
<h2>Coverage<a class="headerlink" href="#coverage" title="Permalink to this heading"></a></h2>
<p>This assignment covers the material up to lecture 8.</p>
</section>
<section id="grading-update">
<h2>Grading update<a class="headerlink" href="#grading-update" title="Permalink to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For this and future assignments,
point values of each problem will be indicated.
Each section will still be worth 10 points,
and the overall grade will still be the average of the section scores.
This will make it easier to see which problems are worth how much.</p>
</div>
</section>
<section id="what-to-hand-in">
<h2>What to hand in<a class="headerlink" href="#what-to-hand-in" title="Permalink to this heading"></a></h2>
<p>Write all of your code for the first two sections in a single text file
called <code class="docutils literal notranslate"><span class="pre">Lab3ab.hs</span></code>. The sparse matrix code should be a separate file
called <code class="docutils literal notranslate"><span class="pre">SparseMatrix.hs</span></code>. These files should be submitted to CodePost
as <code class="docutils literal notranslate"><span class="pre">Assignment</span> <span class="pre">3</span></code>.</p>
</section>
<section id="writing-and-testing-your-code">
<h2>Writing and testing your code<a class="headerlink" href="#writing-and-testing-your-code" title="Permalink to this heading"></a></h2>
<p>In the code base for the assignment (available on Canvas)
we are supplying automated test scripts for part A and part C.
The test script for part A is <code class="docutils literal notranslate"><span class="pre">SignedNatTests.hs</span></code>
and the one for part C is <code class="docutils literal notranslate"><span class="pre">SparseMatrixTests.hs</span></code>.
In addition, we are supplying a <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>.
You can run the tests by putting all three files
in the same directory as your code
(which must have the correct module names
<em>i.e.</em> <code class="docutils literal notranslate"><span class="pre">Lab3ab.hs</span></code> for part A and <code class="docutils literal notranslate"><span class="pre">SparseMatrix.hs</span></code> for part C).
Then type:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ make test_partA
</pre></div>
</div>
<p>to test part A only, or</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ make test_partC
</pre></div>
</div>
<p>to test part C only, or</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ make test
</pre></div>
</div>
<p>to test both parts A and C.</p>
<p>As in assignment 2,
the test code relies on the <code class="docutils literal notranslate"><span class="pre">HUnit</span></code> and <code class="docutils literal notranslate"><span class="pre">QuickCheck</span></code> modules
for unit testing and randomized testing, respectively.
The test script cannot test for everything,
but it should catch the most serious problems.</p>
<p>One trick you might want to try
in case you have a test failure which is difficult to debug
is to use the <code class="docutils literal notranslate"><span class="pre">trace</span></code> function from the <code class="docutils literal notranslate"><span class="pre">Debug.Trace</span></code> module.
This function takes a string and a value,
prints the string and returns the value.
The trick is that it does this without being in the <code class="docutils literal notranslate"><span class="pre">IO</span></code> monad,
so it uses the dreaded <code class="docutils literal notranslate"><span class="pre">unsafePerformIO</span></code> function.
This is OK since all it does is print output before returning a value.
For a particular value in a computation, you can do this:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Somewhere inside an expression, you want to print the value of x.</span>
<span class="c1">-- Instead of just `x`, write:</span>
<span class="p">(</span><span class="n">trace</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;x = &quot;</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, when this code is run,
you will get a printout indicating what the value of <code class="docutils literal notranslate"><span class="pre">x</span></code> was
at that point in the program.
This is the Haskell way of emulating
the common style of debugging used in other languages using print statements.</p>
</section>
<section id="haskell-note-infinite-loops-in-tests">
<h2>Haskell note: Infinite loops in tests<a class="headerlink" href="#haskell-note-infinite-loops-in-tests" title="Permalink to this heading"></a></h2>
<p>One thing to be wary of with the randomized tests in parts A and C
is infinite loops.  The test framework can’t detect this,
so it will seem that the tests have just stopped producing output.</p>
<p>It turns out that reporting failures on infinite loops is very hard to do
reliably in GHC Haskell.  There is a <code class="docutils literal notranslate"><span class="pre">timeout</span></code> function,
but it doesn’t work when the infinite loop happens in a tight inner loop
of a function that doesn’t internally allocate memory.
If you’re curious, there is a discussion at <a class="reference external" href="https://stackoverflow.com/questions/55336948/how-can-i-use-the-haskell-timeout-function-in-system-timeout-to-halt-runaway-c">this link</a>
and also <a class="reference external" href="https://downloads.haskell.org/ghc/latest/docs/users_guide/bugs.html#bugs-in-ghc">here</a>.</p>
<p>The bottom line is that if you see your tests hanging,
you probably have an infinite loop in the code being tested,
and you need to look at it carefully.</p>
</section>
<section id="haskell-note-the-scopedtypevariables-pragma">
<h2>Haskell note: The <code class="docutils literal notranslate"><span class="pre">ScopedTypeVariables</span></code> pragma<a class="headerlink" href="#haskell-note-the-scopedtypevariables-pragma" title="Permalink to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can skip this section for now,
but if you get a weird error message involving “rigid type variables”,
please read it for an explanation of what’s going on.</p>
</div>
<p>For part C (the sparse matrix implementation), there will be one
function (sparse matrix multiplication) which is naturally done by
dividing it up into helper functions. If you do this, you may well
encounter a strange kind of type error that you haven’t seen before.</p>
<p>The problem arises when a function is polymorphic
<em>i.e.</em> its type depends on a type variable, say <code class="docutils literal notranslate"><span class="pre">a</span></code>.
Let’s assume that this function has an explicit type signature,
as most top-level functions do in Haskell.
Let’s also assume that there is a helper function,
probably defined in a <code class="docutils literal notranslate"><span class="pre">where</span></code> clause,
which is also polymorphic
(its type depends on a type variable <code class="docutils literal notranslate"><span class="pre">a</span></code>)
and which also has an explicit type signature.
So the function looks something like this:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">foo</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Foo</span><span class="w"> </span><span class="n">a</span>
<span class="nf">foo</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="o">...</span>
<span class="w">  </span><span class="kr">where</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Foo</span><span class="w"> </span><span class="n">a</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="o">...</span>
</pre></div>
</div>
<p>The issue here is that Haskell can’t assume
that the <code class="docutils literal notranslate"><span class="pre">a</span></code> type variable in the type declaration of the <code class="docutils literal notranslate"><span class="pre">bar</span></code> function
(defined in the <code class="docutils literal notranslate"><span class="pre">where</span></code> clause)
is the same type variable as the <code class="docutils literal notranslate"><span class="pre">a</span></code> type variable
in the type declaration of the <code class="docutils literal notranslate"><span class="pre">foo</span></code> function
(defined at the top level).</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">foo</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Foo</span><span class="w"> </span><span class="n">a</span><span class="w">   </span><span class="c1">-- type variable `a` (top level)</span>
<span class="nf">foo</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="o">...</span>
<span class="w">  </span><span class="kr">where</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Foo</span><span class="w"> </span><span class="n">a</span><span class="w">  </span><span class="c1">-- `a` is not necessarily the same type variable!</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="o">...</span>
</pre></div>
</div>
<p>In some cases, this doesn’t cause any problems.
Specifically, if you can move the function <code class="docutils literal notranslate"><span class="pre">bar</span></code>
to the top level with no errors,
then everything should still work.
On the other hand,
if <code class="docutils literal notranslate"><span class="pre">bar</span></code> is using anything defined in <code class="docutils literal notranslate"><span class="pre">foo</span></code>
that has a type which depends on <code class="docutils literal notranslate"><span class="pre">a</span></code>,
you’re in trouble.
That’s this scenario:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">foo</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Foo</span><span class="w"> </span><span class="n">a</span>
<span class="nf">foo</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="o">...</span><span class="w">  </span><span class="c1">-- N.B. `x` has type `a`</span>
<span class="w">  </span><span class="kr">where</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Foo</span><span class="w"> </span><span class="n">a</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span>
<span class="w">      </span><span class="o">...</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="c1">-- `bar` uses `x` (from the outer scope)</span>
<span class="w">                </span><span class="c1">-- but `x` was not an argument to `bar`</span>
</pre></div>
</div>
<p>What happens here is that <code class="docutils literal notranslate"><span class="pre">x</span></code> has the type <code class="docutils literal notranslate"><span class="pre">a</span></code> (the outer <code class="docutils literal notranslate"><span class="pre">a</span></code>) but
inside <code class="docutils literal notranslate"><span class="pre">bar</span></code>, you probably expect that <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> both have the
same type (<code class="docutils literal notranslate"><span class="pre">a</span></code>) when in fact Haskell considers them to be different.
If you try to use <code class="docutils literal notranslate"><span class="pre">x</span></code> inside <code class="docutils literal notranslate"><span class="pre">bar</span></code> as if it has the same type as
<code class="docutils literal notranslate"><span class="pre">y</span></code>, your code won’t compile and you’ll see errors describing
something called <code class="docutils literal notranslate"><span class="pre">rigid</span> <span class="pre">type</span> <span class="pre">variables</span></code>, which isn’t very helpful.</p>
<p>There are three different ways to fix this.</p>
<p>First, you can remove the type signature of <code class="docutils literal notranslate"><span class="pre">bar</span></code>, leading to this:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">foo</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Foo</span><span class="w"> </span><span class="n">a</span>
<span class="nf">foo</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="o">...</span>
<span class="w">  </span><span class="kr">where</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="p">[</span><span class="n">bar</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">bar</span><span class="p">]</span><span class="w"> </span><span class="o">...</span>
</pre></div>
</div>
<p>Here you are depending on the type inference engine to sort things out,
and it usually does what you want. We don’t like this, because we like
having explicit type signatures on all of our functions.</p>
<p>The second way is to add extra arguments instead of using arguments in
an outer scope:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">foo</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Foo</span><span class="w"> </span><span class="n">a</span>
<span class="nf">foo</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="c1">-- `bar` called with `x` as its first argument</span>
<span class="w">  </span><span class="kr">where</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Foo</span><span class="w"> </span><span class="n">a</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="o">...</span>
</pre></div>
</div>
<p>This will work fine, but the code can get significantly messier.
Basically, you are rewriting <code class="docutils literal notranslate"><span class="pre">bar</span></code> so that it could be a top-level
function.</p>
<p>The third way is the slickest. First, at the top of the entire file,
before the <code class="docutils literal notranslate"><span class="pre">module</span></code> line, add a <em>language pragma</em> that looks like
this:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="cm">{-# LANGUAGE ScopedTypeVariables #-}</span>
</pre></div>
</div>
<p>Language pragmas are optional opt-in features of GHC. This turns on one
such feature called <code class="docutils literal notranslate"><span class="pre">ScopedTypeVariables</span></code>.</p>
<p>Then, rewrite the type signature of the <code class="docutils literal notranslate"><span class="pre">foo</span></code> function as follows:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="nf">foo</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">forall</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Foo</span><span class="w"> </span><span class="n">a</span><span class="w">  </span><span class="c1">-- note the `forall` keyword</span>
</span><span class="nf">foo</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="o">...</span>
<span class="w">  </span><span class="kr">where</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Foo</span><span class="w"> </span><span class="n">a</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="o">...</span>
</pre></div>
</div>
<p>All you’ve done is add the <code class="docutils literal notranslate"><span class="pre">forall</span> <span class="pre">a</span> <span class="pre">.</span></code> before the type signature of <code class="docutils literal notranslate"><span class="pre">foo</span></code>.
What this does (along with the <code class="docutils literal notranslate"><span class="pre">ScopedTypeVariables</span></code> pragma)
is say “in any helper function of <code class="docutils literal notranslate"><span class="pre">foo</span></code> that uses the type variable <code class="docutils literal notranslate"><span class="pre">a</span></code>,
the <code class="docutils literal notranslate"><span class="pre">a</span></code> in the helper function must refer to the <em>same</em> <code class="docutils literal notranslate"><span class="pre">a</span></code>
as the <code class="docutils literal notranslate"><span class="pre">a</span></code> in <code class="docutils literal notranslate"><span class="pre">foo</span></code>’s type signature”.
In other words, the <em>type variable</em> <code class="docutils literal notranslate"><span class="pre">a</span></code> is <em>scoped</em>
which means that the outer declaration which includes <code class="docutils literal notranslate"><span class="pre">a</span></code>
applies to the entire function.
This is exactly what you want, and this fixes the compilation error.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have a type class qualifier,
it has to come <em>after</em> the <code class="docutils literal notranslate"><span class="pre">forall</span></code>:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="nf">foo</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">forall</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="kt">Eq</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Foo</span><span class="w"> </span><span class="n">a</span>
</span><span class="nf">foo</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="o">...</span>
<span class="w">  </span><span class="kr">where</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Foo</span><span class="w"> </span><span class="n">a</span>
<span class="w">    </span><span class="n">bar</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="o">...</span>
</pre></div>
</div>
</div>
<p>You are allowed to use the <code class="docutils literal notranslate"><span class="pre">ScopedTypeVariables</span></code> pragma in this
assignment, and in all assignments from now on. It’s never necessary but
it can be convenient.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="Assignment 3: A touch of class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="partA_exercises.html" class="btn btn-neutral float-right" title="Part A: Basic exercises" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Michael C. Vanier. All rights reserved.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>