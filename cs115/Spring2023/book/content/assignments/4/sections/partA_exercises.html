<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Part A: Exercises &mdash; The CS 115 book</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../_static/clipboard.min.js"></script>
        <script src="../../../../_static/copybutton.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Part B: Simple standalone programs" href="partB_standalone.html" />
    <link rel="prev" title="Preamble" href="Preamble.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            The CS 115 book, Spring 2023
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Software.html">Installing the course software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../admin/index.html">Administrative information</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Assignments</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../1/index.html">Assignment 1: Evaluation and recursion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2/index.html">Assignment 2: Algebraic datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../3/index.html">Assignment 3: A touch of class</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Assignment 4: <code class="docutils literal notranslate"><span class="pre">IO</span></code>, <code class="docutils literal notranslate"><span class="pre">IO</span></code>, it’s off to work we go!</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Preamble.html">Preamble</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Part A: Exercises</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#desugaring-do">1. Desugaring <code class="docutils literal notranslate"><span class="pre">do</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-style-mistake">2. A style mistake</a></li>
<li class="toctree-l4"><a class="reference internal" href="#two-desugarings">3. Two desugarings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#two-desugarings-part-2">4. Two desugarings, part 2</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="partB_standalone.html">Part B: Simple standalone programs</a></li>
<li class="toctree-l3"><a class="reference internal" href="partC_sudoku.html">Part C: Miniproject: Sudoku</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../5/index.html">Assignment 5: Monads and lists, oh my!</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">The CS 115 book, Spring 2023</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Assignments</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Assignment 4: <code class="docutils literal notranslate"><span class="pre">IO</span></code>, <code class="docutils literal notranslate"><span class="pre">IO</span></code>, it’s off to work we go!</a></li>
      <li class="breadcrumb-item active">Part A: Exercises</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="part-a-exercises">
<h1>Part A: Exercises<a class="headerlink" href="#part-a-exercises" title="Permalink to this heading"></a></h1>
<p>In order to work with the <code class="docutils literal notranslate"><span class="pre">IO</span></code> monad (or with any monad), you need to
understand how to desugar monadic code using the <code class="docutils literal notranslate"><span class="pre">do</span></code> notation to code
using the monad operators (<code class="docutils literal notranslate"><span class="pre">&gt;&gt;=</span></code> and <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code>). As we discussed in
class, there are two ways to do this, and we will explore both of them
here.</p>
<section id="desugaring-do">
<h2>1. Desugaring <code class="docutils literal notranslate"><span class="pre">do</span></code><a class="headerlink" href="#desugaring-do" title="Permalink to this heading"></a></h2>
<p>[<strong>1 mark</strong>]</p>
<p>Consider the following function, which is a manual implementation of the
<code class="docutils literal notranslate"><span class="pre">putStrLn</span></code> function:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">myPutStrLn</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="nb">()</span>
<span class="nf">myPutStrLn</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">putChar</span><span class="w"> </span><span class="kt">&#39;\</span><span class="n">n&#39;</span>
<span class="nf">myPutStrLn</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="kt">:</span><span class="n">cs</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span>
<span class="w">  </span><span class="kr">do</span><span class="w"> </span><span class="n">putChar</span><span class="w"> </span><span class="n">c</span>
<span class="w">     </span><span class="n">myPutStrLn</span><span class="w"> </span><span class="n">cs</span>
</pre></div>
</div>
<p>Desugar this into a function that does not use the <code class="docutils literal notranslate"><span class="pre">do</span></code> notation.
Either kind of desugaring will give the same answer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A very common way to write this function would be as follows:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">myPutStrLn</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="nb">()</span>
<span class="nf">myPutStrLn</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">putChar</span><span class="w"> </span><span class="kt">&#39;\</span><span class="n">n&#39;</span>
<span class="nf">myPutStrLn</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="kt">:</span><span class="n">cs</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">  </span><span class="n">putChar</span><span class="w"> </span><span class="n">c</span>
<span class="w">  </span><span class="n">myPutStrLn</span><span class="w"> </span><span class="n">cs</span>
</pre></div>
</div>
<p>This is perfectly acceptable, even though the <code class="docutils literal notranslate"><span class="pre">do</span></code> is situated far
to the right of the lines inside the <code class="docutils literal notranslate"><span class="pre">do</span></code>. Haskell’s indentation
rules only require that these lines be indented relative to the
<em>line</em> in which <code class="docutils literal notranslate"><span class="pre">do</span></code> is located, not relative to <code class="docutils literal notranslate"><span class="pre">do</span></code> itself.
Feel free to use this style when writing your own code, though you
don’t have to. You can also write it in a non-indentation-dependent
style as follows:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">myPutStrLn</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="nb">()</span>
<span class="nf">myPutStrLn</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">putChar</span><span class="w"> </span><span class="kt">&#39;\</span><span class="n">n&#39;</span>
<span class="nf">myPutStrLn</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="kt">:</span><span class="n">cs</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="n">putChar</span><span class="w"> </span><span class="n">c</span>
<span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="n">myPutStrLn</span><span class="w"> </span><span class="n">cs</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
<p>I rarely use this style myself, but some programmers prefer it.</p>
</div>
</section>
<section id="a-style-mistake">
<h2>2. A style mistake<a class="headerlink" href="#a-style-mistake" title="Permalink to this heading"></a></h2>
<p>[<strong>1 mark</strong>]</p>
<p>Ben Bitfiddle wrote this code as a way to get familiar with the <code class="docutils literal notranslate"><span class="pre">IO</span></code>
monad:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="nf">greet</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="nb">()</span>
<span class="nf">greet</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span><span class="w"> </span><span class="n">putStrLn</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Hello, &quot;</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Although this code works fine, it exhibits poor style because some of it
is redundant. Can you simplify it a little without changing its
behavior?</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>We don’t mean replacing the parentheses with a <code class="docutils literal notranslate"><span class="pre">$</span></code> operator,
though you can do that too.</p>
</div>
</section>
<section id="two-desugarings">
<h2>3. Two desugarings<a class="headerlink" href="#two-desugarings" title="Permalink to this heading"></a></h2>
<p>[<strong>4 marks</strong>]</p>
<p>Here is a more complicated version of the <code class="docutils literal notranslate"><span class="pre">greet</span></code> function:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Ask the user for his/her name, then print a greeting.</span>
<span class="nf">greet2</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="nb">()</span>
<span class="nf">greet2</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">  </span><span class="n">putStr</span><span class="w"> </span><span class="s">&quot;Enter your name: &quot;</span>
<span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">getLine</span>
<span class="w">  </span><span class="n">putStr</span><span class="w"> </span><span class="s">&quot;Hello, &quot;</span>
<span class="w">  </span><span class="n">putStr</span><span class="w"> </span><span class="n">name</span>
<span class="w">  </span><span class="n">putStrLn</span><span class="w"> </span><span class="s">&quot;!&quot;</span>
</pre></div>
</div>
<p>Desugar this function in two ways, both described in lecture 12: the
simple desugaring, and the more complicated desugaring involving an
explicit <code class="docutils literal notranslate"><span class="pre">case</span></code> statement. In both cases, preserve the binding of the
name to the identifier <code class="docutils literal notranslate"><span class="pre">name</span></code> (in other words, don’t try to write it
in a point-free manner; that’s not what we’re after here). Does the
complex desugaring behave differently than the simple desugaring here?
Write your answer in a comment. If there is a pattern match failure for
the complex desugaring, use the error message
<code class="docutils literal notranslate"><span class="pre">&quot;Pattern</span> <span class="pre">match</span> <span class="pre">failure</span> <span class="pre">in</span> <span class="pre">do</span> <span class="pre">expression&quot;</span></code>, which is close to what
would actually be printed. Recall that we use the <code class="docutils literal notranslate"><span class="pre">fail</span></code> method from
the <code class="docutils literal notranslate"><span class="pre">MonadFail</span></code> type class to handle pattern match failures in <code class="docutils literal notranslate"><span class="pre">do</span></code>
expressions for monads that support it (which includes <code class="docutils literal notranslate"><span class="pre">IO</span></code>).</p>
<p>Call the function desugared in the first way <code class="docutils literal notranslate"><span class="pre">greet2a</span></code>, and the
function desugared in the second way <code class="docutils literal notranslate"><span class="pre">greet2b</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>For the desugarings (this problem and the next) don’t just write
the desugarings in a comment; write new versions of the functions
and rename them. This will allow you to test them to make sure
they behave correctly.</p></li>
<li><p><em>Coding style:</em> Using indentation and formatting in a judicious
manner will make the desugared code much easier to read. For
instance, don’t write the entire definition on one line, even if
you can.</p></li>
<li><p>Some desugarings may give rise to warnings which you can ignore.
(This is an exception to our usual rule that warnings are errors.)
On the other hand, if your code generates warnings that are not
the result of a correct desugaring you will lose marks.</p></li>
</ul>
</div>
</section>
<section id="two-desugarings-part-2">
<h2>4. Two desugarings, part 2<a class="headerlink" href="#two-desugarings-part-2" title="Permalink to this heading"></a></h2>
<p>[<strong>4 marks</strong>]</p>
<p>Let’s say we want to change the <code class="docutils literal notranslate"><span class="pre">greet</span></code> function so that it will
capitalize the name given to it (in case the user entered his/her name
without bothering to capitalize it correctly). That might lead to a
function like this:</p>
<div class="highlight-haskell notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Need to import this to get the definition of toUpper:</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Data.Char</span>

<span class="c1">-- Ask the user for his/her name, then print a greeting.</span>
<span class="c1">-- Capitalize the first letter of the name.</span>
<span class="nf">greet3</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="nb">()</span>
<span class="nf">greet3</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">  </span><span class="n">putStr</span><span class="w"> </span><span class="s">&quot;Enter your name: &quot;</span>
<span class="w">  </span><span class="p">(</span><span class="n">n</span><span class="kt">:</span><span class="n">ns</span><span class="p">)</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">getLine</span>
<span class="w">  </span><span class="kr">let</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">toUpper</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="n">ns</span>
<span class="w">  </span><span class="n">putStr</span><span class="w"> </span><span class="s">&quot;Hello, &quot;</span>
<span class="w">  </span><span class="n">putStr</span><span class="w"> </span><span class="n">name</span>
<span class="w">  </span><span class="n">putStrLn</span><span class="w"> </span><span class="s">&quot;!&quot;</span>
</pre></div>
</div>
<p>Again, desugar this in the two different ways (also making sure to
handle the <code class="docutils literal notranslate"><span class="pre">let</span></code> expression correctly in both cases). Does the more
complex desugaring have any effects here? Write your answer in a
comment. <em>Hint:</em> What kind of user input could be used to check which
desugaring was being used? If there is a pattern match failure for the
complex desugaring, again use the error message
<code class="docutils literal notranslate"><span class="pre">&quot;Pattern</span> <span class="pre">match</span> <span class="pre">failure</span> <span class="pre">in</span> <span class="pre">do</span> <span class="pre">expression&quot;</span></code>.</p>
<p>Call the function desugared in the first way <code class="docutils literal notranslate"><span class="pre">greet3a</span></code>, and the
function desugared in the second way <code class="docutils literal notranslate"><span class="pre">greet3b</span></code>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Preamble.html" class="btn btn-neutral float-left" title="Preamble" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="partB_standalone.html" class="btn btn-neutral float-right" title="Part B: Simple standalone programs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Michael C. Vanier. All rights reserved.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>